<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="theme-color" content="#000000"><link rel="manifest" href="/manifest.json"><link rel="shortcut icon" href="/favicon.png"><style class="_styletron_hydrate_"></style><title>日志</title><meta name="description" content="Born to build better enterprise frameworks and apps"><link href="/static/css/post.d62265dc.css" rel="stylesheet"></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><div class="ant-layout" data-reactroot=""><div class="header-module__header___3ADJ9 ant-layout-header"><div class="ant-row-flex"><div class="ant-col-xs-12 ant-col-md-20 ant-col-lg-2"><div class="header-module__logo___3yTXp"><a href="/"><img src="/logo.svg" alt="logo"/></a></div></div><div class="ant-col-xs-0 ant-col-md-0 ant-col-lg-20"><ul class="ant-menu header-module__menu___3yEtW ant-menu-light ant-menu-root ant-menu-horizontal" role="menu"><li class="ant-menu-item" role="menuitem"><a href="/zh-cn/intro/">指南</a></li><li class="ant-menu-item" role="menuitem"><a href="/api/">API</a></li><li class="ant-menu-item" role="menuitem"><a href="/zh-cn/tutorials/index.html">教程</a></li><li class="ant-menu-item" role="menuitem"><a href="https://github.com/search?q=topic%3Aegg-plugin&amp;type=Repositories">插件</a></li><li class="ant-menu-item" role="menuitem"><a href="https://github.com/eggjs/egg/releases">发布日志</a></li></ul></div><div style="text-align:right" class="ant-col-xs-12 ant-col-md-4 ant-col-lg-2"><button type="button" class="ant-btn"><span>Languages</span></button></div></div></div><div class="ant-layout-content"><div class="basic_layout-module__content___3flpY ant-layout"><div class="sider-module__side___1Cadj ant-layout-sider ant-layout-sider-light" style="flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"><ul class="ant-menu sider-module__menu___2GqPr ant-menu-light ant-menu-root ant-menu-inline" role="menu"><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="0$Menu" aria-haspopup="true"><span>新手指南</span><i class="ant-menu-submenu-arrow"></i></div><ul id="0$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/intro/index.html">Egg.js 是什么?</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/intro/egg-and-koa.html">Egg.js 和 Koa</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/intro/quickstart.html">快速入门</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/tutorials/progressive.html">渐进式开发</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/migration.html">2.x 升级指南</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="1$Menu" aria-haspopup="true"><span>基础功能</span><i class="ant-menu-submenu-arrow"></i></div><ul id="1$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/structure.html">目录结构</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/objects.html">内置对象</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/env.html">运行环境</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/config.html">配置</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/middleware.html">中间件</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/router.html">Router</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/controller.html">Controller</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/service.html">Service</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/plugin.html">插件</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/schedule.html">定时任务</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/extend.html">框架扩展</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/app-start.html">启动自定义</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="2$Menu" aria-haspopup="true"><span>核心功能</span><i class="ant-menu-submenu-arrow"></i></div><ul id="2$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/core/development.html">本地开发</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/core/unittest.html">单元测试</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/core/deployment.html">应用部署</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/core/logger.html">日志</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/core/httpclient.html">HttpClient</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/core/cookie-and-session.html">Cookie and Session</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/core/cluster-and-ipc.html">多进程模型和进程间通讯</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/core/view.html">模板渲染</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/core/error-handling.html">异常处理</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/core/security.html">安全</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/core/i18n.html">国际化</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="3$Menu" aria-haspopup="true"><span>教程</span><i class="ant-menu-submenu-arrow"></i></div><ul id="3$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/tutorials/mysql.html">MySQL</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/tutorials/restful.html">RESTful API</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/tutorials/passport.html">Passport 鉴权</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/tutorials/socketio.html">Socket.IO</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/tutorials/assets.html">静态资源</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/tutorials/typescript.html">TypeScript</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="4$Menu" aria-haspopup="true"><span>进阶</span><i class="ant-menu-submenu-arrow"></i></div><ul id="4$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/advanced/loader.html">Loader</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/advanced/plugin.html">插件开发</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/advanced/framework.html">框架开发</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/advanced/cluster-client.html">多进程研发模式增强</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/advanced/view-plugin.html">模板插件开发规范</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/style-guide.html">代码风格指南</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="5$Menu" aria-haspopup="true"><span>社区</span><i class="ant-menu-submenu-arrow"></i></div><ul id="5$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/plugins/">内置插件列表</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/contributing.html">如何贡献</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/resource.html">资源</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/faq.html">常见问题</a></li></ul></li></ul></div></div><div class="basic_layout-module__post___2Z7KK ant-layout-content"><div class="ant-row" style="margin-left:-8px;margin-right:-8px"><div style="padding-left:8px;padding-right:8px" class="ant-col-xs-24 ant-col-md-18"><div class="markdown-body" style="font-size:14px"><div><p>日志对于 Web 开发的重要性毋庸置疑，它对于监控应用的运行状态、问题排查等都有非常重要的意义。</p><p>框架内置了强大的企业级日志支持，由 <a href="https://github.com/eggjs/egg-logger">egg-logger</a> 模块提供。</p><p>主要特性：</p><ul><li>日志分级</li><li>统一错误日志，所有 logger 中使用 <code>.error()</code> 打印的 <code>ERROR</code> 级别日志都会打印到统一的错误日志文件中，便于追踪</li><li>启动日志和运行日志分离</li><li>自定义日志</li><li>多进程日志</li><li>自动切割日志</li><li>高性能</li></ul><h2 id="日志路径">日志路径</h2><ul><li>所有日志文件默认都放在 <code>${appInfo.root}/logs/${appInfo.name}</code> 路径下，例如 <code>/home/admin/logs/example-app</code>。</li><li>在本地开发环境 (env: local) 和单元测试环境 (env: unittest)，为了避免冲突以及集中管理，日志会打印在项目目录下的 logs 目录，例如 <code>/path/to/example-app/logs/example-app</code>。</li></ul><p>如果想自定义日志路径：</p><pre><code class="language-js">// config/config.${env}.js
exports.logger = {
  dir: &#x27;/path/to/your/custom/log/dir&#x27;,
};</code></pre><h2 id="日志分类">日志分类</h2><p>框架内置了几种日志，分别在不同的场景下使用：</p><ul><li>appLogger <code>${appInfo.name}-web.log</code>，例如 <code>example-app-web.log</code>，应用相关日志，供应用开发者使用的日志。我们在绝大数情况下都在使用它。</li><li>coreLogger <code>egg-web.log</code> 框架内核、插件日志。</li><li>errorLogger <code>common-error.log</code> 实际一般不会直接使用它，任何 logger 的 <code>.error()</code> 调用输出的日志都会重定向到这里，重点通过查看此日志定位异常。</li><li>agentLogger <code>egg-agent.log</code> agent 进程日志，框架和使用到 agent 进程执行任务的插件会打印一些日志到这里。</li></ul><p>如果想自定义以上日志文件名称，可以在 config 文件中覆盖默认值：</p><pre><code class="language-js">// config/config.${env}.js
module.exports = appInfo =&gt; {
  return {
    logger: {
      appLogName: `${appInfo.name}-web.log`,
      coreLogName: &#x27;egg-web.log&#x27;,
      agentLogName: &#x27;egg-agent.log&#x27;,
      errorLogName: &#x27;common-error.log&#x27;,
    },
  };
};</code></pre><h2 id="如何打印日志">如何打印日志</h2><h3 id="context-logger">Context Logger</h3><p>如果我们在处理请求时需要打印日志，这时候使用 Context Logger，用于记录 Web 行为相关的日志。</p><p>每行日志会自动记录上当前请求的一些基本信息，
如 <code>[$userId/$ip/$traceId/${cost}ms $method $url]</code>。</p><pre><code class="language-js">ctx.logger.debug(&#x27;debug info&#x27;);
ctx.logger.info(&#x27;some request data: %j&#x27;, ctx.request.body);
ctx.logger.warn(&#x27;WARNNING!!!!&#x27;);

// 错误日志记录，直接会将错误日志完整堆栈信息记录下来，并且输出到 errorLog 中
// 为了保证异常可追踪，必须保证所有抛出的异常都是 Error 类型，因为只有 Error 类型才会带上堆栈信息，定位到问题。
ctx.logger.error(new Error(&#x27;whoops&#x27;));</code></pre><p>对于框架开发者和插件开发者会使用到的 Context Logger 还有 <code>ctx.coreLogger</code>。</p><p>例如</p><pre><code class="language-js">ctx.coreLogger.info(&#x27;info&#x27;);</code></pre><h3 id="app-logger">App Logger</h3><p>如果我们想做一些应用级别的日志记录，如记录启动阶段的一些数据信息，可以通过 App Logger 来完成。</p><pre><code class="language-js">// app.js
module.exports = app =&gt; {
  app.logger.debug(&#x27;debug info&#x27;);
  app.logger.info(&#x27;启动耗时 %d ms&#x27;, Date.now() - start);
  app.logger.warn(&#x27;warning!&#x27;);

  app.logger.error(someErrorObj);
};</code></pre><p>对于框架和插件开发者会使用到的 App Logger 还有 <code>app.coreLogger</code>。</p><pre><code class="language-js">// app.js
module.exports = app =&gt; {
  app.coreLogger.info(&#x27;启动耗时 %d ms&#x27;, Date.now() - start);
};</code></pre><h3 id="agent-logger">Agent Logger</h3><p>在开发框架和插件时有时会需要在 Agent 进程运行代码，这时使用 <code>agent.coreLogger</code>。</p><pre><code class="language-js">// agent.js
module.exports = agent =&gt; {
  agent.logger.debug(&#x27;debug info&#x27;);
  agent.logger.info(&#x27;启动耗时 %d ms&#x27;, Date.now() - start);
  agent.logger.warn(&#x27;warning!&#x27;);

  agent.logger.error(someErrorObj);
};</code></pre><p>如需详细了解 Agent 进程，请参考<a href="./cluster-and-ipc.md">多进程模型</a>。</p><h2 id="日志文件编码">日志文件编码</h2><p>默认编码为 <code>utf-8</code>，可通过如下方式覆盖：</p><pre><code class="language-js">// config/config.${env}.js
exports.logger = {
  encoding: &#x27;gbk&#x27;,
};</code></pre><h2 id="日志级别">日志级别</h2><p>日志分为 <code>NONE</code>，<code>DEBUG</code>，<code>INFO</code>，<code>WARN</code> 和 <code>ERROR</code> 5 个级别。</p><p>日志打印到文件中的同时，为了方便开发，也会同时打印到终端中。</p><h3 id="文件日志级别">文件日志级别</h3><p>默认只会输出 <code>INFO</code> 及以上（<code>WARN</code> 和 <code>ERROR</code>）的日志到文件中。</p><p>可通过如下方式配置输出到文件日志的级别：</p><p>打印所有级别日志到文件中：</p><pre><code class="language-js">// config/config.${env}.js
exports.logger = {
  level: &#x27;DEBUG&#x27;,
};</code></pre><p>关闭所有打印到文件的日志：</p><pre><code class="language-js">// config/config.${env}.js
exports.logger = {
  level: &#x27;NONE&#x27;,
};</code></pre><h4 id="生产环境打印-debug-日志">生产环境打印 debug 日志</h4><p>为了避免一些插件的调试日志在生产环境打印导致性能问题，生产环境默认禁止打印 DEBUG 级别的日志，如果确实有需求在生产环境打印 DEBUG 日志进行调试，需要打开 <code>allowDebugAtProd</code> 配置项。</p><pre><code class="language-js">// config/config.prod.js
exports.logger = {
  level: &#x27;DEBUG&#x27;,
  allowDebugAtProd: true,
};</code></pre><h3 id="终端日志级别">终端日志级别</h3><p>默认只会输出 <code>INFO</code> 及以上（<code>WARN</code> 和 <code>ERROR</code>）的日志到终端中。</p><ul><li><code>logger.consoleLevel</code>: 输出到终端日志的级别，默认为 <code>INFO</code></li></ul><p>可通过如下方式配置输出到终端日志的级别：</p><p>打印所有级别日志到终端：</p><pre><code class="language-js">// config/config.${env}.js
exports.logger = {
  consoleLevel: &#x27;DEBUG&#x27;,
};</code></pre><p>关闭所有打印到终端的日志：</p><pre><code class="language-js">// config/config.${env}.js
exports.logger = {
  consoleLevel: &#x27;NONE&#x27;,
};</code></pre><h2 id="自定义日志">自定义日志</h2><h3 id="增加自定义日志">增加自定义日志</h3><p><strong>一般应用无需配置自定义日志</strong>，因为日志打太多或太分散都会导致关注度分散，反而难以管理和难以排查发现问题。</p><p>如果实在有需求可以如下配置：</p><pre><code class="language-js">// config/config.${env}.js
const path = require(&#x27;path&#x27;);

module.exports = appInfo =&gt; {
  return {
    customLogger: {
      xxLogger: {
        file: path.join(appInfo.root, &#x27;logs/xx.log&#x27;),
      },
    },
  };
};</code></pre><p>可通过 <code>app.getLogger(&#x27;xxLogger&#x27;)</code> / <code>ctx.getLogger(&#x27;xxLogger&#x27;)</code> 获取，最终的打印结果和 coreLogger 类似。</p><h3 id="高级自定义日志">高级自定义日志</h3><p>日志默认是打印到日志文件中，当本地开发时同时会打印到终端。
但是，有时候我们会有需求把日志打印到其他媒介上，这时候我们就需要自定义日志的 transport。</p><p>Transport 是一种传输通道，一个 logger 可包含多个传输通道。比如默认的 logger 就有 fileTransport 和 consoleTransport 两个通道，
分别负责打印到文件和终端。</p><p>举个例子，我们不仅需要把错误日志打印到 <code>common-error.log</code>，还需要上报给第三方服务。</p><p>首先我们定义一个日志的 transport，代表第三方日志服务。</p><pre><code class="language-js">const util = require(&#x27;util&#x27;);
const Transport = require(&#x27;egg-logger&#x27;).Transport;

class RemoteErrorTransport extends Transport {

  // 定义 log 方法，在此方法中把日志上报给远端服务
  log(level, args) {
    let log;
    if (args[0] instanceof Error) {
      const err = args[0];
      log = util.format(&#x27;%s: %s\n%s\npid: %s\n&#x27;, err.name, err.message, err.stack, process.pid);
    } else {
      log = util.format(...args);
    }

    this.options.app.curl(&#x27;http://url/to/remote/error/log/service/logs&#x27;, {
      data: log,
      method: &#x27;POST&#x27;,
    }).catch(console.error);
  }
}

// app.js 中给 errorLogger 添加 transport，这样每条日志就会同时打印到这个 transport 了
app.getLogger(&#x27;errorLogger&#x27;).set(&#x27;remote&#x27;, new RemoteErrorTransport({ level: &#x27;ERROR&#x27;, app }));</code></pre><p>上面的例子比较简单，实际情况中我们需要考虑性能，很可能采取先打印到内存，再定时上传的策略，以提高性能。</p><h2 id="日志切割">日志切割</h2><p>企业级日志一个最常见的需求之一是对日志进行自动切割，以方便管理。框架对日志切割的支持由 <a href="https://github.com/eggjs/egg-logrotator">egg-logrotator</a> 插件提供。</p><h3 id="按天切割">按天切割</h3><p>这是框架的默认日志切割方式，在每日 <code>00:00</code> 按照 <code>.log.YYYY-MM-DD</code> 文件名进行切割。</p><p>以 appLog 为例，当前写入的日志为 <code>example-app-web.log</code>，当凌晨 <code>00:00</code> 时，会对日志进行切割，把过去一天的日志按 <code>example-app-web.log.YYYY-MM-DD</code> 的形式切割为单独的文件。</p><h3 id="按照文件大小切割">按照文件大小切割</h3><p>我们也可以按照文件大小进行切割。例如，当文件超过 2G 时进行切割。</p><p>例如，我们需要把 <code>egg-web.log</code> 按照大小进行切割：</p><pre><code class="language-js">// config/config.${env}.js
const path = require(&#x27;path&#x27;);

module.exports = appInfo =&gt; {
  return {
    logrotator: {
      filesRotateBySize: [
        path.join(appInfo.root, &#x27;logs&#x27;, appInfo.name, &#x27;egg-web.log&#x27;),
      ],
      maxFileSize: 2 * 1024 * 1024 * 1024,
    },
  };
};</code></pre><p>添加到 <code>filesRotateBySize</code> 的日志文件不再按天进行切割。</p><h3 id="按照小时切割">按照小时切割</h3><p>我们也可以选择按照小时进行切割，这和默认的按天切割非常类似，只是时间缩短到每小时。</p><p>例如，我们需要把 <code>common-error.log</code> 按照小时进行切割：</p><pre><code class="language-js">// config/config.${env}.js
const path = require(&#x27;path&#x27;);

module.exports = appInfo =&gt; {
  return {
    logrotator: {
      filesRotateByHour: [
        path.join(appInfo.root, &#x27;logs&#x27;, appInfo.name, &#x27;common-error.log&#x27;),
      ],
    },
  };
};</code></pre><p>添加到 <code>filesRotateByHour</code> 的日志文件不再被按天进行切割。</p><h2 id="性能">性能</h2><p>通常 Web 访问是高频访问，每次打印日志都写磁盘会造成频繁磁盘 IO，为了提高性能，我们采用的文件日志写入策略是：</p><blockquote><p>日志同步写入内存，异步每隔一段时间(默认 1 秒)刷盘</p></blockquote><p>更多详细请参考 <a href="https://github.com/eggjs/egg-logger">egg-logger</a> 和 <a href="https://github.com/eggjs/egg-logrotator">egg-logrotator</a>。</p></div></div></div><div style="padding-left:8px;padding-right:8px" class="ant-col-xs-0 ant-col-md-6"><div class="markdown-body" style="font-size:14px"><div><ul><li><a href="#%E6%97%A5%E5%BF%97%E8%B7%AF%E5%BE%84">日志路径</a></li><li><a href="#%E6%97%A5%E5%BF%97%E5%88%86%E7%B1%BB">日志分类</a></li><li><a href="#%E5%A6%82%E4%BD%95%E6%89%93%E5%8D%B0%E6%97%A5%E5%BF%97">如何打印日志</a><ul><li><a href="#context-logger">Context Logger</a></li><li><a href="#app-logger">App Logger</a></li><li><a href="#agent-logger">Agent Logger</a></li></ul></li><li><a href="#%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E7%BC%96%E7%A0%81">日志文件编码</a></li><li><a href="#%E6%97%A5%E5%BF%97%E7%BA%A7%E5%88%AB">日志级别</a><ul><li><a href="#%E6%96%87%E4%BB%B6%E6%97%A5%E5%BF%97%E7%BA%A7%E5%88%AB">文件日志级别</a><ul><li><a href="#%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E6%89%93%E5%8D%B0-debug-%E6%97%A5%E5%BF%97">生产环境打印 debug 日志</a></li></ul></li><li><a href="#%E7%BB%88%E7%AB%AF%E6%97%A5%E5%BF%97%E7%BA%A7%E5%88%AB">终端日志级别</a></li></ul></li><li><a href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E6%97%A5%E5%BF%97">自定义日志</a><ul><li><a href="#%E5%A2%9E%E5%8A%A0%E8%87%AA%E5%AE%9A%E4%B9%89%E6%97%A5%E5%BF%97">增加自定义日志</a></li><li><a href="#%E9%AB%98%E7%BA%A7%E8%87%AA%E5%AE%9A%E4%B9%89%E6%97%A5%E5%BF%97">高级自定义日志</a></li></ul></li><li><a href="#%E6%97%A5%E5%BF%97%E5%88%87%E5%89%B2">日志切割</a><ul><li><a href="#%E6%8C%89%E5%A4%A9%E5%88%87%E5%89%B2">按天切割</a></li><li><a href="#%E6%8C%89%E7%85%A7%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F%E5%88%87%E5%89%B2">按照文件大小切割</a></li><li><a href="#%E6%8C%89%E7%85%A7%E5%B0%8F%E6%97%B6%E5%88%87%E5%89%B2">按照小时切割</a></li></ul></li><li><a href="#%E6%80%A7%E8%83%BD">性能</a></li></ul></div></div></div></div></div></div></div></div></div><script type="text/javascript">window.__INIT_STATE__={"lang":"zh","props":{"toc":"-%20%5B%E6%97%A5%E5%BF%97%E8%B7%AF%E5%BE%84%5D(%23%25E6%2597%25A5%25E5%25BF%2597%25E8%25B7%25AF%25E5%25BE%2584)%0A-%20%5B%E6%97%A5%E5%BF%97%E5%88%86%E7%B1%BB%5D(%23%25E6%2597%25A5%25E5%25BF%2597%25E5%2588%2586%25E7%25B1%25BB)%0A-%20%5B%E5%A6%82%E4%BD%95%E6%89%93%E5%8D%B0%E6%97%A5%E5%BF%97%5D(%23%25E5%25A6%2582%25E4%25BD%2595%25E6%2589%2593%25E5%258D%25B0%25E6%2597%25A5%25E5%25BF%2597)%0A%20%20*%20%5BContext%20Logger%5D(%23context-logger)%0A%20%20*%20%5BApp%20Logger%5D(%23app-logger)%0A%20%20*%20%5BAgent%20Logger%5D(%23agent-logger)%0A-%20%5B%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E7%BC%96%E7%A0%81%5D(%23%25E6%2597%25A5%25E5%25BF%2597%25E6%2596%2587%25E4%25BB%25B6%25E7%25BC%2596%25E7%25A0%2581)%0A-%20%5B%E6%97%A5%E5%BF%97%E7%BA%A7%E5%88%AB%5D(%23%25E6%2597%25A5%25E5%25BF%2597%25E7%25BA%25A7%25E5%2588%25AB)%0A%20%20*%20%5B%E6%96%87%E4%BB%B6%E6%97%A5%E5%BF%97%E7%BA%A7%E5%88%AB%5D(%23%25E6%2596%2587%25E4%25BB%25B6%25E6%2597%25A5%25E5%25BF%2597%25E7%25BA%25A7%25E5%2588%25AB)%0A%20%20%20%20%2B%20%5B%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E6%89%93%E5%8D%B0%20debug%20%E6%97%A5%E5%BF%97%5D(%23%25E7%2594%259F%25E4%25BA%25A7%25E7%258E%25AF%25E5%25A2%2583%25E6%2589%2593%25E5%258D%25B0-debug-%25E6%2597%25A5%25E5%25BF%2597)%0A%20%20*%20%5B%E7%BB%88%E7%AB%AF%E6%97%A5%E5%BF%97%E7%BA%A7%E5%88%AB%5D(%23%25E7%25BB%2588%25E7%25AB%25AF%25E6%2597%25A5%25E5%25BF%2597%25E7%25BA%25A7%25E5%2588%25AB)%0A-%20%5B%E8%87%AA%E5%AE%9A%E4%B9%89%E6%97%A5%E5%BF%97%5D(%23%25E8%2587%25AA%25E5%25AE%259A%25E4%25B9%2589%25E6%2597%25A5%25E5%25BF%2597)%0A%20%20*%20%5B%E5%A2%9E%E5%8A%A0%E8%87%AA%E5%AE%9A%E4%B9%89%E6%97%A5%E5%BF%97%5D(%23%25E5%25A2%259E%25E5%258A%25A0%25E8%2587%25AA%25E5%25AE%259A%25E4%25B9%2589%25E6%2597%25A5%25E5%25BF%2597)%0A%20%20*%20%5B%E9%AB%98%E7%BA%A7%E8%87%AA%E5%AE%9A%E4%B9%89%E6%97%A5%E5%BF%97%5D(%23%25E9%25AB%2598%25E7%25BA%25A7%25E8%2587%25AA%25E5%25AE%259A%25E4%25B9%2589%25E6%2597%25A5%25E5%25BF%2597)%0A-%20%5B%E6%97%A5%E5%BF%97%E5%88%87%E5%89%B2%5D(%23%25E6%2597%25A5%25E5%25BF%2597%25E5%2588%2587%25E5%2589%25B2)%0A%20%20*%20%5B%E6%8C%89%E5%A4%A9%E5%88%87%E5%89%B2%5D(%23%25E6%258C%2589%25E5%25A4%25A9%25E5%2588%2587%25E5%2589%25B2)%0A%20%20*%20%5B%E6%8C%89%E7%85%A7%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F%E5%88%87%E5%89%B2%5D(%23%25E6%258C%2589%25E7%2585%25A7%25E6%2596%2587%25E4%25BB%25B6%25E5%25A4%25A7%25E5%25B0%258F%25E5%2588%2587%25E5%2589%25B2)%0A%20%20*%20%5B%E6%8C%89%E7%85%A7%E5%B0%8F%E6%97%B6%E5%88%87%E5%89%B2%5D(%23%25E6%258C%2589%25E7%2585%25A7%25E5%25B0%258F%25E6%2597%25B6%25E5%2588%2587%25E5%2589%25B2)%0A-%20%5B%E6%80%A7%E8%83%BD%5D(%23%25E6%2580%25A7%25E8%2583%25BD)","meta":{"info":{"title":"日志"}},"content":"%0A%0A%0A%E6%97%A5%E5%BF%97%E5%AF%B9%E4%BA%8E%20Web%20%E5%BC%80%E5%8F%91%E7%9A%84%E9%87%8D%E8%A6%81%E6%80%A7%E6%AF%8B%E5%BA%B8%E7%BD%AE%E7%96%91%EF%BC%8C%E5%AE%83%E5%AF%B9%E4%BA%8E%E7%9B%91%E6%8E%A7%E5%BA%94%E7%94%A8%E7%9A%84%E8%BF%90%E8%A1%8C%E7%8A%B6%E6%80%81%E3%80%81%E9%97%AE%E9%A2%98%E6%8E%92%E6%9F%A5%E7%AD%89%E9%83%BD%E6%9C%89%E9%9D%9E%E5%B8%B8%E9%87%8D%E8%A6%81%E7%9A%84%E6%84%8F%E4%B9%89%E3%80%82%0A%0A%E6%A1%86%E6%9E%B6%E5%86%85%E7%BD%AE%E4%BA%86%E5%BC%BA%E5%A4%A7%E7%9A%84%E4%BC%81%E4%B8%9A%E7%BA%A7%E6%97%A5%E5%BF%97%E6%94%AF%E6%8C%81%EF%BC%8C%E7%94%B1%20%5Begg-logger%5D(https%3A%2F%2Fgithub.com%2Feggjs%2Fegg-logger)%20%E6%A8%A1%E5%9D%97%E6%8F%90%E4%BE%9B%E3%80%82%0A%0A%E4%B8%BB%E8%A6%81%E7%89%B9%E6%80%A7%EF%BC%9A%0A%0A-%20%E6%97%A5%E5%BF%97%E5%88%86%E7%BA%A7%0A-%20%E7%BB%9F%E4%B8%80%E9%94%99%E8%AF%AF%E6%97%A5%E5%BF%97%EF%BC%8C%E6%89%80%E6%9C%89%20logger%20%E4%B8%AD%E4%BD%BF%E7%94%A8%20%60.error()%60%20%E6%89%93%E5%8D%B0%E7%9A%84%20%60ERROR%60%20%E7%BA%A7%E5%88%AB%E6%97%A5%E5%BF%97%E9%83%BD%E4%BC%9A%E6%89%93%E5%8D%B0%E5%88%B0%E7%BB%9F%E4%B8%80%E7%9A%84%E9%94%99%E8%AF%AF%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E4%B8%AD%EF%BC%8C%E4%BE%BF%E4%BA%8E%E8%BF%BD%E8%B8%AA%0A-%20%E5%90%AF%E5%8A%A8%E6%97%A5%E5%BF%97%E5%92%8C%E8%BF%90%E8%A1%8C%E6%97%A5%E5%BF%97%E5%88%86%E7%A6%BB%0A-%20%E8%87%AA%E5%AE%9A%E4%B9%89%E6%97%A5%E5%BF%97%0A-%20%E5%A4%9A%E8%BF%9B%E7%A8%8B%E6%97%A5%E5%BF%97%0A-%20%E8%87%AA%E5%8A%A8%E5%88%87%E5%89%B2%E6%97%A5%E5%BF%97%0A-%20%E9%AB%98%E6%80%A7%E8%83%BD%0A%0A%23%23%20%E6%97%A5%E5%BF%97%E8%B7%AF%E5%BE%84%0A%0A-%20%E6%89%80%E6%9C%89%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E9%BB%98%E8%AE%A4%E9%83%BD%E6%94%BE%E5%9C%A8%20%60%24%7BappInfo.root%7D%2Flogs%2F%24%7BappInfo.name%7D%60%20%E8%B7%AF%E5%BE%84%E4%B8%8B%EF%BC%8C%E4%BE%8B%E5%A6%82%20%60%2Fhome%2Fadmin%2Flogs%2Fexample-app%60%E3%80%82%0A-%20%E5%9C%A8%E6%9C%AC%E5%9C%B0%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%20(env%3A%20local)%20%E5%92%8C%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E7%8E%AF%E5%A2%83%20(env%3A%20unittest)%EF%BC%8C%E4%B8%BA%E4%BA%86%E9%81%BF%E5%85%8D%E5%86%B2%E7%AA%81%E4%BB%A5%E5%8F%8A%E9%9B%86%E4%B8%AD%E7%AE%A1%E7%90%86%EF%BC%8C%E6%97%A5%E5%BF%97%E4%BC%9A%E6%89%93%E5%8D%B0%E5%9C%A8%E9%A1%B9%E7%9B%AE%E7%9B%AE%E5%BD%95%E4%B8%8B%E7%9A%84%20logs%20%E7%9B%AE%E5%BD%95%EF%BC%8C%E4%BE%8B%E5%A6%82%20%60%2Fpath%2Fto%2Fexample-app%2Flogs%2Fexample-app%60%E3%80%82%0A%0A%E5%A6%82%E6%9E%9C%E6%83%B3%E8%87%AA%E5%AE%9A%E4%B9%89%E6%97%A5%E5%BF%97%E8%B7%AF%E5%BE%84%EF%BC%9A%0A%0A%60%60%60js%0A%2F%2F%20config%2Fconfig.%24%7Benv%7D.js%0Aexports.logger%20%3D%20%7B%0A%20%20dir%3A%20'%2Fpath%2Fto%2Fyour%2Fcustom%2Flog%2Fdir'%2C%0A%7D%3B%0A%60%60%60%0A%0A%23%23%20%E6%97%A5%E5%BF%97%E5%88%86%E7%B1%BB%0A%0A%E6%A1%86%E6%9E%B6%E5%86%85%E7%BD%AE%E4%BA%86%E5%87%A0%E7%A7%8D%E6%97%A5%E5%BF%97%EF%BC%8C%E5%88%86%E5%88%AB%E5%9C%A8%E4%B8%8D%E5%90%8C%E7%9A%84%E5%9C%BA%E6%99%AF%E4%B8%8B%E4%BD%BF%E7%94%A8%EF%BC%9A%0A%0A-%20appLogger%20%60%24%7BappInfo.name%7D-web.log%60%EF%BC%8C%E4%BE%8B%E5%A6%82%20%60example-app-web.log%60%EF%BC%8C%E5%BA%94%E7%94%A8%E7%9B%B8%E5%85%B3%E6%97%A5%E5%BF%97%EF%BC%8C%E4%BE%9B%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91%E8%80%85%E4%BD%BF%E7%94%A8%E7%9A%84%E6%97%A5%E5%BF%97%E3%80%82%E6%88%91%E4%BB%AC%E5%9C%A8%E7%BB%9D%E5%A4%A7%E6%95%B0%E6%83%85%E5%86%B5%E4%B8%8B%E9%83%BD%E5%9C%A8%E4%BD%BF%E7%94%A8%E5%AE%83%E3%80%82%0A-%20coreLogger%20%60egg-web.log%60%20%E6%A1%86%E6%9E%B6%E5%86%85%E6%A0%B8%E3%80%81%E6%8F%92%E4%BB%B6%E6%97%A5%E5%BF%97%E3%80%82%0A-%20errorLogger%20%60common-error.log%60%20%E5%AE%9E%E9%99%85%E4%B8%80%E8%88%AC%E4%B8%8D%E4%BC%9A%E7%9B%B4%E6%8E%A5%E4%BD%BF%E7%94%A8%E5%AE%83%EF%BC%8C%E4%BB%BB%E4%BD%95%20logger%20%E7%9A%84%20%60.error()%60%20%E8%B0%83%E7%94%A8%E8%BE%93%E5%87%BA%E7%9A%84%E6%97%A5%E5%BF%97%E9%83%BD%E4%BC%9A%E9%87%8D%E5%AE%9A%E5%90%91%E5%88%B0%E8%BF%99%E9%87%8C%EF%BC%8C%E9%87%8D%E7%82%B9%E9%80%9A%E8%BF%87%E6%9F%A5%E7%9C%8B%E6%AD%A4%E6%97%A5%E5%BF%97%E5%AE%9A%E4%BD%8D%E5%BC%82%E5%B8%B8%E3%80%82%0A-%20agentLogger%20%60egg-agent.log%60%20agent%20%E8%BF%9B%E7%A8%8B%E6%97%A5%E5%BF%97%EF%BC%8C%E6%A1%86%E6%9E%B6%E5%92%8C%E4%BD%BF%E7%94%A8%E5%88%B0%20agent%20%E8%BF%9B%E7%A8%8B%E6%89%A7%E8%A1%8C%E4%BB%BB%E5%8A%A1%E7%9A%84%E6%8F%92%E4%BB%B6%E4%BC%9A%E6%89%93%E5%8D%B0%E4%B8%80%E4%BA%9B%E6%97%A5%E5%BF%97%E5%88%B0%E8%BF%99%E9%87%8C%E3%80%82%0A%0A%E5%A6%82%E6%9E%9C%E6%83%B3%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BB%A5%E4%B8%8A%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E5%90%8D%E7%A7%B0%EF%BC%8C%E5%8F%AF%E4%BB%A5%E5%9C%A8%20config%20%E6%96%87%E4%BB%B6%E4%B8%AD%E8%A6%86%E7%9B%96%E9%BB%98%E8%AE%A4%E5%80%BC%EF%BC%9A%0A%0A%60%60%60js%0A%2F%2F%20config%2Fconfig.%24%7Benv%7D.js%0Amodule.exports%20%3D%20appInfo%20%3D%3E%20%7B%0A%20%20return%20%7B%0A%20%20%20%20logger%3A%20%7B%0A%20%20%20%20%20%20appLogName%3A%20%60%24%7BappInfo.name%7D-web.log%60%2C%0A%20%20%20%20%20%20coreLogName%3A%20'egg-web.log'%2C%0A%20%20%20%20%20%20agentLogName%3A%20'egg-agent.log'%2C%0A%20%20%20%20%20%20errorLogName%3A%20'common-error.log'%2C%0A%20%20%20%20%7D%2C%0A%20%20%7D%3B%0A%7D%3B%0A%60%60%60%0A%0A%23%23%20%E5%A6%82%E4%BD%95%E6%89%93%E5%8D%B0%E6%97%A5%E5%BF%97%0A%0A%23%23%23%20Context%20Logger%0A%0A%E5%A6%82%E6%9E%9C%E6%88%91%E4%BB%AC%E5%9C%A8%E5%A4%84%E7%90%86%E8%AF%B7%E6%B1%82%E6%97%B6%E9%9C%80%E8%A6%81%E6%89%93%E5%8D%B0%E6%97%A5%E5%BF%97%EF%BC%8C%E8%BF%99%E6%97%B6%E5%80%99%E4%BD%BF%E7%94%A8%20Context%20Logger%EF%BC%8C%E7%94%A8%E4%BA%8E%E8%AE%B0%E5%BD%95%20Web%20%E8%A1%8C%E4%B8%BA%E7%9B%B8%E5%85%B3%E7%9A%84%E6%97%A5%E5%BF%97%E3%80%82%0A%0A%E6%AF%8F%E8%A1%8C%E6%97%A5%E5%BF%97%E4%BC%9A%E8%87%AA%E5%8A%A8%E8%AE%B0%E5%BD%95%E4%B8%8A%E5%BD%93%E5%89%8D%E8%AF%B7%E6%B1%82%E7%9A%84%E4%B8%80%E4%BA%9B%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF%EF%BC%8C%0A%E5%A6%82%20%60%5B%24userId%2F%24ip%2F%24traceId%2F%24%7Bcost%7Dms%20%24method%20%24url%5D%60%E3%80%82%0A%0A%60%60%60js%0Actx.logger.debug('debug%20info')%3B%0Actx.logger.info('some%20request%20data%3A%20%25j'%2C%20ctx.request.body)%3B%0Actx.logger.warn('WARNNING!!!!')%3B%0A%0A%2F%2F%20%E9%94%99%E8%AF%AF%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95%EF%BC%8C%E7%9B%B4%E6%8E%A5%E4%BC%9A%E5%B0%86%E9%94%99%E8%AF%AF%E6%97%A5%E5%BF%97%E5%AE%8C%E6%95%B4%E5%A0%86%E6%A0%88%E4%BF%A1%E6%81%AF%E8%AE%B0%E5%BD%95%E4%B8%8B%E6%9D%A5%EF%BC%8C%E5%B9%B6%E4%B8%94%E8%BE%93%E5%87%BA%E5%88%B0%20errorLog%20%E4%B8%AD%0A%2F%2F%20%E4%B8%BA%E4%BA%86%E4%BF%9D%E8%AF%81%E5%BC%82%E5%B8%B8%E5%8F%AF%E8%BF%BD%E8%B8%AA%EF%BC%8C%E5%BF%85%E9%A1%BB%E4%BF%9D%E8%AF%81%E6%89%80%E6%9C%89%E6%8A%9B%E5%87%BA%E7%9A%84%E5%BC%82%E5%B8%B8%E9%83%BD%E6%98%AF%20Error%20%E7%B1%BB%E5%9E%8B%EF%BC%8C%E5%9B%A0%E4%B8%BA%E5%8F%AA%E6%9C%89%20Error%20%E7%B1%BB%E5%9E%8B%E6%89%8D%E4%BC%9A%E5%B8%A6%E4%B8%8A%E5%A0%86%E6%A0%88%E4%BF%A1%E6%81%AF%EF%BC%8C%E5%AE%9A%E4%BD%8D%E5%88%B0%E9%97%AE%E9%A2%98%E3%80%82%0Actx.logger.error(new%20Error('whoops'))%3B%0A%60%60%60%0A%0A%E5%AF%B9%E4%BA%8E%E6%A1%86%E6%9E%B6%E5%BC%80%E5%8F%91%E8%80%85%E5%92%8C%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E8%80%85%E4%BC%9A%E4%BD%BF%E7%94%A8%E5%88%B0%E7%9A%84%20Context%20Logger%20%E8%BF%98%E6%9C%89%20%60ctx.coreLogger%60%E3%80%82%0A%0A%E4%BE%8B%E5%A6%82%0A%0A%60%60%60js%0Actx.coreLogger.info('info')%3B%0A%60%60%60%0A%0A%23%23%23%20App%20Logger%0A%0A%E5%A6%82%E6%9E%9C%E6%88%91%E4%BB%AC%E6%83%B3%E5%81%9A%E4%B8%80%E4%BA%9B%E5%BA%94%E7%94%A8%E7%BA%A7%E5%88%AB%E7%9A%84%E6%97%A5%E5%BF%97%E8%AE%B0%E5%BD%95%EF%BC%8C%E5%A6%82%E8%AE%B0%E5%BD%95%E5%90%AF%E5%8A%A8%E9%98%B6%E6%AE%B5%E7%9A%84%E4%B8%80%E4%BA%9B%E6%95%B0%E6%8D%AE%E4%BF%A1%E6%81%AF%EF%BC%8C%E5%8F%AF%E4%BB%A5%E9%80%9A%E8%BF%87%20App%20Logger%20%E6%9D%A5%E5%AE%8C%E6%88%90%E3%80%82%0A%0A%60%60%60js%0A%2F%2F%20app.js%0Amodule.exports%20%3D%20app%20%3D%3E%20%7B%0A%20%20app.logger.debug('debug%20info')%3B%0A%20%20app.logger.info('%E5%90%AF%E5%8A%A8%E8%80%97%E6%97%B6%20%25d%20ms'%2C%20Date.now()%20-%20start)%3B%0A%20%20app.logger.warn('warning!')%3B%0A%0A%20%20app.logger.error(someErrorObj)%3B%0A%7D%3B%0A%60%60%60%0A%0A%E5%AF%B9%E4%BA%8E%E6%A1%86%E6%9E%B6%E5%92%8C%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E8%80%85%E4%BC%9A%E4%BD%BF%E7%94%A8%E5%88%B0%E7%9A%84%20App%20Logger%20%E8%BF%98%E6%9C%89%20%60app.coreLogger%60%E3%80%82%0A%0A%60%60%60js%0A%2F%2F%20app.js%0Amodule.exports%20%3D%20app%20%3D%3E%20%7B%0A%20%20app.coreLogger.info('%E5%90%AF%E5%8A%A8%E8%80%97%E6%97%B6%20%25d%20ms'%2C%20Date.now()%20-%20start)%3B%0A%7D%3B%0A%60%60%60%0A%0A%23%23%23%20Agent%20Logger%0A%0A%E5%9C%A8%E5%BC%80%E5%8F%91%E6%A1%86%E6%9E%B6%E5%92%8C%E6%8F%92%E4%BB%B6%E6%97%B6%E6%9C%89%E6%97%B6%E4%BC%9A%E9%9C%80%E8%A6%81%E5%9C%A8%20Agent%20%E8%BF%9B%E7%A8%8B%E8%BF%90%E8%A1%8C%E4%BB%A3%E7%A0%81%EF%BC%8C%E8%BF%99%E6%97%B6%E4%BD%BF%E7%94%A8%20%60agent.coreLogger%60%E3%80%82%0A%0A%60%60%60js%0A%2F%2F%20agent.js%0Amodule.exports%20%3D%20agent%20%3D%3E%20%7B%0A%20%20agent.logger.debug('debug%20info')%3B%0A%20%20agent.logger.info('%E5%90%AF%E5%8A%A8%E8%80%97%E6%97%B6%20%25d%20ms'%2C%20Date.now()%20-%20start)%3B%0A%20%20agent.logger.warn('warning!')%3B%0A%0A%20%20agent.logger.error(someErrorObj)%3B%0A%7D%3B%0A%60%60%60%0A%0A%E5%A6%82%E9%9C%80%E8%AF%A6%E7%BB%86%E4%BA%86%E8%A7%A3%20Agent%20%E8%BF%9B%E7%A8%8B%EF%BC%8C%E8%AF%B7%E5%8F%82%E8%80%83%5B%E5%A4%9A%E8%BF%9B%E7%A8%8B%E6%A8%A1%E5%9E%8B%5D(.%2Fcluster-and-ipc.md)%E3%80%82%0A%0A%23%23%20%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E7%BC%96%E7%A0%81%0A%0A%E9%BB%98%E8%AE%A4%E7%BC%96%E7%A0%81%E4%B8%BA%20%60utf-8%60%EF%BC%8C%E5%8F%AF%E9%80%9A%E8%BF%87%E5%A6%82%E4%B8%8B%E6%96%B9%E5%BC%8F%E8%A6%86%E7%9B%96%EF%BC%9A%0A%0A%60%60%60js%0A%2F%2F%20config%2Fconfig.%24%7Benv%7D.js%0Aexports.logger%20%3D%20%7B%0A%20%20encoding%3A%20'gbk'%2C%0A%7D%3B%0A%60%60%60%0A%0A%23%23%20%E6%97%A5%E5%BF%97%E7%BA%A7%E5%88%AB%0A%0A%E6%97%A5%E5%BF%97%E5%88%86%E4%B8%BA%20%60NONE%60%EF%BC%8C%60DEBUG%60%EF%BC%8C%60INFO%60%EF%BC%8C%60WARN%60%20%E5%92%8C%20%60ERROR%60%205%20%E4%B8%AA%E7%BA%A7%E5%88%AB%E3%80%82%0A%0A%E6%97%A5%E5%BF%97%E6%89%93%E5%8D%B0%E5%88%B0%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84%E5%90%8C%E6%97%B6%EF%BC%8C%E4%B8%BA%E4%BA%86%E6%96%B9%E4%BE%BF%E5%BC%80%E5%8F%91%EF%BC%8C%E4%B9%9F%E4%BC%9A%E5%90%8C%E6%97%B6%E6%89%93%E5%8D%B0%E5%88%B0%E7%BB%88%E7%AB%AF%E4%B8%AD%E3%80%82%0A%0A%23%23%23%20%E6%96%87%E4%BB%B6%E6%97%A5%E5%BF%97%E7%BA%A7%E5%88%AB%0A%0A%E9%BB%98%E8%AE%A4%E5%8F%AA%E4%BC%9A%E8%BE%93%E5%87%BA%20%60INFO%60%20%E5%8F%8A%E4%BB%A5%E4%B8%8A%EF%BC%88%60WARN%60%20%E5%92%8C%20%60ERROR%60%EF%BC%89%E7%9A%84%E6%97%A5%E5%BF%97%E5%88%B0%E6%96%87%E4%BB%B6%E4%B8%AD%E3%80%82%0A%0A%E5%8F%AF%E9%80%9A%E8%BF%87%E5%A6%82%E4%B8%8B%E6%96%B9%E5%BC%8F%E9%85%8D%E7%BD%AE%E8%BE%93%E5%87%BA%E5%88%B0%E6%96%87%E4%BB%B6%E6%97%A5%E5%BF%97%E7%9A%84%E7%BA%A7%E5%88%AB%EF%BC%9A%0A%0A%E6%89%93%E5%8D%B0%E6%89%80%E6%9C%89%E7%BA%A7%E5%88%AB%E6%97%A5%E5%BF%97%E5%88%B0%E6%96%87%E4%BB%B6%E4%B8%AD%EF%BC%9A%0A%0A%60%60%60js%0A%2F%2F%20config%2Fconfig.%24%7Benv%7D.js%0Aexports.logger%20%3D%20%7B%0A%20%20level%3A%20'DEBUG'%2C%0A%7D%3B%0A%60%60%60%0A%0A%E5%85%B3%E9%97%AD%E6%89%80%E6%9C%89%E6%89%93%E5%8D%B0%E5%88%B0%E6%96%87%E4%BB%B6%E7%9A%84%E6%97%A5%E5%BF%97%EF%BC%9A%0A%0A%60%60%60js%0A%2F%2F%20config%2Fconfig.%24%7Benv%7D.js%0Aexports.logger%20%3D%20%7B%0A%20%20level%3A%20'NONE'%2C%0A%7D%3B%0A%60%60%60%0A%0A%23%23%23%23%20%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E6%89%93%E5%8D%B0%20debug%20%E6%97%A5%E5%BF%97%0A%0A%E4%B8%BA%E4%BA%86%E9%81%BF%E5%85%8D%E4%B8%80%E4%BA%9B%E6%8F%92%E4%BB%B6%E7%9A%84%E8%B0%83%E8%AF%95%E6%97%A5%E5%BF%97%E5%9C%A8%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E6%89%93%E5%8D%B0%E5%AF%BC%E8%87%B4%E6%80%A7%E8%83%BD%E9%97%AE%E9%A2%98%EF%BC%8C%08%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E9%BB%98%E8%AE%A4%E7%A6%81%E6%AD%A2%E6%89%93%E5%8D%B0%20DEBUG%20%E7%BA%A7%E5%88%AB%E7%9A%84%E6%97%A5%E5%BF%97%EF%BC%8C%E5%A6%82%E6%9E%9C%E7%A1%AE%E5%AE%9E%E6%9C%89%E9%9C%80%E6%B1%82%E5%9C%A8%E7%94%9F%E4%BA%A7%E7%8E%AF%E5%A2%83%E6%89%93%E5%8D%B0%20DEBUG%20%E6%97%A5%E5%BF%97%E8%BF%9B%E8%A1%8C%E8%B0%83%E8%AF%95%EF%BC%8C%E9%9C%80%E8%A6%81%E6%89%93%E5%BC%80%20%60allowDebugAtProd%60%20%E9%85%8D%E7%BD%AE%E9%A1%B9%E3%80%82%0A%0A%60%60%60js%0A%2F%2F%20config%2Fconfig.prod.js%0Aexports.logger%20%3D%20%7B%0A%20%20level%3A%20'DEBUG'%2C%0A%20%20allowDebugAtProd%3A%20true%2C%0A%7D%3B%0A%60%60%60%0A%0A%23%23%23%20%E7%BB%88%E7%AB%AF%E6%97%A5%E5%BF%97%E7%BA%A7%E5%88%AB%0A%0A%E9%BB%98%E8%AE%A4%E5%8F%AA%E4%BC%9A%E8%BE%93%E5%87%BA%20%60INFO%60%20%E5%8F%8A%E4%BB%A5%E4%B8%8A%EF%BC%88%60WARN%60%20%E5%92%8C%20%60ERROR%60%EF%BC%89%E7%9A%84%E6%97%A5%E5%BF%97%E5%88%B0%E7%BB%88%E7%AB%AF%E4%B8%AD%E3%80%82%0A%0A-%20%60logger.consoleLevel%60%3A%20%E8%BE%93%E5%87%BA%E5%88%B0%E7%BB%88%E7%AB%AF%E6%97%A5%E5%BF%97%E7%9A%84%E7%BA%A7%E5%88%AB%EF%BC%8C%E9%BB%98%E8%AE%A4%E4%B8%BA%20%60INFO%60%0A%0A%E5%8F%AF%E9%80%9A%E8%BF%87%E5%A6%82%E4%B8%8B%E6%96%B9%E5%BC%8F%E9%85%8D%E7%BD%AE%E8%BE%93%E5%87%BA%E5%88%B0%E7%BB%88%E7%AB%AF%E6%97%A5%E5%BF%97%E7%9A%84%E7%BA%A7%E5%88%AB%EF%BC%9A%0A%0A%E6%89%93%E5%8D%B0%E6%89%80%E6%9C%89%E7%BA%A7%E5%88%AB%E6%97%A5%E5%BF%97%E5%88%B0%E7%BB%88%E7%AB%AF%EF%BC%9A%0A%0A%60%60%60js%0A%2F%2F%20config%2Fconfig.%24%7Benv%7D.js%0Aexports.logger%20%3D%20%7B%0A%20%20consoleLevel%3A%20'DEBUG'%2C%0A%7D%3B%0A%60%60%60%0A%0A%E5%85%B3%E9%97%AD%E6%89%80%E6%9C%89%E6%89%93%E5%8D%B0%E5%88%B0%E7%BB%88%E7%AB%AF%E7%9A%84%E6%97%A5%E5%BF%97%EF%BC%9A%0A%0A%60%60%60js%0A%2F%2F%20config%2Fconfig.%24%7Benv%7D.js%0Aexports.logger%20%3D%20%7B%0A%20%20consoleLevel%3A%20'NONE'%2C%0A%7D%3B%0A%60%60%60%0A%0A%23%23%20%E8%87%AA%E5%AE%9A%E4%B9%89%E6%97%A5%E5%BF%97%0A%0A%23%23%23%20%E5%A2%9E%E5%8A%A0%E8%87%AA%E5%AE%9A%E4%B9%89%E6%97%A5%E5%BF%97%0A%0A**%E4%B8%80%E8%88%AC%E5%BA%94%E7%94%A8%E6%97%A0%E9%9C%80%E9%85%8D%E7%BD%AE%E8%87%AA%E5%AE%9A%E4%B9%89%E6%97%A5%E5%BF%97**%EF%BC%8C%E5%9B%A0%E4%B8%BA%E6%97%A5%E5%BF%97%E6%89%93%E5%A4%AA%E5%A4%9A%E6%88%96%E5%A4%AA%E5%88%86%E6%95%A3%E9%83%BD%E4%BC%9A%E5%AF%BC%E8%87%B4%E5%85%B3%E6%B3%A8%E5%BA%A6%E5%88%86%E6%95%A3%EF%BC%8C%E5%8F%8D%E8%80%8C%E9%9A%BE%E4%BB%A5%E7%AE%A1%E7%90%86%E5%92%8C%E9%9A%BE%E4%BB%A5%E6%8E%92%E6%9F%A5%E5%8F%91%E7%8E%B0%E9%97%AE%E9%A2%98%E3%80%82%0A%0A%E5%A6%82%E6%9E%9C%E5%AE%9E%E5%9C%A8%E6%9C%89%E9%9C%80%E6%B1%82%E5%8F%AF%E4%BB%A5%E5%A6%82%E4%B8%8B%E9%85%8D%E7%BD%AE%EF%BC%9A%0A%0A%60%60%60js%0A%2F%2F%20config%2Fconfig.%24%7Benv%7D.js%0Aconst%20path%20%3D%20require('path')%3B%0A%0Amodule.exports%20%3D%20appInfo%20%3D%3E%20%7B%0A%20%20return%20%7B%0A%20%20%20%20customLogger%3A%20%7B%0A%20%20%20%20%20%20xxLogger%3A%20%7B%0A%20%20%20%20%20%20%20%20file%3A%20path.join(appInfo.root%2C%20'logs%2Fxx.log')%2C%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%7D%2C%0A%20%20%7D%3B%0A%7D%3B%0A%60%60%60%0A%0A%E5%8F%AF%E9%80%9A%E8%BF%87%20%60app.getLogger('xxLogger')%60%20%2F%20%60ctx.getLogger('xxLogger')%60%20%E8%8E%B7%E5%8F%96%EF%BC%8C%E6%9C%80%E7%BB%88%E7%9A%84%E6%89%93%E5%8D%B0%E7%BB%93%E6%9E%9C%E5%92%8C%20coreLogger%20%E7%B1%BB%E4%BC%BC%E3%80%82%0A%0A%23%23%23%20%E9%AB%98%E7%BA%A7%E8%87%AA%E5%AE%9A%E4%B9%89%E6%97%A5%E5%BF%97%0A%0A%E6%97%A5%E5%BF%97%E9%BB%98%E8%AE%A4%E6%98%AF%E6%89%93%E5%8D%B0%E5%88%B0%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E4%B8%AD%EF%BC%8C%E5%BD%93%E6%9C%AC%E5%9C%B0%E5%BC%80%E5%8F%91%E6%97%B6%E5%90%8C%E6%97%B6%E4%BC%9A%E6%89%93%E5%8D%B0%E5%88%B0%E7%BB%88%E7%AB%AF%E3%80%82%0A%E4%BD%86%E6%98%AF%EF%BC%8C%E6%9C%89%E6%97%B6%E5%80%99%E6%88%91%E4%BB%AC%E4%BC%9A%E6%9C%89%E9%9C%80%E6%B1%82%E6%8A%8A%E6%97%A5%E5%BF%97%E6%89%93%E5%8D%B0%E5%88%B0%E5%85%B6%E4%BB%96%E5%AA%92%E4%BB%8B%E4%B8%8A%EF%BC%8C%E8%BF%99%E6%97%B6%E5%80%99%E6%88%91%E4%BB%AC%E5%B0%B1%E9%9C%80%E8%A6%81%E8%87%AA%E5%AE%9A%E4%B9%89%E6%97%A5%E5%BF%97%E7%9A%84%20transport%E3%80%82%0A%0ATransport%20%E6%98%AF%E4%B8%80%E7%A7%8D%E4%BC%A0%E8%BE%93%E9%80%9A%E9%81%93%EF%BC%8C%E4%B8%80%E4%B8%AA%20logger%20%E5%8F%AF%E5%8C%85%E5%90%AB%E5%A4%9A%E4%B8%AA%E4%BC%A0%E8%BE%93%E9%80%9A%E9%81%93%E3%80%82%E6%AF%94%E5%A6%82%E9%BB%98%E8%AE%A4%E7%9A%84%20logger%20%E5%B0%B1%E6%9C%89%20fileTransport%20%E5%92%8C%20consoleTransport%20%E4%B8%A4%E4%B8%AA%E9%80%9A%E9%81%93%EF%BC%8C%0A%E5%88%86%E5%88%AB%E8%B4%9F%E8%B4%A3%E6%89%93%E5%8D%B0%E5%88%B0%E6%96%87%E4%BB%B6%E5%92%8C%E7%BB%88%E7%AB%AF%E3%80%82%0A%0A%E4%B8%BE%E4%B8%AA%E4%BE%8B%E5%AD%90%EF%BC%8C%E6%88%91%E4%BB%AC%E4%B8%8D%E4%BB%85%E9%9C%80%E8%A6%81%E6%8A%8A%E9%94%99%E8%AF%AF%E6%97%A5%E5%BF%97%E6%89%93%E5%8D%B0%E5%88%B0%20%60common-error.log%60%EF%BC%8C%E8%BF%98%E9%9C%80%E8%A6%81%E4%B8%8A%E6%8A%A5%E7%BB%99%E7%AC%AC%E4%B8%89%E6%96%B9%E6%9C%8D%E5%8A%A1%E3%80%82%0A%0A%E9%A6%96%E5%85%88%E6%88%91%E4%BB%AC%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AA%E6%97%A5%E5%BF%97%E7%9A%84%20transport%EF%BC%8C%E4%BB%A3%E8%A1%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E6%97%A5%E5%BF%97%E6%9C%8D%E5%8A%A1%E3%80%82%0A%0A%60%60%60js%0Aconst%20util%20%3D%20require('util')%3B%0Aconst%20Transport%20%3D%20require('egg-logger').Transport%3B%0A%0Aclass%20RemoteErrorTransport%20extends%20Transport%20%7B%0A%0A%20%20%2F%2F%20%E5%AE%9A%E4%B9%89%20log%20%E6%96%B9%E6%B3%95%EF%BC%8C%E5%9C%A8%E6%AD%A4%E6%96%B9%E6%B3%95%E4%B8%AD%E6%8A%8A%E6%97%A5%E5%BF%97%E4%B8%8A%E6%8A%A5%E7%BB%99%E8%BF%9C%E7%AB%AF%E6%9C%8D%E5%8A%A1%0A%20%20log(level%2C%20args)%20%7B%0A%20%20%20%20let%20log%3B%0A%20%20%20%20if%20(args%5B0%5D%20instanceof%20Error)%20%7B%0A%20%20%20%20%20%20const%20err%20%3D%20args%5B0%5D%3B%0A%20%20%20%20%20%20log%20%3D%20util.format('%25s%3A%20%25s%5Cn%25s%5Cnpid%3A%20%25s%5Cn'%2C%20err.name%2C%20err.message%2C%20err.stack%2C%20process.pid)%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20log%20%3D%20util.format(...args)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20this.options.app.curl('http%3A%2F%2Furl%2Fto%2Fremote%2Ferror%2Flog%2Fservice%2Flogs'%2C%20%7B%0A%20%20%20%20%20%20data%3A%20log%2C%0A%20%20%20%20%20%20method%3A%20'POST'%2C%0A%20%20%20%20%7D).catch(console.error)%3B%0A%20%20%7D%0A%7D%0A%0A%2F%2F%20app.js%20%E4%B8%AD%E7%BB%99%20errorLogger%20%E6%B7%BB%E5%8A%A0%20transport%EF%BC%8C%E8%BF%99%E6%A0%B7%E6%AF%8F%E6%9D%A1%E6%97%A5%E5%BF%97%E5%B0%B1%E4%BC%9A%E5%90%8C%E6%97%B6%E6%89%93%E5%8D%B0%E5%88%B0%E8%BF%99%E4%B8%AA%20transport%20%E4%BA%86%0Aapp.getLogger('errorLogger').set('remote'%2C%20new%20RemoteErrorTransport(%7B%20level%3A%20'ERROR'%2C%20app%20%7D))%3B%0A%60%60%60%0A%0A%E4%B8%8A%E9%9D%A2%E7%9A%84%E4%BE%8B%E5%AD%90%E6%AF%94%E8%BE%83%E7%AE%80%E5%8D%95%EF%BC%8C%E5%AE%9E%E9%99%85%E6%83%85%E5%86%B5%E4%B8%AD%E6%88%91%E4%BB%AC%E9%9C%80%E8%A6%81%E8%80%83%E8%99%91%E6%80%A7%E8%83%BD%EF%BC%8C%E5%BE%88%E5%8F%AF%E8%83%BD%E9%87%87%E5%8F%96%E5%85%88%E6%89%93%E5%8D%B0%E5%88%B0%E5%86%85%E5%AD%98%EF%BC%8C%E5%86%8D%E5%AE%9A%E6%97%B6%E4%B8%8A%E4%BC%A0%E7%9A%84%E7%AD%96%E7%95%A5%EF%BC%8C%E4%BB%A5%E6%8F%90%E9%AB%98%E6%80%A7%E8%83%BD%E3%80%82%0A%0A%23%23%20%E6%97%A5%E5%BF%97%E5%88%87%E5%89%B2%0A%0A%E4%BC%81%E4%B8%9A%E7%BA%A7%E6%97%A5%E5%BF%97%E4%B8%80%E4%B8%AA%E6%9C%80%E5%B8%B8%E8%A7%81%E7%9A%84%E9%9C%80%E6%B1%82%E4%B9%8B%E4%B8%80%E6%98%AF%E5%AF%B9%E6%97%A5%E5%BF%97%E8%BF%9B%E8%A1%8C%E8%87%AA%E5%8A%A8%E5%88%87%E5%89%B2%EF%BC%8C%E4%BB%A5%E6%96%B9%E4%BE%BF%E7%AE%A1%E7%90%86%E3%80%82%E6%A1%86%E6%9E%B6%E5%AF%B9%E6%97%A5%E5%BF%97%E5%88%87%E5%89%B2%E7%9A%84%E6%94%AF%E6%8C%81%E7%94%B1%20%5Begg-logrotator%5D(https%3A%2F%2Fgithub.com%2Feggjs%2Fegg-logrotator)%20%E6%8F%92%E4%BB%B6%E6%8F%90%E4%BE%9B%E3%80%82%0A%0A%23%23%23%20%E6%8C%89%E5%A4%A9%E5%88%87%E5%89%B2%0A%0A%E8%BF%99%E6%98%AF%E6%A1%86%E6%9E%B6%E7%9A%84%E9%BB%98%E8%AE%A4%E6%97%A5%E5%BF%97%E5%88%87%E5%89%B2%E6%96%B9%E5%BC%8F%EF%BC%8C%E5%9C%A8%E6%AF%8F%E6%97%A5%20%6000%3A00%60%20%E6%8C%89%E7%85%A7%20%60.log.YYYY-MM-DD%60%20%E6%96%87%E4%BB%B6%E5%90%8D%E8%BF%9B%E8%A1%8C%E5%88%87%E5%89%B2%E3%80%82%0A%0A%E4%BB%A5%20appLog%20%E4%B8%BA%E4%BE%8B%EF%BC%8C%E5%BD%93%E5%89%8D%E5%86%99%E5%85%A5%E7%9A%84%E6%97%A5%E5%BF%97%E4%B8%BA%20%60example-app-web.log%60%EF%BC%8C%E5%BD%93%E5%87%8C%E6%99%A8%20%6000%3A00%60%20%E6%97%B6%EF%BC%8C%E4%BC%9A%E5%AF%B9%E6%97%A5%E5%BF%97%E8%BF%9B%E8%A1%8C%E5%88%87%E5%89%B2%EF%BC%8C%E6%8A%8A%E8%BF%87%E5%8E%BB%E4%B8%80%E5%A4%A9%E7%9A%84%E6%97%A5%E5%BF%97%E6%8C%89%20%60example-app-web.log.YYYY-MM-DD%60%20%E7%9A%84%E5%BD%A2%E5%BC%8F%E5%88%87%E5%89%B2%E4%B8%BA%E5%8D%95%E7%8B%AC%E7%9A%84%E6%96%87%E4%BB%B6%E3%80%82%0A%0A%23%23%23%20%E6%8C%89%E7%85%A7%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F%E5%88%87%E5%89%B2%0A%0A%E6%88%91%E4%BB%AC%E4%B9%9F%E5%8F%AF%E4%BB%A5%E6%8C%89%E7%85%A7%E6%96%87%E4%BB%B6%E5%A4%A7%E5%B0%8F%E8%BF%9B%E8%A1%8C%E5%88%87%E5%89%B2%E3%80%82%E4%BE%8B%E5%A6%82%EF%BC%8C%E5%BD%93%E6%96%87%E4%BB%B6%E8%B6%85%E8%BF%87%202G%20%E6%97%B6%E8%BF%9B%E8%A1%8C%E5%88%87%E5%89%B2%E3%80%82%0A%0A%E4%BE%8B%E5%A6%82%EF%BC%8C%E6%88%91%E4%BB%AC%E9%9C%80%E8%A6%81%E6%8A%8A%20%60egg-web.log%60%20%E6%8C%89%E7%85%A7%E5%A4%A7%E5%B0%8F%E8%BF%9B%E8%A1%8C%E5%88%87%E5%89%B2%EF%BC%9A%0A%0A%60%60%60js%0A%2F%2F%20config%2Fconfig.%24%7Benv%7D.js%0Aconst%20path%20%3D%20require('path')%3B%0A%0Amodule.exports%20%3D%20appInfo%20%3D%3E%20%7B%0A%20%20return%20%7B%0A%20%20%20%20logrotator%3A%20%7B%0A%20%20%20%20%20%20filesRotateBySize%3A%20%5B%0A%20%20%20%20%20%20%20%20path.join(appInfo.root%2C%20'logs'%2C%20appInfo.name%2C%20'egg-web.log')%2C%0A%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20maxFileSize%3A%202%20*%201024%20*%201024%20*%201024%2C%0A%20%20%20%20%7D%2C%0A%20%20%7D%3B%0A%7D%3B%0A%60%60%60%0A%0A%E6%B7%BB%E5%8A%A0%E5%88%B0%20%60filesRotateBySize%60%20%E7%9A%84%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E4%B8%8D%E5%86%8D%E6%8C%89%E5%A4%A9%E8%BF%9B%E8%A1%8C%E5%88%87%E5%89%B2%E3%80%82%0A%0A%23%23%23%20%E6%8C%89%E7%85%A7%E5%B0%8F%E6%97%B6%E5%88%87%E5%89%B2%0A%0A%E6%88%91%E4%BB%AC%E4%B9%9F%E5%8F%AF%E4%BB%A5%E9%80%89%E6%8B%A9%E6%8C%89%E7%85%A7%E5%B0%8F%E6%97%B6%E8%BF%9B%E8%A1%8C%E5%88%87%E5%89%B2%EF%BC%8C%E8%BF%99%E5%92%8C%E9%BB%98%E8%AE%A4%E7%9A%84%E6%8C%89%E5%A4%A9%E5%88%87%E5%89%B2%E9%9D%9E%E5%B8%B8%E7%B1%BB%E4%BC%BC%EF%BC%8C%E5%8F%AA%E6%98%AF%E6%97%B6%E9%97%B4%E7%BC%A9%E7%9F%AD%E5%88%B0%E6%AF%8F%E5%B0%8F%E6%97%B6%E3%80%82%0A%0A%E4%BE%8B%E5%A6%82%EF%BC%8C%E6%88%91%E4%BB%AC%E9%9C%80%E8%A6%81%E6%8A%8A%20%60common-error.log%60%20%E6%8C%89%E7%85%A7%E5%B0%8F%E6%97%B6%E8%BF%9B%E8%A1%8C%E5%88%87%E5%89%B2%EF%BC%9A%0A%0A%60%60%60js%0A%2F%2F%20config%2Fconfig.%24%7Benv%7D.js%0Aconst%20path%20%3D%20require('path')%3B%0A%0Amodule.exports%20%3D%20appInfo%20%3D%3E%20%7B%0A%20%20return%20%7B%0A%20%20%20%20logrotator%3A%20%7B%0A%20%20%20%20%20%20filesRotateByHour%3A%20%5B%0A%20%20%20%20%20%20%20%20path.join(appInfo.root%2C%20'logs'%2C%20appInfo.name%2C%20'common-error.log')%2C%0A%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%7D%2C%0A%20%20%7D%3B%0A%7D%3B%0A%60%60%60%0A%0A%E6%B7%BB%E5%8A%A0%E5%88%B0%20%60filesRotateByHour%60%20%E7%9A%84%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%E4%B8%8D%E5%86%8D%E8%A2%AB%E6%8C%89%E5%A4%A9%E8%BF%9B%E8%A1%8C%E5%88%87%E5%89%B2%E3%80%82%0A%0A%23%23%20%E6%80%A7%E8%83%BD%0A%0A%E9%80%9A%E5%B8%B8%20Web%20%E8%AE%BF%E9%97%AE%E6%98%AF%E9%AB%98%E9%A2%91%E8%AE%BF%E9%97%AE%EF%BC%8C%E6%AF%8F%E6%AC%A1%E6%89%93%E5%8D%B0%E6%97%A5%E5%BF%97%E9%83%BD%E5%86%99%E7%A3%81%E7%9B%98%E4%BC%9A%E9%80%A0%E6%88%90%E9%A2%91%E7%B9%81%E7%A3%81%E7%9B%98%20IO%EF%BC%8C%E4%B8%BA%E4%BA%86%E6%8F%90%E9%AB%98%E6%80%A7%E8%83%BD%EF%BC%8C%E6%88%91%E4%BB%AC%E9%87%87%E7%94%A8%E7%9A%84%E6%96%87%E4%BB%B6%E6%97%A5%E5%BF%97%E5%86%99%E5%85%A5%E7%AD%96%E7%95%A5%E6%98%AF%EF%BC%9A%0A%0A%3E%20%E6%97%A5%E5%BF%97%E5%90%8C%E6%AD%A5%E5%86%99%E5%85%A5%E5%86%85%E5%AD%98%EF%BC%8C%E5%BC%82%E6%AD%A5%E6%AF%8F%E9%9A%94%E4%B8%80%E6%AE%B5%E6%97%B6%E9%97%B4(%E9%BB%98%E8%AE%A4%201%20%E7%A7%92)%E5%88%B7%E7%9B%98%0A%0A%E6%9B%B4%E5%A4%9A%E8%AF%A6%E7%BB%86%E8%AF%B7%E5%8F%82%E8%80%83%20%5Begg-logger%5D(https%3A%2F%2Fgithub.com%2Feggjs%2Fegg-logger)%20%E5%92%8C%20%5Begg-logrotator%5D(https%3A%2F%2Fgithub.com%2Feggjs%2Fegg-logrotator)%E3%80%82%0A"}}</script><script type="text/javascript" src="/static/js/post.b9faab88.js"></script></body></html>