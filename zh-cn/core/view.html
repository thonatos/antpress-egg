<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="theme-color" content="#000000"><link rel="manifest" href="/manifest.json"><link rel="shortcut icon" href="/favicon.png"><style class="_styletron_hydrate_"></style><title>View 模板渲染</title><meta name="description" content="Born to build better enterprise frameworks and apps"><link href="/static/css/post.d62265dc.css" rel="stylesheet"></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><div class="ant-layout" data-reactroot=""><div class="header-module__header___3ADJ9 ant-layout-header"><div class="ant-row-flex"><div class="ant-col-xs-12 ant-col-md-20 ant-col-lg-2"><div class="header-module__logo___3yTXp"><a href="/"><img src="/logo.svg" alt="logo"/></a></div></div><div class="ant-col-xs-0 ant-col-md-0 ant-col-lg-20"><ul class="ant-menu header-module__menu___3yEtW ant-menu-light ant-menu-root ant-menu-horizontal" role="menu"><li class="ant-menu-item" role="menuitem"><a href="/zh-cn/intro/">指南</a></li><li class="ant-menu-item" role="menuitem"><a href="/api/">API</a></li><li class="ant-menu-item" role="menuitem"><a href="/zh-cn/tutorials/index.html">教程</a></li><li class="ant-menu-item" role="menuitem"><a href="https://github.com/search?q=topic%3Aegg-plugin&amp;type=Repositories">插件</a></li><li class="ant-menu-item" role="menuitem"><a href="https://github.com/eggjs/egg/releases">发布日志</a></li></ul></div><div style="text-align:right" class="ant-col-xs-12 ant-col-md-4 ant-col-lg-2"><button type="button" class="ant-btn"><span>Languages</span></button></div></div></div><div class="ant-layout-content"><div class="basic_layout-module__content___3flpY ant-layout"><div class="sider-module__side___1Cadj ant-layout-sider ant-layout-sider-light" style="flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"><ul class="ant-menu sider-module__menu___2GqPr ant-menu-light ant-menu-root ant-menu-inline" role="menu"><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="0$Menu" aria-haspopup="true"><span>新手指南</span><i class="ant-menu-submenu-arrow"></i></div><ul id="0$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/intro/index.html">Egg.js 是什么?</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/intro/egg-and-koa.html">Egg.js 和 Koa</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/intro/quickstart.html">快速入门</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/tutorials/progressive.html">渐进式开发</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/migration.html">2.x 升级指南</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="1$Menu" aria-haspopup="true"><span>基础功能</span><i class="ant-menu-submenu-arrow"></i></div><ul id="1$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/structure.html">目录结构</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/objects.html">内置对象</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/env.html">运行环境</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/config.html">配置</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/middleware.html">中间件</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/router.html">Router</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/controller.html">Controller</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/service.html">Service</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/plugin.html">插件</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/schedule.html">定时任务</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/extend.html">框架扩展</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/basics/app-start.html">启动自定义</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="2$Menu" aria-haspopup="true"><span>核心功能</span><i class="ant-menu-submenu-arrow"></i></div><ul id="2$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/core/development.html">本地开发</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/core/unittest.html">单元测试</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/core/deployment.html">应用部署</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/core/logger.html">日志</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/core/httpclient.html">HttpClient</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/core/cookie-and-session.html">Cookie and Session</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/core/cluster-and-ipc.html">多进程模型和进程间通讯</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/core/view.html">模板渲染</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/core/error-handling.html">异常处理</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/core/security.html">安全</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/core/i18n.html">国际化</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="3$Menu" aria-haspopup="true"><span>教程</span><i class="ant-menu-submenu-arrow"></i></div><ul id="3$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/tutorials/mysql.html">MySQL</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/tutorials/restful.html">RESTful API</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/tutorials/passport.html">Passport 鉴权</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/tutorials/socketio.html">Socket.IO</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/tutorials/assets.html">静态资源</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/tutorials/typescript.html">TypeScript</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="4$Menu" aria-haspopup="true"><span>进阶</span><i class="ant-menu-submenu-arrow"></i></div><ul id="4$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/advanced/loader.html">Loader</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/advanced/plugin.html">插件开发</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/advanced/framework.html">框架开发</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/advanced/cluster-client.html">多进程研发模式增强</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/advanced/view-plugin.html">模板插件开发规范</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/style-guide.html">代码风格指南</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="5$Menu" aria-haspopup="true"><span>社区</span><i class="ant-menu-submenu-arrow"></i></div><ul id="5$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/plugins/">内置插件列表</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/contributing.html">如何贡献</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/resource.html">资源</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/zh-cn/faq.html">常见问题</a></li></ul></li></ul></div></div><div class="basic_layout-module__post___2Z7KK ant-layout-content"><div class="ant-row" style="margin-left:-8px;margin-right:-8px"><div style="padding-left:8px;padding-right:8px" class="ant-col-xs-24 ant-col-md-18"><div class="markdown-body" style="font-size:14px"><div><p>绝大多数情况，我们都需要读取数据后渲染模板，然后呈现给用户。故我们需要引入对应的模板引擎。</p><p>框架内置 <a href="https://github.com/eggjs/egg-view">egg-view</a> 作为模板解决方案，并支持多模板渲染，每个模板引擎都以插件的方式引入，但保持渲染的 API 一致。如果想更深入的了解，可以查看<a href="../advanced/view-plugin.md">模板插件开发</a>。</p><p>以下以官方支持的 View 插件 <a href="https://github.com/eggjs/egg-view-nunjucks">egg-view-nunjucks</a> 为例</p><h2 id="引入-view-插件">引入 view 插件</h2><pre><code class="language-bash">$ npm i egg-view-nunjucks --save</code></pre><h3 id="启用插件">启用插件</h3><pre><code class="language-js">// config/plugin.js
exports.nunjucks = {
  enable: true,
  package: &#x27;egg-view-nunjucks&#x27;,
};</code></pre><h2 id="配置插件">配置插件</h2><p><a href="https://github.com/eggjs/egg-view">egg-view</a> 提供了 <code>config.view</code> 通用配置</p><h3 id="root-string">root {String}</h3><p>模板文件的根目录，为绝对路径，默认为 <code>${baseDir}/app/view</code>。支持配置多个目录，以 <code>,</code> 分割，会从多个目录查找文件。</p><p>如下示例演示了如何配置多个 <code>view</code> 目录：</p><pre><code class="language-js">// config/config.default.js
const path = require(&#x27;path&#x27;);
module.exports = appInfo =&gt; {
  const config = {};
  config.view = {
    root: [
      path.join(appInfo.baseDir, &#x27;app/view&#x27;),
      path.join(appInfo.baseDir, &#x27;path/to/another&#x27;),
    ].join(&#x27;,&#x27;)
  };
  return config;
};</code></pre><h3 id="cache-boolean">cache {Boolean}</h3><p>模板路径缓存，默认开启。框架会根据 root 配置的目录依次查找，如果匹配则会缓存文件路径，下次渲染相同路径时不会重新查找。</p><h3 id="mapping-和-defaultviewengine">mapping 和 defaultViewEngine</h3><p>每个模板在注册时都会指定一个模板名（viewEngineName），在使用时需要根据后缀来匹配模板名，比如指定 <code>.nj</code> 后缀的文件使用 Nunjucks 进行渲染。</p><pre><code class="language-js">module.exports = {
  view: {
    mapping: {
      &#x27;.nj&#x27;: &#x27;nunjucks&#x27;,
    },
  },
};</code></pre><p>调用 render 渲染文件时，会根据上述配置的后缀名去寻找对应的模板引擎。</p><pre><code class="language-js">await ctx.render(&#x27;home.nj&#x27;);</code></pre><p>必须配置文件后缀和模板引擎的映射，否则无法找到对应的模板引擎，但是可以使用 <code>defaultViewEngine</code> 做全局配置。</p><pre><code class="language-js">// config/config.default.js
module.exports = {
  view: {
    defaultViewEngine: &#x27;nunjucks&#x27;,
  },
};</code></pre><p>如果根据文件后缀没有找到对应的模板引擎，会使用默认的模板引擎进行渲染。对于只使用一种模板引擎的应用，建议配置此选项。</p><h3 id="defaultextension">defaultExtension</h3><p>一般在调用 render 时的第一个参数需要包含文件后缀，如果配置了 defaultExtension 可以省略后缀。</p><pre><code class="language-js">// config/config.default.js
module.exports = {
  view: {
    defaultExtension: &#x27;.nj&#x27;,
  },
};

// render app/view/home.nj
await ctx.render(&#x27;home&#x27;);</code></pre><h2 id="渲染页面">渲染页面</h2><p>框架在 Context 上提供了 3 个接口，返回值均为 Promise:</p><ul><li><code>render(name, locals)</code> 渲染模板文件, 并赋值给 ctx.body</li><li><code>renderView(name, locals)</code> 渲染模板文件, 仅返回不赋值</li><li><code>renderString(tpl, locals)</code> 渲染模板字符串, 仅返回不赋值</li></ul><pre><code class="language-js">// {app_root}/app/controller/home.js
class HomeController extends Controller {
  async index() {
    const data = { name: &#x27;egg&#x27; };

    // render a template, path relate to `app/view`
    await ctx.render(&#x27;home/index.tpl&#x27;, data);

    // or manually set render result to ctx.body
    ctx.body = await ctx.renderView(&#x27;path/to/file.tpl&#x27;, data);

    // or render string directly
    ctx.body = await ctx.renderString(&#x27;hi, {{ name }}&#x27;, data, {
      viewEngine: &#x27;nunjucks&#x27;,
    });
  }
}</code></pre><p>当使用 <code>renderString</code> 时需要指定模板引擎，如果已经定义 <code>defaultViewEngine</code> 这里可以省略。</p><h2 id="locals">Locals</h2><p>在渲染页面的过程中，我们通常需要一个变量来收集需要传递给模板的变量，在框架里面，我们提供了 <code>app.locals</code> 和 <code>ctx.locals</code>。</p><ul><li><code>app.locals</code> 为全局的，一般在 <code>app.js</code> 里面配置全局变量。</li><li><code>ctx.locals</code> 为单次请求的，会合并 <code>app.locals</code>。</li><li>可以直接赋值对象，框架在对应的 setter 里面会自动 merge。</li></ul><pre><code class="language-js">// `app.locals` 会合并到 `ctx.locals
ctx.app.locals = { a: 1 };
ctx.locals.b = 2;
console.log(ctx.locals); // { a: 1, b: 2 }

// 一次请求过程中，仅会在第一次使用 `ctx.locals` 时把 `app.locals` 合并进去。
ctx.app.locals = { a: 2 };
console.log(ctx.locals); // 上面已经合并过一次，故输出还是 { a: 1, b: 2 }

// 也可以直接赋值整个对象，不用担心会覆盖前面的值，我们通过 setter 做了自动合并。
ctx.locals.c = 3;
ctx.locals = { d: 4 };
console.log(ctx.locals); // { a: 1, b: 2, c: 3, d: 4 }</code></pre><p>但在实际业务开发中，controller 中一般不会直接使用这 2 个对象，直接使用 <code>ctx.render(name, data)</code> 即可：</p><ul><li>框架会自动把 <code>data</code> 合并到 <code>ctx.locals</code>。</li><li>框架会自动注入 <code>ctx</code>, <code>request</code>, <code>helper</code> 方便使用。</li></ul><pre><code class="language-js">ctx.app.locals = { appName: &#x27;showcase&#x27; };
const data = { name: &#x27;egg&#x27; };

// will auto merge `data` to `ctx.locals`, output: egg - showcase
await ctx.renderString(&#x27;{{ name }} - {{ appName }}&#x27;, data);

// helper, ctx, request will auto inject
await ctx.renderString(&#x27;{{ name }} - {{ helper.lowercaseFirst(ctx.app.config.baseDir) }}&#x27;, data);</code></pre><p>注意：</p><ul><li><strong>ctx.locals 有缓存，只在第一次访问 ctx.locals 时合并 app.locals。</strong></li><li>原 Koa 中的 <code>ctx.state</code>，由于容易产生歧义，在框架中被覆盖为 locals，即 <code>ctx.state</code> 和 <code>ctx.locals</code> 等价，我们建议使用后者。</li></ul><h2 id="helper">Helper</h2><p>在模板中可以直接使用 <code>helper</code> 上注册的方法，具体可以参见<a href="../basics/extend.md">扩展</a>。</p><pre><code class="language-js">// app/extend/helper.js
exports.lowercaseFirst = str =&gt; str[0].toLowerCase() + str.substring(1);

// app/controller/home.js
await ctx.renderString(&#x27;{{ helper.lowercaseFirst(name) }}&#x27;, data);</code></pre><h2 id="security">Security</h2><p>框架内置的 <a href="https://github.com/eggjs/egg-security">egg-security</a> 插件，为我们提供了常见的安全辅助函数，包括 <code>helper.shtml / surl / sjs</code> 等等等，强烈建议阅读下<a href="./security.md">安全</a>。</p></div></div></div><div style="padding-left:8px;padding-right:8px" class="ant-col-xs-0 ant-col-md-6"><div class="markdown-body" style="font-size:14px"><div><ul><li><a href="#%E5%BC%95%E5%85%A5-view-%E6%8F%92%E4%BB%B6">引入 view 插件</a><ul><li><a href="#%E5%90%AF%E7%94%A8%E6%8F%92%E4%BB%B6">启用插件</a></li></ul></li><li><a href="#%E9%85%8D%E7%BD%AE%E6%8F%92%E4%BB%B6">配置插件</a><ul><li><a href="#root-string">root {String}</a></li><li><a href="#cache-boolean">cache {Boolean}</a></li><li><a href="#mapping-%E5%92%8C-defaultviewengine">mapping 和 defaultViewEngine</a></li><li><a href="#defaultextension">defaultExtension</a></li></ul></li><li><a href="#%E6%B8%B2%E6%9F%93%E9%A1%B5%E9%9D%A2">渲染页面</a></li><li><a href="#locals">Locals</a></li><li><a href="#helper">Helper</a></li><li><a href="#security">Security</a></li></ul></div></div></div></div></div></div></div></div></div><script type="text/javascript">window.__INIT_STATE__={"lang":"zh","props":{"toc":"-%20%5B%E5%BC%95%E5%85%A5%20view%20%E6%8F%92%E4%BB%B6%5D(%23%25E5%25BC%2595%25E5%2585%25A5-view-%25E6%258F%2592%25E4%25BB%25B6)%0A%20%20*%20%5B%E5%90%AF%E7%94%A8%E6%8F%92%E4%BB%B6%5D(%23%25E5%2590%25AF%25E7%2594%25A8%25E6%258F%2592%25E4%25BB%25B6)%0A-%20%5B%E9%85%8D%E7%BD%AE%E6%8F%92%E4%BB%B6%5D(%23%25E9%2585%258D%25E7%25BD%25AE%25E6%258F%2592%25E4%25BB%25B6)%0A%20%20*%20%5Broot%20%7BString%7D%5D(%23root-string)%0A%20%20*%20%5Bcache%20%7BBoolean%7D%5D(%23cache-boolean)%0A%20%20*%20%5Bmapping%20%E5%92%8C%20defaultViewEngine%5D(%23mapping-%25E5%2592%258C-defaultviewengine)%0A%20%20*%20%5BdefaultExtension%5D(%23defaultextension)%0A-%20%5B%E6%B8%B2%E6%9F%93%E9%A1%B5%E9%9D%A2%5D(%23%25E6%25B8%25B2%25E6%259F%2593%25E9%25A1%25B5%25E9%259D%25A2)%0A-%20%5BLocals%5D(%23locals)%0A-%20%5BHelper%5D(%23helper)%0A-%20%5BSecurity%5D(%23security)","meta":{"info":{"title":"View 模板渲染"}},"content":"%0A%0A%0A%E7%BB%9D%E5%A4%A7%E5%A4%9A%E6%95%B0%E6%83%85%E5%86%B5%EF%BC%8C%E6%88%91%E4%BB%AC%E9%83%BD%E9%9C%80%E8%A6%81%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE%E5%90%8E%E6%B8%B2%E6%9F%93%E6%A8%A1%E6%9D%BF%EF%BC%8C%E7%84%B6%E5%90%8E%E5%91%88%E7%8E%B0%E7%BB%99%E7%94%A8%E6%88%B7%E3%80%82%E6%95%85%E6%88%91%E4%BB%AC%E9%9C%80%E8%A6%81%E5%BC%95%E5%85%A5%E5%AF%B9%E5%BA%94%E7%9A%84%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E%E3%80%82%0A%0A%E6%A1%86%E6%9E%B6%E5%86%85%E7%BD%AE%20%5Begg-view%5D%20%E4%BD%9C%E4%B8%BA%E6%A8%A1%E6%9D%BF%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%EF%BC%8C%E5%B9%B6%E6%94%AF%E6%8C%81%E5%A4%9A%E6%A8%A1%E6%9D%BF%E6%B8%B2%E6%9F%93%EF%BC%8C%E6%AF%8F%E4%B8%AA%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E%E9%83%BD%E4%BB%A5%E6%8F%92%E4%BB%B6%E7%9A%84%E6%96%B9%E5%BC%8F%E5%BC%95%E5%85%A5%EF%BC%8C%E4%BD%86%E4%BF%9D%E6%8C%81%E6%B8%B2%E6%9F%93%E7%9A%84%20API%20%E4%B8%80%E8%87%B4%E3%80%82%E5%A6%82%E6%9E%9C%E6%83%B3%E6%9B%B4%E6%B7%B1%E5%85%A5%E7%9A%84%E4%BA%86%E8%A7%A3%EF%BC%8C%E5%8F%AF%E4%BB%A5%E6%9F%A5%E7%9C%8B%5B%E6%A8%A1%E6%9D%BF%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%5D(..%2Fadvanced%2Fview-plugin.md)%E3%80%82%0A%0A%E4%BB%A5%E4%B8%8B%E4%BB%A5%E5%AE%98%E6%96%B9%E6%94%AF%E6%8C%81%E7%9A%84%20View%20%E6%8F%92%E4%BB%B6%20%5Begg-view-nunjucks%5D%20%E4%B8%BA%E4%BE%8B%0A%0A%23%23%20%E5%BC%95%E5%85%A5%20view%20%E6%8F%92%E4%BB%B6%0A%0A%60%60%60bash%0A%24%20npm%20i%20egg-view-nunjucks%20--save%0A%60%60%60%0A%0A%23%23%23%20%E5%90%AF%E7%94%A8%E6%8F%92%E4%BB%B6%0A%0A%60%60%60js%0A%2F%2F%20config%2Fplugin.js%0Aexports.nunjucks%20%3D%20%7B%0A%20%20enable%3A%20true%2C%0A%20%20package%3A%20'egg-view-nunjucks'%2C%0A%7D%3B%0A%60%60%60%0A%0A%23%23%20%E9%85%8D%E7%BD%AE%E6%8F%92%E4%BB%B6%0A%0A%5Begg-view%5D%20%E6%8F%90%E4%BE%9B%E4%BA%86%20%60config.view%60%20%E9%80%9A%E7%94%A8%E9%85%8D%E7%BD%AE%0A%0A%23%23%23%20root%20%7BString%7D%0A%0A%E6%A8%A1%E6%9D%BF%E6%96%87%E4%BB%B6%E7%9A%84%E6%A0%B9%E7%9B%AE%E5%BD%95%EF%BC%8C%E4%B8%BA%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84%EF%BC%8C%E9%BB%98%E8%AE%A4%E4%B8%BA%20%60%24%7BbaseDir%7D%2Fapp%2Fview%60%E3%80%82%E6%94%AF%E6%8C%81%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AA%E7%9B%AE%E5%BD%95%EF%BC%8C%E4%BB%A5%20%60%2C%60%20%E5%88%86%E5%89%B2%EF%BC%8C%E4%BC%9A%E4%BB%8E%E5%A4%9A%E4%B8%AA%E7%9B%AE%E5%BD%95%E6%9F%A5%E6%89%BE%E6%96%87%E4%BB%B6%E3%80%82%0A%0A%E5%A6%82%E4%B8%8B%E7%A4%BA%E4%BE%8B%E6%BC%94%E7%A4%BA%E4%BA%86%E5%A6%82%E4%BD%95%E9%85%8D%E7%BD%AE%E5%A4%9A%E4%B8%AA%20%60view%60%20%E7%9B%AE%E5%BD%95%EF%BC%9A%0A%0A%60%60%60js%0A%2F%2F%20config%2Fconfig.default.js%0Aconst%20path%20%3D%20require('path')%3B%0Amodule.exports%20%3D%20appInfo%20%3D%3E%20%7B%0A%20%20const%20config%20%3D%20%7B%7D%3B%0A%20%20config.view%20%3D%20%7B%0A%20%20%20%20root%3A%20%5B%0A%20%20%20%20%20%20path.join(appInfo.baseDir%2C%20'app%2Fview')%2C%0A%20%20%20%20%20%20path.join(appInfo.baseDir%2C%20'path%2Fto%2Fanother')%2C%0A%20%20%20%20%5D.join('%2C')%0A%20%20%7D%3B%0A%20%20return%20config%3B%0A%7D%3B%0A%60%60%60%0A%0A%23%23%23%20cache%20%7BBoolean%7D%0A%0A%E6%A8%A1%E6%9D%BF%E8%B7%AF%E5%BE%84%E7%BC%93%E5%AD%98%EF%BC%8C%E9%BB%98%E8%AE%A4%E5%BC%80%E5%90%AF%E3%80%82%E6%A1%86%E6%9E%B6%E4%BC%9A%E6%A0%B9%E6%8D%AE%20root%20%E9%85%8D%E7%BD%AE%E7%9A%84%E7%9B%AE%E5%BD%95%E4%BE%9D%E6%AC%A1%E6%9F%A5%E6%89%BE%EF%BC%8C%E5%A6%82%E6%9E%9C%E5%8C%B9%E9%85%8D%E5%88%99%E4%BC%9A%E7%BC%93%E5%AD%98%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84%EF%BC%8C%E4%B8%8B%E6%AC%A1%E6%B8%B2%E6%9F%93%E7%9B%B8%E5%90%8C%E8%B7%AF%E5%BE%84%E6%97%B6%E4%B8%8D%E4%BC%9A%E9%87%8D%E6%96%B0%E6%9F%A5%E6%89%BE%E3%80%82%0A%0A%23%23%23%20mapping%20%E5%92%8C%20defaultViewEngine%0A%0A%E6%AF%8F%E4%B8%AA%E6%A8%A1%E6%9D%BF%E5%9C%A8%E6%B3%A8%E5%86%8C%E6%97%B6%E9%83%BD%E4%BC%9A%E6%8C%87%E5%AE%9A%E4%B8%80%E4%B8%AA%E6%A8%A1%E6%9D%BF%E5%90%8D%EF%BC%88viewEngineName%EF%BC%89%EF%BC%8C%E5%9C%A8%E4%BD%BF%E7%94%A8%E6%97%B6%E9%9C%80%E8%A6%81%E6%A0%B9%E6%8D%AE%E5%90%8E%E7%BC%80%E6%9D%A5%E5%8C%B9%E9%85%8D%E6%A8%A1%E6%9D%BF%E5%90%8D%EF%BC%8C%E6%AF%94%E5%A6%82%E6%8C%87%E5%AE%9A%20%60.nj%60%20%E5%90%8E%E7%BC%80%E7%9A%84%E6%96%87%E4%BB%B6%E4%BD%BF%E7%94%A8%20Nunjucks%20%E8%BF%9B%E8%A1%8C%E6%B8%B2%E6%9F%93%E3%80%82%0A%0A%60%60%60js%0Amodule.exports%20%3D%20%7B%0A%20%20view%3A%20%7B%0A%20%20%20%20mapping%3A%20%7B%0A%20%20%20%20%20%20'.nj'%3A%20'nunjucks'%2C%0A%20%20%20%20%7D%2C%0A%20%20%7D%2C%0A%7D%3B%0A%60%60%60%0A%0A%E8%B0%83%E7%94%A8%20render%20%E6%B8%B2%E6%9F%93%E6%96%87%E4%BB%B6%E6%97%B6%EF%BC%8C%E4%BC%9A%E6%A0%B9%E6%8D%AE%E4%B8%8A%E8%BF%B0%E9%85%8D%E7%BD%AE%E7%9A%84%E5%90%8E%E7%BC%80%E5%90%8D%E5%8E%BB%E5%AF%BB%E6%89%BE%E5%AF%B9%E5%BA%94%E7%9A%84%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E%E3%80%82%0A%0A%60%60%60js%0Aawait%20ctx.render('home.nj')%3B%0A%60%60%60%0A%0A%E5%BF%85%E9%A1%BB%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%90%8E%E7%BC%80%E5%92%8C%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E%E7%9A%84%E6%98%A0%E5%B0%84%EF%BC%8C%E5%90%A6%E5%88%99%E6%97%A0%E6%B3%95%E6%89%BE%E5%88%B0%E5%AF%B9%E5%BA%94%E7%9A%84%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E%EF%BC%8C%E4%BD%86%E6%98%AF%E5%8F%AF%E4%BB%A5%E4%BD%BF%E7%94%A8%20%60defaultViewEngine%60%20%E5%81%9A%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE%E3%80%82%0A%0A%60%60%60js%0A%2F%2F%20config%2Fconfig.default.js%0Amodule.exports%20%3D%20%7B%0A%20%20view%3A%20%7B%0A%20%20%20%20defaultViewEngine%3A%20'nunjucks'%2C%0A%20%20%7D%2C%0A%7D%3B%0A%60%60%60%0A%0A%E5%A6%82%E6%9E%9C%E6%A0%B9%E6%8D%AE%E6%96%87%E4%BB%B6%E5%90%8E%E7%BC%80%E6%B2%A1%E6%9C%89%E6%89%BE%E5%88%B0%E5%AF%B9%E5%BA%94%E7%9A%84%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E%EF%BC%8C%E4%BC%9A%E4%BD%BF%E7%94%A8%E9%BB%98%E8%AE%A4%E7%9A%84%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E%E8%BF%9B%E8%A1%8C%E6%B8%B2%E6%9F%93%E3%80%82%E5%AF%B9%E4%BA%8E%E5%8F%AA%E4%BD%BF%E7%94%A8%E4%B8%80%E7%A7%8D%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E%E7%9A%84%E5%BA%94%E7%94%A8%EF%BC%8C%E5%BB%BA%E8%AE%AE%E9%85%8D%E7%BD%AE%E6%AD%A4%E9%80%89%E9%A1%B9%E3%80%82%0A%0A%23%23%23%20defaultExtension%0A%0A%E4%B8%80%E8%88%AC%E5%9C%A8%E8%B0%83%E7%94%A8%20render%20%E6%97%B6%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%8F%82%E6%95%B0%E9%9C%80%E8%A6%81%E5%8C%85%E5%90%AB%E6%96%87%E4%BB%B6%E5%90%8E%E7%BC%80%EF%BC%8C%E5%A6%82%E6%9E%9C%E9%85%8D%E7%BD%AE%E4%BA%86%20defaultExtension%20%E5%8F%AF%E4%BB%A5%E7%9C%81%E7%95%A5%E5%90%8E%E7%BC%80%E3%80%82%0A%0A%60%60%60js%0A%2F%2F%20config%2Fconfig.default.js%0Amodule.exports%20%3D%20%7B%0A%20%20view%3A%20%7B%0A%20%20%20%20defaultExtension%3A%20'.nj'%2C%0A%20%20%7D%2C%0A%7D%3B%0A%0A%2F%2F%20render%20app%2Fview%2Fhome.nj%0Aawait%20ctx.render('home')%3B%0A%60%60%60%0A%0A%23%23%20%E6%B8%B2%E6%9F%93%E9%A1%B5%E9%9D%A2%0A%0A%E6%A1%86%E6%9E%B6%E5%9C%A8%20Context%20%E4%B8%8A%E6%8F%90%E4%BE%9B%E4%BA%86%203%20%E4%B8%AA%E6%8E%A5%E5%8F%A3%EF%BC%8C%E8%BF%94%E5%9B%9E%E5%80%BC%E5%9D%87%E4%B8%BA%20Promise%3A%0A%0A-%20%60render(name%2C%20locals)%60%20%E6%B8%B2%E6%9F%93%E6%A8%A1%E6%9D%BF%E6%96%87%E4%BB%B6%2C%20%E5%B9%B6%E8%B5%8B%E5%80%BC%E7%BB%99%20ctx.body%0A-%20%60renderView(name%2C%20locals)%60%20%E6%B8%B2%E6%9F%93%E6%A8%A1%E6%9D%BF%E6%96%87%E4%BB%B6%2C%20%E4%BB%85%E8%BF%94%E5%9B%9E%E4%B8%8D%E8%B5%8B%E5%80%BC%0A-%20%60renderString(tpl%2C%20locals)%60%20%E6%B8%B2%E6%9F%93%E6%A8%A1%E6%9D%BF%E5%AD%97%E7%AC%A6%E4%B8%B2%2C%20%E4%BB%85%E8%BF%94%E5%9B%9E%E4%B8%8D%E8%B5%8B%E5%80%BC%0A%0A%60%60%60js%0A%2F%2F%20%7Bapp_root%7D%2Fapp%2Fcontroller%2Fhome.js%0Aclass%20HomeController%20extends%20Controller%20%7B%0A%20%20async%20index()%20%7B%0A%20%20%20%20const%20data%20%3D%20%7B%20name%3A%20'egg'%20%7D%3B%0A%0A%20%20%20%20%2F%2F%20render%20a%20template%2C%20path%20relate%20to%20%60app%2Fview%60%0A%20%20%20%20await%20ctx.render('home%2Findex.tpl'%2C%20data)%3B%0A%0A%20%20%20%20%2F%2F%20or%20manually%20set%20render%20result%20to%20ctx.body%0A%20%20%20%20ctx.body%20%3D%20await%20ctx.renderView('path%2Fto%2Ffile.tpl'%2C%20data)%3B%0A%0A%20%20%20%20%2F%2F%20or%20render%20string%20directly%0A%20%20%20%20ctx.body%20%3D%20await%20ctx.renderString('hi%2C%20%7B%7B%20name%20%7D%7D'%2C%20data%2C%20%7B%0A%20%20%20%20%20%20viewEngine%3A%20'nunjucks'%2C%0A%20%20%20%20%7D)%3B%0A%20%20%7D%0A%7D%0A%60%60%60%0A%0A%E5%BD%93%E4%BD%BF%E7%94%A8%20%60renderString%60%20%E6%97%B6%E9%9C%80%E8%A6%81%E6%8C%87%E5%AE%9A%E6%A8%A1%E6%9D%BF%E5%BC%95%E6%93%8E%EF%BC%8C%E5%A6%82%E6%9E%9C%E5%B7%B2%E7%BB%8F%E5%AE%9A%E4%B9%89%20%60defaultViewEngine%60%20%E8%BF%99%E9%87%8C%E5%8F%AF%E4%BB%A5%E7%9C%81%E7%95%A5%E3%80%82%0A%0A%23%23%20Locals%0A%0A%E5%9C%A8%E6%B8%B2%E6%9F%93%E9%A1%B5%E9%9D%A2%E7%9A%84%E8%BF%87%E7%A8%8B%E4%B8%AD%EF%BC%8C%E6%88%91%E4%BB%AC%E9%80%9A%E5%B8%B8%E9%9C%80%E8%A6%81%E4%B8%80%E4%B8%AA%E5%8F%98%E9%87%8F%E6%9D%A5%E6%94%B6%E9%9B%86%E9%9C%80%E8%A6%81%E4%BC%A0%E9%80%92%E7%BB%99%E6%A8%A1%E6%9D%BF%E7%9A%84%E5%8F%98%E9%87%8F%EF%BC%8C%E5%9C%A8%E6%A1%86%E6%9E%B6%E9%87%8C%E9%9D%A2%EF%BC%8C%E6%88%91%E4%BB%AC%E6%8F%90%E4%BE%9B%E4%BA%86%20%60app.locals%60%20%E5%92%8C%20%60ctx.locals%60%E3%80%82%0A%0A-%20%60app.locals%60%20%E4%B8%BA%E5%85%A8%E5%B1%80%E7%9A%84%EF%BC%8C%E4%B8%80%E8%88%AC%E5%9C%A8%20%60app.js%60%20%E9%87%8C%E9%9D%A2%E9%85%8D%E7%BD%AE%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F%E3%80%82%0A-%20%60ctx.locals%60%20%E4%B8%BA%E5%8D%95%E6%AC%A1%E8%AF%B7%E6%B1%82%E7%9A%84%EF%BC%8C%E4%BC%9A%E5%90%88%E5%B9%B6%20%60app.locals%60%E3%80%82%0A-%20%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E8%B5%8B%E5%80%BC%E5%AF%B9%E8%B1%A1%EF%BC%8C%E6%A1%86%E6%9E%B6%E5%9C%A8%E5%AF%B9%E5%BA%94%E7%9A%84%20setter%20%E9%87%8C%E9%9D%A2%E4%BC%9A%E8%87%AA%E5%8A%A8%20merge%E3%80%82%0A%0A%60%60%60js%0A%2F%2F%20%60app.locals%60%20%E4%BC%9A%E5%90%88%E5%B9%B6%E5%88%B0%20%60ctx.locals%0Actx.app.locals%20%3D%20%7B%20a%3A%201%20%7D%3B%0Actx.locals.b%20%3D%202%3B%0Aconsole.log(ctx.locals)%3B%20%2F%2F%20%7B%20a%3A%201%2C%20b%3A%202%20%7D%0A%0A%2F%2F%20%E4%B8%80%E6%AC%A1%E8%AF%B7%E6%B1%82%E8%BF%87%E7%A8%8B%E4%B8%AD%EF%BC%8C%E4%BB%85%E4%BC%9A%E5%9C%A8%E7%AC%AC%E4%B8%80%E6%AC%A1%E4%BD%BF%E7%94%A8%20%60ctx.locals%60%20%E6%97%B6%E6%8A%8A%20%60app.locals%60%20%E5%90%88%E5%B9%B6%E8%BF%9B%E5%8E%BB%E3%80%82%0Actx.app.locals%20%3D%20%7B%20a%3A%202%20%7D%3B%0Aconsole.log(ctx.locals)%3B%20%2F%2F%20%E4%B8%8A%E9%9D%A2%E5%B7%B2%E7%BB%8F%E5%90%88%E5%B9%B6%E8%BF%87%E4%B8%80%E6%AC%A1%EF%BC%8C%E6%95%85%E8%BE%93%E5%87%BA%E8%BF%98%E6%98%AF%20%7B%20a%3A%201%2C%20b%3A%202%20%7D%0A%0A%2F%2F%20%E4%B9%9F%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E8%B5%8B%E5%80%BC%E6%95%B4%E4%B8%AA%E5%AF%B9%E8%B1%A1%EF%BC%8C%E4%B8%8D%E7%94%A8%E6%8B%85%E5%BF%83%E4%BC%9A%E8%A6%86%E7%9B%96%E5%89%8D%E9%9D%A2%E7%9A%84%E5%80%BC%EF%BC%8C%E6%88%91%E4%BB%AC%E9%80%9A%E8%BF%87%20setter%20%E5%81%9A%E4%BA%86%E8%87%AA%E5%8A%A8%E5%90%88%E5%B9%B6%E3%80%82%0Actx.locals.c%20%3D%203%3B%0Actx.locals%20%3D%20%7B%20d%3A%204%20%7D%3B%0Aconsole.log(ctx.locals)%3B%20%2F%2F%20%7B%20a%3A%201%2C%20b%3A%202%2C%20c%3A%203%2C%20d%3A%204%20%7D%0A%60%60%60%0A%0A%E4%BD%86%E5%9C%A8%E5%AE%9E%E9%99%85%E4%B8%9A%E5%8A%A1%E5%BC%80%E5%8F%91%E4%B8%AD%EF%BC%8Ccontroller%20%E4%B8%AD%E4%B8%80%E8%88%AC%E4%B8%8D%E4%BC%9A%E7%9B%B4%E6%8E%A5%E4%BD%BF%E7%94%A8%E8%BF%99%202%20%E4%B8%AA%E5%AF%B9%E8%B1%A1%EF%BC%8C%E7%9B%B4%E6%8E%A5%E4%BD%BF%E7%94%A8%20%60ctx.render(name%2C%20data)%60%20%E5%8D%B3%E5%8F%AF%EF%BC%9A%0A-%20%E6%A1%86%E6%9E%B6%E4%BC%9A%E8%87%AA%E5%8A%A8%E6%8A%8A%20%60data%60%20%E5%90%88%E5%B9%B6%E5%88%B0%20%60ctx.locals%60%E3%80%82%0A-%20%E6%A1%86%E6%9E%B6%E4%BC%9A%E8%87%AA%E5%8A%A8%E6%B3%A8%E5%85%A5%20%60ctx%60%2C%20%60request%60%2C%20%60helper%60%20%E6%96%B9%E4%BE%BF%E4%BD%BF%E7%94%A8%E3%80%82%0A%0A%60%60%60js%0Actx.app.locals%20%3D%20%7B%20appName%3A%20'showcase'%20%7D%3B%0Aconst%20data%20%3D%20%7B%20name%3A%20'egg'%20%7D%3B%0A%0A%2F%2F%20will%20auto%20merge%20%60data%60%20to%20%60ctx.locals%60%2C%20output%3A%20egg%20-%20showcase%0Aawait%20ctx.renderString('%7B%7B%20name%20%7D%7D%20-%20%7B%7B%20appName%20%7D%7D'%2C%20data)%3B%0A%0A%2F%2F%20helper%2C%20ctx%2C%20request%20will%20auto%20inject%0Aawait%20ctx.renderString('%7B%7B%20name%20%7D%7D%20-%20%7B%7B%20helper.lowercaseFirst(ctx.app.config.baseDir)%20%7D%7D'%2C%20data)%3B%0A%60%60%60%0A%0A%E6%B3%A8%E6%84%8F%EF%BC%9A%0A-%20**ctx.locals%20%E6%9C%89%E7%BC%93%E5%AD%98%EF%BC%8C%E5%8F%AA%E5%9C%A8%E7%AC%AC%E4%B8%80%E6%AC%A1%E8%AE%BF%E9%97%AE%20ctx.locals%20%E6%97%B6%E5%90%88%E5%B9%B6%20app.locals%E3%80%82**%0A-%20%E5%8E%9F%20Koa%20%E4%B8%AD%E7%9A%84%20%60ctx.state%60%EF%BC%8C%E7%94%B1%E4%BA%8E%E5%AE%B9%E6%98%93%E4%BA%A7%E7%94%9F%E6%AD%A7%E4%B9%89%EF%BC%8C%E5%9C%A8%E6%A1%86%E6%9E%B6%E4%B8%AD%E8%A2%AB%E8%A6%86%E7%9B%96%E4%B8%BA%20locals%EF%BC%8C%E5%8D%B3%20%60ctx.state%60%20%E5%92%8C%20%60ctx.locals%60%20%E7%AD%89%E4%BB%B7%EF%BC%8C%E6%88%91%E4%BB%AC%E5%BB%BA%E8%AE%AE%E4%BD%BF%E7%94%A8%E5%90%8E%E8%80%85%E3%80%82%0A%0A%23%23%20Helper%0A%0A%E5%9C%A8%E6%A8%A1%E6%9D%BF%E4%B8%AD%E5%8F%AF%E4%BB%A5%E7%9B%B4%E6%8E%A5%E4%BD%BF%E7%94%A8%20%60helper%60%20%E4%B8%8A%E6%B3%A8%E5%86%8C%E7%9A%84%E6%96%B9%E6%B3%95%EF%BC%8C%E5%85%B7%E4%BD%93%E5%8F%AF%E4%BB%A5%E5%8F%82%E8%A7%81%5B%E6%89%A9%E5%B1%95%5D(..%2Fbasics%2Fextend.md)%E3%80%82%0A%0A%60%60%60js%0A%2F%2F%20app%2Fextend%2Fhelper.js%0Aexports.lowercaseFirst%20%3D%20str%20%3D%3E%20str%5B0%5D.toLowerCase()%20%2B%20str.substring(1)%3B%0A%0A%2F%2F%20app%2Fcontroller%2Fhome.js%0Aawait%20ctx.renderString('%7B%7B%20helper.lowercaseFirst(name)%20%7D%7D'%2C%20data)%3B%0A%60%60%60%0A%0A%23%23%20Security%0A%0A%E6%A1%86%E6%9E%B6%E5%86%85%E7%BD%AE%E7%9A%84%20%5Begg-security%5D%20%E6%8F%92%E4%BB%B6%EF%BC%8C%E4%B8%BA%E6%88%91%E4%BB%AC%E6%8F%90%E4%BE%9B%E4%BA%86%E5%B8%B8%E8%A7%81%E7%9A%84%E5%AE%89%E5%85%A8%E8%BE%85%E5%8A%A9%E5%87%BD%E6%95%B0%EF%BC%8C%E5%8C%85%E6%8B%AC%20%60helper.shtml%20%2F%20surl%20%2F%20sjs%60%20%E7%AD%89%E7%AD%89%E7%AD%89%EF%BC%8C%E5%BC%BA%E7%83%88%E5%BB%BA%E8%AE%AE%E9%98%85%E8%AF%BB%E4%B8%8B%5B%E5%AE%89%E5%85%A8%5D(.%2Fsecurity.md)%E3%80%82%0A%0A%0A%5Begg-security%5D%3A%20https%3A%2F%2Fgithub.com%2Feggjs%2Fegg-security%0A%5Begg-view-nunjucks%5D%3A%20https%3A%2F%2Fgithub.com%2Feggjs%2Fegg-view-nunjucks%0A%5Begg-view%5D%3A%20https%3A%2F%2Fgithub.com%2Feggjs%2Fegg-view%0A"}}</script><script type="text/javascript" src="/static/js/post.b9faab88.js"></script></body></html>