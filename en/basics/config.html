<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="theme-color" content="#000000"><link rel="manifest" href="/manifest.json"><link rel="shortcut icon" href="/favicon.png"><style class="_styletron_hydrate_"></style><title>Configuration</title><meta name="description" content="Born to build better enterprise frameworks and apps"><link href="/static/css/post.d62265dc.css" rel="stylesheet"></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><div class="ant-layout" data-reactroot=""><div class="header-module__header___3ADJ9 ant-layout-header"><div class="ant-row-flex"><div class="ant-col-xs-12 ant-col-md-20 ant-col-lg-2"><div class="header-module__logo___3yTXp"><a href="/"><img src="/logo.svg" alt="logo"/></a></div></div><div class="ant-col-xs-0 ant-col-md-0 ant-col-lg-20"><ul class="ant-menu header-module__menu___3yEtW ant-menu-light ant-menu-root ant-menu-horizontal" role="menu"><li class="ant-menu-item" role="menuitem"><a href="/en/intro/">Guide</a></li><li class="ant-menu-item" role="menuitem"><a href="/api/">API</a></li><li class="ant-menu-item" role="menuitem"><a href="/en/tutorials/index.html">Tutorials</a></li><li class="ant-menu-item" role="menuitem"><a href="https://github.com/search?q=topic%3Aegg-plugin&amp;type=Repositories">Plugins</a></li><li class="ant-menu-item" role="menuitem"><a href="https://github.com/eggjs/egg/releases">Release</a></li></ul></div><div style="text-align:right" class="ant-col-xs-12 ant-col-md-4 ant-col-lg-2"><button type="button" class="ant-btn"><span>切换语言</span></button></div></div></div><div class="ant-layout-content"><div class="basic_layout-module__content___3flpY ant-layout"><div class="sider-module__side___1Cadj ant-layout-sider ant-layout-sider-light" style="flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"><ul class="ant-menu sider-module__menu___2GqPr ant-menu-light ant-menu-root ant-menu-inline" role="menu"><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="0$Menu" aria-haspopup="true"><span>Guide</span><i class="ant-menu-submenu-arrow"></i></div><ul id="0$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/intro/index.html">What is Egg?</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/intro/egg-and-koa.html">Egg and Koa</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/intro/quickstart.html">Quick Start</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/progressive.html">Progressive</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/migration.html">Migration to 2.x</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="1$Menu" aria-haspopup="true"><span>Basis Function</span><i class="ant-menu-submenu-arrow"></i></div><ul id="1$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/structure.html">Directory Structure</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/objects.html">Built-in Objects</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/env.html">Environment</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/config.html">Configuration</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/middleware.html">Middleware</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/router.html">Router</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/controller.html">Controller</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/service.html">Service</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/plugin.html">Plugin</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/schedule.html">Schedule</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/extend.html">Extend</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/app-start.html">Custom Init</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="2$Menu" aria-haspopup="true"><span>Core</span><i class="ant-menu-submenu-arrow"></i></div><ul id="2$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/development.html">Development</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/unittest.html">Unit Testing</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/deployment.html">Deployment</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/logger.html">Logger</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/httpclient.html">HttpClient</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/cookie-and-session.html">Cookie and Session</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/cluster-and-ipc.html">Cluster and IPC</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/view.html">View</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/error-handling.html">Error Handling</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/security.html">Security</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/i18n.html">i18n</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="3$Menu" aria-haspopup="true"><span>Tutorials</span><i class="ant-menu-submenu-arrow"></i></div><ul id="3$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/mysql.html">MySQL</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/restful.html">RESTful API</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/passport.html">Passport</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/socketio.html">Socket.IO</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/assets.html">Assets</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/typescript.html">TypeScript</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="4$Menu" aria-haspopup="true"><span>Advanced</span><i class="ant-menu-submenu-arrow"></i></div><ul id="4$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/advanced/loader.html">Loader</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/advanced/plugin.html">Plugin Development</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/advanced/framework.html">Framework</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/advanced/cluster-client.html">Cluster Enhancement</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/advanced/view-plugin.html">View Plugin</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/style-guide.html">Style Guide</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="5$Menu" aria-haspopup="true"><span>Community</span><i class="ant-menu-submenu-arrow"></i></div><ul id="5$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/plugins/">Plugin List</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/contributing.html">Contributing</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/resource.html">Resource</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/faq.html">FAQ</a></li></ul></li></ul></div></div><div class="basic_layout-module__post___2Z7KK ant-layout-content"><div class="ant-row" style="margin-left:-8px;margin-right:-8px"><div style="padding-left:8px;padding-right:8px" class="ant-col-xs-24 ant-col-md-18"><div class="markdown-body" style="font-size:14px"><div><p>This framework provides powerful and extensible configuration function, including automatically merging applications, plugins, and framework&#x27;s configuration. In addition, it allows users to overwrite configuration in sequence and maintain different configs depending on different environments. The result (i.e. merged config) can be accessed from <code>app.config</code>.</p><p>Here are some common control tactics:</p><ol><li>Using platform to manage configurations: while building a new application, you can put the current environment configuration into package and trigger the configuration as long as you run this application. But this certain application won&#x27;t be able to build several deployments at once, and you will get into trouble whenever you want to use the configuration in localhost.</li><li>Using platform to manage configurations: you can pass the current environment configuration via environment variables while starting. This is a relatively elegant approach with higher requirement on operation and support from configuration platform. Moreover, The configuration environment has same flaws as first method.</li><li>Using code to manage configurations: you can add some environment configurations in codes and pass them  to current environment arguments while starting. However, it doesn&#x27;t allow you to configure globally and you need to alter your code whenever you want to change the configuration.</li></ol><p>we choose the last strategy, namely <strong>configure with code</strong>, The change of configuration should be also released after reviewing. The application package itself is capable to be deployed in several environments, only need to specify the running environment.</p><h3 id="multiple-environment-configuration">Multiple environment configuration</h3><p>This framework supports loading configuration according to the environment and defining configuration files of multiple environments. For more details, please check <a href="../basics/env.md">env</a>.</p><pre><code>config
|- config.default.js
|- config.prod.js
|- config.unittest.js
|- config.local.js</code></pre><p><code>config.default.js</code> is the default file for configuration, and all environments will load this file. Besides, this is usually used as default configuration file for development environment.</p><p>The corresponding configuration file will be loaded simultaneously when you set up env and the default configuration with the same name will be overwritten. For example, <code>prod</code> environment will load <code>config.prod.js</code> and <code>config.default.js</code>. As a result, <code>config.prod.js</code> will overwrite the configuration with identical name in <code>config.default.js</code>.</p><h3 id="how-to-write-configuration">How to write configuration</h3><p>The configuration file returns an object which could overwrite some configurations in the framework. Application can put its own business configuration into it for convenient management.</p><pre><code class="language-js">// configure the catalog of logger，the default configuration of logger is provided by framework
module.exports = {
  logger: {
    dir: &#x27;/home/admin/logs/demoapp&#x27;,
  },
};</code></pre><p>The configuration file can simplify to <code>exports.key = value</code> format</p><pre><code class="language-js">exports.keys = &#x27;my-cookie-secret-key&#x27;;
exports.logger = {
  level: &#x27;DEBUG&#x27;,
};</code></pre><p>The configuration file can also return a function which could receive a parameter called <code>appInfo</code></p><pre><code class="language-js">// put the catalog of logger to the catalog of codes
const path = require(&#x27;path&#x27;);
module.exports = appInfo =&gt; {
  return {
    logger: {
      dir: path.join(appInfo.baseDir, &#x27;logs&#x27;),
    },
  };
};</code></pre><p>The build-in appInfo contains:</p><table><thead><tr><th>appInfo</th><th>elaboration</th></tr></thead><tbody><tr><td>pkg</td><td>package.json</td></tr><tr><td>name</td><td>Application name, same as pkg.name</td></tr><tr><td>baseDir</td><td>The directory of codes</td></tr><tr><td>HOME</td><td>User directory, e.g, the account of admin is /home/admin</td></tr><tr><td>root</td><td>The application root directory, if the environment is local or unittest, it is baseDir. Otherwise, it is HOME</td></tr></tbody></table><p><code>appInfo.root</code> is an elegant adaption. for example, we tend to use <code>/home/admin/logs</code> as the catalog of log in the server environment, while we don&#x27;t want to pollute the user catalog in local development. This adaptation is very good at solving this problem.</p><p>Choose the appropriate style according to the specific situation, but please make sure you don&#x27;t make mistake like the code below:</p><pre><code class="language-js">// config/config.default.js
exports.someKeys = &#x27;abc&#x27;;
module.exports = appInfo =&gt; {
  const config = {};
  config.keys = &#x27;123456&#x27;;
  return config;
};</code></pre><h3 id="sequence-of-loading-configurations">Sequence of loading configurations</h3><p>Applications, plugin components and framework are able to define those configs. Even though the structure of catalog is identical but there is priority (application &gt; framework &gt; plugin). Besides, the running environment has the higher priority.</p><p>Here is one sequence of loading configurations under &quot;prod&quot; environment, in which the following configuration will overwrite the previous configuration with the same name.</p><pre><code>-&gt; plugin config.default.js
-&gt; framework config.default.js
-&gt; application config.default.js
-&gt; plugin config.prod.js
-&gt; framework config.prod.js
-&gt; application config.prod.js</code></pre><p><strong>Note: there will be plugin loading sequence, but the approximate order is similar. For specific logic, please check the <a href="../advanced/loader.md">loader</a> .</strong></p><h3 id="merging-rule">Merging rule</h3><p>Configs are merged using deep copy from <a href="">extend2</a> module, which is forked from <a href="">extend</a> and process array in a different way.</p><pre><code class="language-js">const a = {
  arr: [ 1, 2 ],
};
const b = {
  arr: [ 3 ],
};
extend(true, a, b);
// =&gt; { arr: [ 3 ] }</code></pre><p>As demonstrated above, the framework will overwrite arrays instead of merging them.</p><h2 id="configuration-result">Configuration result</h2><p>The final merged config will be dumped to <code>run/application_config.json</code>(for worker process) and <code>run/agent_config.json</code>(for agent process) when the framework started, which can help analyzing problems.</p><p>Some fields are hidden in the config file, mainly including 2 types:</p><ul><li>like passwords, secret keys and other security related fields which can be configured in <code>config.dump.ignore</code> and only <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Set">Set</a> type is accepted. See <a href="https://github.com/eggjs/egg/blob/master/config/config.default.js">Default Configs</a></li><li>like Function, Buffer, etc. whose content converted by <code>JSON.stringify</code> will be specially large.</li></ul><p><code>run/application_config_meta.json</code> (for worker process）and <code>run/agent_config_meta.json</code> (for agent process) will also be dumped in order to check which file defines the property, see below</p><pre><code class="language-json">{
  &quot;logger&quot;: {
    &quot;dir&quot;: &quot;/path/to/config/config.default.js&quot;
  }
}</code></pre></div></div></div><div style="padding-left:8px;padding-right:8px" class="ant-col-xs-0 ant-col-md-6"><div class="markdown-body" style="font-size:14px"><div><ul><li><a href="#multiple-environment-configuration">Multiple environment configuration</a></li><li><a href="#how-to-write-configuration">How to write configuration</a></li><li><a href="#sequence-of-loading-configurations">Sequence of loading configurations</a></li><li><a href="#merging-rule">Merging rule</a></li></ul><ul><li><a href="#configuration-result">Configuration result</a></li></ul></div></div></div></div></div></div></div></div></div><script type="text/javascript">window.__INIT_STATE__={"lang":"en","props":{"toc":"%20%20*%20%5BMultiple%20environment%20configuration%5D(%23multiple-environment-configuration)%0A%20%20*%20%5BHow%20to%20write%20configuration%5D(%23how-to-write-configuration)%0A%20%20*%20%5BSequence%20of%20loading%20configurations%5D(%23sequence-of-loading-configurations)%0A%20%20*%20%5BMerging%20rule%5D(%23merging-rule)%0A-%20%5BConfiguration%20result%5D(%23configuration-result)","meta":{"info":{"title":"Configuration"}},"content":"%0A%0AThis%20framework%20provides%20powerful%20and%20extensible%20configuration%20function%2C%20including%20automatically%20merging%20applications%2C%20plugins%2C%20and%20framework's%20configuration.%20In%20addition%2C%20it%20allows%20users%20to%20overwrite%20configuration%20in%20sequence%20and%20maintain%20different%20configs%20depending%20on%20different%20environments.%20The%20result%20(i.e.%20merged%20config)%20can%20be%20accessed%20from%20%60app.config%20%60.%0A%0AHere%20are%20some%20common%20control%20tactics%3A%0A%0A1.%20Using%20platform%20to%20manage%20configurations%3A%20while%20building%20a%20new%20application%2C%20you%20can%20put%20the%20current%20environment%20configuration%20into%20package%20and%20trigger%20the%20configuration%20as%20long%20as%20you%20run%20this%20application.%20But%20this%20certain%20application%20won't%20be%20able%20to%20build%20several%20deployments%20at%20once%2C%20and%20you%20will%20get%20into%20trouble%20whenever%20you%20want%20to%20use%20the%20configuration%20in%20localhost.%0A2.%20Using%20platform%20to%20manage%20configurations%3A%20you%20can%20pass%20the%20current%20environment%20configuration%20via%20environment%20variables%20while%20starting.%20This%20is%20a%20relatively%20elegant%20approach%20with%20higher%20requirement%20on%20operation%20and%20support%20from%20configuration%20platform.%20Moreover%2C%20The%20configuration%20environment%20has%20same%20flaws%20as%20first%20method.%0A3.%20Using%20code%20to%20manage%20configurations%3A%20you%20can%20add%20some%20environment%20configurations%20in%20codes%20and%20pass%20them%20%20to%20current%20environment%20arguments%20while%20starting.%20However%2C%20it%20doesn't%20allow%20you%20to%20configure%20globally%20and%20you%20need%20to%20alter%20your%20code%20whenever%20you%20want%20to%20change%20the%20configuration.%0A%0Awe%20choose%20the%20last%20strategy%2C%20namely%20**configure%20with%20code**%2C%20The%20change%20of%20configuration%20should%20be%20also%20released%20after%20reviewing.%20The%20application%20package%20itself%20is%20capable%20to%20be%20deployed%20in%20several%20environments%2C%20only%20need%20to%20specify%20the%20running%20environment.%0A%0A%23%23%23%20Multiple%20environment%20configuration%0A%0AThis%20framework%20supports%20loading%20configuration%20according%20to%20the%20environment%20and%20defining%20configuration%20files%20of%20multiple%20environments.%20For%20more%20details%2C%20please%20check%20%5Benv%5D(..%2Fbasics%2Fenv.md).%0A%0A%60%60%60%0Aconfig%0A%7C-%20config.default.js%0A%7C-%20config.prod.js%0A%7C-%20config.unittest.js%0A%7C-%20config.local.js%0A%60%60%60%0A%60config.default.js%60%20is%20the%20default%20file%20for%20configuration%2C%20and%20all%20environments%20will%20load%20this%20file.%20Besides%2C%20this%20is%20usually%20used%20as%20default%20configuration%20file%20for%20development%20environment.%0A%0AThe%20corresponding%20configuration%20file%20will%20be%20loaded%20simultaneously%20when%20you%20set%20up%20env%20and%20the%20default%20configuration%20with%20the%20same%20name%20will%20be%20overwritten.%20For%20example%2C%20%60prod%60%20environment%20will%20load%20%60config.prod.js%60%20and%20%60config.default.js%60.%20As%20a%20result%2C%20%60config.prod.js%60%20will%20overwrite%20the%20configuration%20with%20identical%20name%20in%20%60config.default.js%60.%0A%0A%23%23%23%20How%20to%20write%20configuration%0A%0AThe%20configuration%20file%20returns%20an%20object%20which%20could%20overwrite%20some%20configurations%20in%20the%20framework.%20Application%20can%20put%20its%20own%20business%20configuration%20into%20it%20for%20convenient%20management.%0A%0A%60%60%60js%0A%2F%2F%20configure%20the%20catalog%20of%20logger%EF%BC%8Cthe%20default%20configuration%20of%20logger%20is%20provided%20by%20framework%0Amodule.exports%20%3D%20%7B%0A%20%20logger%3A%20%7B%0A%20%20%20%20dir%3A%20'%2Fhome%2Fadmin%2Flogs%2Fdemoapp'%2C%0A%20%20%7D%2C%0A%7D%3B%0A%60%60%60%0A%0AThe%20configuration%20file%20can%20simplify%20to%20%60exports.key%20%3D%20value%60%20format%0A%0A%60%60%60js%0Aexports.keys%20%3D%20'my-cookie-secret-key'%3B%0Aexports.logger%20%3D%20%7B%0A%20%20level%3A%20'DEBUG'%2C%0A%7D%3B%0A%60%60%60%0A%0AThe%20configuration%20file%20can%20also%20return%20a%20function%20which%20could%20receive%20a%20parameter%20called%20%60appInfo%60%0A%0A%60%60%60js%0A%2F%2F%20put%20the%20catalog%20of%20logger%20to%20the%20catalog%20of%20codes%0Aconst%20path%20%3D%20require('path')%3B%0Amodule.exports%20%3D%20appInfo%20%3D%3E%20%7B%0A%20%20return%20%7B%0A%20%20%20%20logger%3A%20%7B%0A%20%20%20%20%20%20dir%3A%20path.join(appInfo.baseDir%2C%20'logs')%2C%0A%20%20%20%20%7D%2C%0A%20%20%7D%3B%0A%7D%3B%0A%60%60%60%0AThe%20build-in%20appInfo%20contains%3A%0A%0AappInfo%20%7C%20elaboration%0A---%20%20%20%20%20%20%7C%20---%0Apkg%20%20%20%20%20%20%7C%20package.json%0Aname%20%20%20%20%20%7C%20Application%20name%2C%20same%20as%20pkg.name%0AbaseDir%20%20%20%7C%20The%20directory%20of%20codes%0AHOME%20%20%20%20%20%20%20%7C%20User%20directory%2C%20e.g%2C%20the%20account%20of%20admin%20is%20%2Fhome%2Fadmin%0Aroot%20%20%20%20%20%20%20%7C%20The%20application%20root%20directory%2C%20if%20the%20environment%20is%20local%20or%20unittest%2C%20it%20is%20baseDir.%20Otherwise%2C%20it%20is%20HOME%0A%0A%60appInfo.root%60%20is%20an%20elegant%20adaption.%20for%20example%2C%20we%20tend%20to%20use%20%60%60%2Fhome%2Fadmin%2Flogs%60%60%20as%20the%20catalog%20of%20log%20in%20the%20server%20environment%2C%20while%20we%20don't%20want%20to%20pollute%20the%20user%20catalog%20in%20local%20development.%20This%20adaptation%20is%20very%20good%20at%20solving%20this%20problem.%0A%0AChoose%20the%20appropriate%20style%20according%20to%20the%20specific%20situation%2C%20but%20please%20make%20sure%20you%20don't%20make%20mistake%20like%20the%20code%20below%3A%0A%0A%60%60%60js%0A%2F%2F%20config%2Fconfig.default.js%0Aexports.someKeys%20%3D%20'abc'%3B%0Amodule.exports%20%3D%20appInfo%20%3D%3E%20%7B%0A%20%20const%20config%20%3D%20%7B%7D%3B%0A%20%20config.keys%20%3D%20'123456'%3B%0A%20%20return%20config%3B%0A%7D%3B%0A%60%60%60%0A%0A%23%23%23%20Sequence%20of%20loading%20configurations%0A%0AApplications%2C%20plugin%20components%20and%20framework%20are%20able%20to%20define%20those%20configs.%20Even%20though%20the%20structure%20of%20catalog%20is%20identical%20but%20there%20is%20priority%20(application%20%3E%20framework%20%3E%20plugin).%20Besides%2C%20the%20running%20environment%20has%20the%20higher%20priority.%0A%0AHere%20is%20one%20sequence%20of%20loading%20configurations%20under%20%22prod%22%20environment%2C%20in%20which%20the%20following%20configuration%20will%20overwrite%20the%20previous%20configuration%20with%20the%20same%20name.%0A%0A%09-%3E%20plugin%20config.default.js%0A%09-%3E%20framework%20config.default.js%0A%09-%3E%20application%20config.default.js%0A%09-%3E%20plugin%20config.prod.js%0A%09-%3E%20framework%20config.prod.js%0A%09-%3E%20application%20config.prod.js%0A%0A**Note%3A%20there%20will%20be%20plugin%20loading%20sequence%2C%20but%20the%20approximate%20order%20is%20similar.%20For%20specific%20logic%2C%20please%20check%20the%20%5Bloader%5D(..%2Fadvanced%2Floader.md)%20.**%0A%0A%23%23%23%20Merging%20rule%0A%0AConfigs%20are%20merged%20using%20deep%20copy%20from%20%5Bextend2%5D%20module%2C%20which%20is%20forked%20from%20%5Bextend%5D%20and%20process%20array%20in%20a%20different%20way.%0A%0A%60%60%60js%0Aconst%20a%20%3D%20%7B%0A%20%20arr%3A%20%5B%201%2C%202%20%5D%2C%0A%7D%3B%0Aconst%20b%20%3D%20%7B%0A%20%20arr%3A%20%5B%203%20%5D%2C%0A%7D%3B%0Aextend(true%2C%20a%2C%20b)%3B%0A%2F%2F%20%3D%3E%20%7B%20arr%3A%20%5B%203%20%5D%20%7D%0A%60%60%60%0AAs%20demonstrated%20above%2C%20the%20framework%20will%20overwrite%20arrays%20instead%20of%20merging%20them.%0A%0A%23%23%20Configuration%20result%0A%0AThe%20final%20merged%20config%20will%20be%20dumped%20to%20%60run%2Fapplication_config.json%60(for%20worker%20process)%20and%20%60run%2Fagent_config.json%60(for%20agent%20process)%20when%20the%20framework%20started%2C%20which%20can%20help%20analyzing%20problems.%0A%0ASome%20fields%20are%20hidden%20in%20the%20config%20file%2C%20mainly%20including%202%20types%3A%0A%0A-%20like%20passwords%2C%20secret%20keys%20and%20other%20security%20related%20fields%20which%20can%20be%20configured%20in%20%60config.dump.ignore%60%20and%20only%20%5BSet%5D(https%3A%2F%2Fdeveloper.mozilla.org%2Fen-US%2Fdocs%2FWeb%2FJavaScript%2FReference%2FGlobal_Objects%2FSet)%20type%20is%20accepted.%20See%20%5BDefault%20Configs%5D(https%3A%2F%2Fgithub.com%2Feggjs%2Fegg%2Fblob%2Fmaster%2Fconfig%2Fconfig.default.js)%0A-%20like%20Function%2C%20Buffer%2C%20etc.%20whose%20content%20converted%20by%20%60JSON.stringify%60%20will%20be%20specially%20large.%0A%0A%60run%2Fapplication_config_meta.json%60%20(for%20worker%20process%EF%BC%89and%20%60run%2Fagent_config_meta.json%60%20(for%20agent%20process)%20will%20also%20be%20dumped%20in%20order%20to%20check%20which%20file%20defines%20the%20property%2C%20see%20below%0A%0A%60%60%60json%0A%7B%0A%20%20%22logger%22%3A%20%7B%0A%20%20%20%20%22dir%22%3A%20%22%2Fpath%2Fto%2Fconfig%2Fconfig.default.js%22%0A%20%20%7D%0A%7D%0A%60%60%60%0A"}}</script><script type="text/javascript" src="/static/js/post.b9faab88.js"></script></body></html>