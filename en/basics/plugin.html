<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="theme-color" content="#000000"><link rel="manifest" href="/manifest.json"><link rel="shortcut icon" href="/favicon.png"><style class="_styletron_hydrate_"></style><title>Egg.js</title><meta name="description" content="Born to build better enterprise frameworks and apps"><link href="/static/css/post.d62265dc.css" rel="stylesheet"></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><div class="ant-layout" data-reactroot=""><div class="header-module__header___3ADJ9 ant-layout-header"><div class="ant-row-flex"><div class="ant-col-xs-12 ant-col-md-20 ant-col-lg-2"><div class="header-module__logo___3yTXp"><a href="/"><img src="/logo.svg" alt="logo"/></a></div></div><div class="ant-col-xs-0 ant-col-md-0 ant-col-lg-20"><ul class="ant-menu header-module__menu___3yEtW ant-menu-light ant-menu-root ant-menu-horizontal" role="menu"><li class="ant-menu-item" role="menuitem"><a href="/en/intro/">Guide</a></li><li class="ant-menu-item" role="menuitem"><a href="/api/">API</a></li><li class="ant-menu-item" role="menuitem"><a href="/en/tutorials/index.html">Tutorials</a></li><li class="ant-menu-item" role="menuitem"><a href="https://github.com/search?q=topic%3Aegg-plugin&amp;type=Repositories">Plugins</a></li><li class="ant-menu-item" role="menuitem"><a href="https://github.com/eggjs/egg/releases">Release</a></li></ul></div><div style="text-align:right" class="ant-col-xs-12 ant-col-md-4 ant-col-lg-2"><button type="button" class="ant-btn"><span>切换语言</span></button></div></div></div><div class="ant-layout-content"><div class="basic_layout-module__content___3flpY ant-layout"><div class="sider-module__side___1Cadj ant-layout-sider ant-layout-sider-light" style="flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"><ul class="ant-menu sider-module__menu___2GqPr ant-menu-light ant-menu-root ant-menu-inline" role="menu"><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="0$Menu" aria-haspopup="true"><span>Guide</span><i class="ant-menu-submenu-arrow"></i></div><ul id="0$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/intro/index.html">What is Egg?</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/intro/egg-and-koa.html">Egg and Koa</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/intro/quickstart.html">Quick Start</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/progressive.html">Progressive</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/migration.html">Migration to 2.x</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="1$Menu" aria-haspopup="true"><span>Basis Function</span><i class="ant-menu-submenu-arrow"></i></div><ul id="1$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/structure.html">Directory Structure</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/objects.html">Built-in Objects</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/env.html">Environment</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/config.html">Configuration</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/middleware.html">Middleware</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/router.html">Router</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/controller.html">Controller</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/service.html">Service</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/plugin.html">Plugin</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/schedule.html">Schedule</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/extend.html">Extend</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/app-start.html">Custom Init</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="2$Menu" aria-haspopup="true"><span>Core</span><i class="ant-menu-submenu-arrow"></i></div><ul id="2$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/development.html">Development</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/unittest.html">Unit Testing</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/deployment.html">Deployment</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/logger.html">Logger</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/httpclient.html">HttpClient</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/cookie-and-session.html">Cookie and Session</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/cluster-and-ipc.html">Cluster and IPC</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/view.html">View</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/error-handling.html">Error Handling</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/security.html">Security</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/i18n.html">i18n</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="3$Menu" aria-haspopup="true"><span>Tutorials</span><i class="ant-menu-submenu-arrow"></i></div><ul id="3$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/mysql.html">MySQL</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/restful.html">RESTful API</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/passport.html">Passport</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/socketio.html">Socket.IO</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/assets.html">Assets</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/typescript.html">TypeScript</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="4$Menu" aria-haspopup="true"><span>Advanced</span><i class="ant-menu-submenu-arrow"></i></div><ul id="4$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/advanced/loader.html">Loader</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/advanced/plugin.html">Plugin Development</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/advanced/framework.html">Framework</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/advanced/cluster-client.html">Cluster Enhancement</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/advanced/view-plugin.html">View Plugin</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/style-guide.html">Style Guide</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="5$Menu" aria-haspopup="true"><span>Community</span><i class="ant-menu-submenu-arrow"></i></div><ul id="5$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/plugins/">Plugin List</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/contributing.html">Contributing</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/resource.html">Resource</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/faq.html">FAQ</a></li></ul></li></ul></div></div><div class="basic_layout-module__post___2Z7KK ant-layout-content"><div class="ant-row" style="margin-left:-8px;margin-right:-8px"><div style="padding-left:8px;padding-right:8px" class="ant-col-xs-24 ant-col-md-18"><div class="markdown-body" style="font-size:14px"><div><h2 id="title-plugin">title: Plugin</h2><p>Plugin mechanism is a major feature of our framework. Not only can it ensure that the core of the framework is sufficiently streamlined, stable and efficient, but also can promote the reuse of business logic and the formation of an ecosystem. In the following sections, we will try to answer questions such as</p><ul><li>Koa already has a middleware mechanism, why plugins?</li><li>What are the differences/relationship between middleware and plugins?</li><li>How do I use a plugin?</li><li>How do I write a plugin?</li><li>...</li></ul><h2 id="why-plugins">Why plugins?</h2><p>Here are some of the issues we think that can arise when using Koa middleware:</p><ol><li>Middleware loading is sequential and it is the user&#x27;s responsibility to setup the execution sequence since middleware mechanism can not manage the actual order. This, in fact, is not very friendly.
When the order is not correct, it can lead to unexpected results.</li><li>Middleware positioning is geared towards intercepting user requests to add additional logic before or after such as: authentication, security checks, logging and so on. However, in some cases, such functionality can be unrelated to the request, for example, timing tasks, message subscriptions, back-end logic and so on.</li><li>Some features include very complex initialization logic that needs to be done at application startup. This is obviously not suitable for middleware to achieve.</li></ol><p>To sum up, we need a more powerful mechanism to manage, orchestrate those relatively independent business logic.</p><h3 id="the-relationship-between-middleware-plugins-and-application">The relationship between middleware, plugins and application</h3><p>A plugin is actually a &quot;mini-application&quot;, almost the same as an app:</p><ul><li>It contains <a href="./service.md">Services</a>, <a href="">middleware</a> (./ middleware.md), <a href="./config.md">config</a>, <a href="">framework extensions</a> (./ extend.md), etc.</li><li>It does not have separate <a href="">Router</a> (./ router.md) and <a href="./controller.md">Controller</a>.</li><li>It does not have <code>plugin.js</code>, it could only define dependencies with others, but could not deside whether other plugin is enable or not.</li></ul><p>Their relationship is:</p><ul><li>Applications can be directly introduced into Koa&#x27;s middleware.</li><li>When it comes to the scene mentioned in the previous section, the app needs to import the plugin.</li><li>The plugin itself can contain middleware.</li><li>Multiple plugins can be wrapped as an <a href="">upper frame</a> (../ advanced / framework.md).</li></ul><h2 id="using-plugins">Using plugins</h2><p>Plugins are usually added via the npm module:</p><pre><code class="language-bash">$ npm i egg-mysql --save</code></pre><p><strong> Note: We recommend introducing dependencies in the <code>^</code> way, and locking versions are strongly discouraged. </strong></p><pre><code class="language-json">{
  &quot;dependencies&quot;: {
    &quot;egg-mysql&quot;: &quot;^ 3.0.0&quot;
  }
}</code></pre><p>Then you need to declare it in the <code>config / plugin.js</code> application or framework:</p><pre><code class="language-js">// config / plugin.js
// Use mysql plug-in
exports.mysql = {
  enable: true,
  package: &#x27;egg-mysql&#x27;
};</code></pre><p>You can directly use the functionality provided by the plugin:</p><pre><code class="language-js">app.mysql.query(sql, values);</code></pre><h3 id="configuring-plugins">Configuring plugins</h3><p>Each configuration item in <code>plugin.js</code> supports:</p><ul><li><code>{Boolean} enable</code> - Whether to enable this plugin, the default is true</li><li><code>{String} package</code> -<code>npm</code> module name, plugin is imported via <code>npm</code> module</li><li><code>{String} path</code> - The plugin&#x27;s absolute path, mutually exclusive with package configuration</li><li><code>{Array} env</code> - Only enable plugin in the specified runtime (environment), overriding the plugin&#x27;s own configuration in <code>package.json</code></li></ul><h3 id="enablingdisabling-plugins">Enabling/Disabling plugins</h3><p>The application does not need the package or path configuration when using the plugins built in the upper framework. You only need to specify whether they are enabled or not:</p><pre><code class="language-js">// For the built-in plugin, you can use the following simple way to turn on or off
exports.onerror = false;</code></pre><h3 id="environment-configuration">Environment configuration</h3><p>We also support <code>plugin.{Env}.js</code>, which will load plugin configurations based on <a href="../basics/env.md">Runtime</a>.</p><p>For example, if you want to load the plugin <code>egg-dev</code> only in the local environment, you can install it to <code>devDependencies</code> and adjust the plugin configuration accordingly.</p><pre><code class="language-js">// npm i egg-dev --save-dev
// package.json
{
  &quot;devDependencies&quot;: {
    &quot;egg-dev&quot;: &quot;*&quot;
  }
}</code></pre><p>Then declare in <code>plugin.local.js</code>:</p><pre><code class="language-js">// config / plugin.local.js
exports.dev = {
  enable: true,
  package: &#x27;egg-dev&#x27;
};</code></pre><p>In this way, <code>npm i --production</code> in the production environment does not need to download the<code>egg-dev</code> package.</p><p><strong> Note: </strong></p><ul><li><p><code>plugin.default.js</code> does not exists. Use <code>local</code> for dev environments.</p></li><li>Use this feature only in the application layer. Do not use it in the framework layer.</li></ul><h3 id="package-name-and-path">Package name and path</h3><ul><li>The <code>package</code> is introduced in the <code>npm</code> style which is the most common way to import</li><li><code>path</code> is an absolute path introduced when you want to load the plugin from different location such as when a plugin is still at the development stage or not available on <code>npm</code></li><li>To see the application of these two scenarios, please see <a href="">progressive development</a> (../ tutorials / progressive.md).</li></ul><pre><code class="language-js">// config / plugin.js
const path = require (&#x27;path&#x27;);
exports.mysql = {
  enable: true,
  package: path.join (__ dirname, &#x27;../lib/plugin/egg-mysql&#x27;),
};</code></pre><h2 id="plugin-configuration">Plugin configuration</h2><p>The plugin will usually contain its own default configuration, you can overwrite this in <code>config.default.js</code>:</p><pre><code class="language-js">// config / config.default.js
exports.mysql = {
  client: {
    host: &#x27;mysql.com&#x27;,
    port: &#x27;3306&#x27;,
    user: &#x27;test_user&#x27;,
    password: &#x27;test_password&#x27;,
    database: &#x27;test&#x27;
  }
};</code></pre><p>Specific consolidation rules can be found in <a href="">Configuration</a> (. / Config.md).</p><h2 id="plugin-list">Plugin list</h2><ul><li>Framework has default built-in plugins for enterprise applications <a href="https://eggjs.org/zh-cn/plugins/">Common plugins</a>:
  - <a href="https://github.com/eggjs/egg-onerror">onerror</a> Uniform Exception Handling
  - <a href="https://github.com/eggjs/egg-session">Session</a> Session implementation
  - <a href="https://github.com/eggjs/egg-i18n">i18n</a> Multilingual
  - <a href="https://github.com/eggjs/egg-watcher">watcher</a> File and folder monitoring
  - <a href="https://github.com/eggjs/egg-multipart">multipart</a> File Streaming Upload
  - <a href="https://github.com/eggjs/egg-security">security</a> Security
  - <a href="https://github.com/eggjs/egg-development">development</a> Development Environment Configuration
  - <a href="https://github.com/eggjs/egg-logrotator">logrotator</a> Log segmentation
  - <a href="https://github.com/eggjs/egg-schedule">schedule</a> Timing tasks
  - <a href="https://github.com/eggjs/egg-static">static</a> Static server
  - <a href="https://github.com/eggjs/egg-jsonp">jsonp</a> jsonp support
  - <a href="https://github.com/eggjs/egg-view">view</a> Template Engine</li><li>More community plugins can be found on GitHub <a href="https://github.com/topics/egg-plugin">egg-plugin</a>.</li></ul><h2 id="developing-a-plugin">Developing a plugin</h2><p>See the documentation <a href="../advanced/plugin.md">plugin development</a>.</p></div></div></div><div style="padding-left:8px;padding-right:8px" class="ant-col-xs-0 ant-col-md-6"><div class="markdown-body" style="font-size:14px"><div><ul><li><a href="#title-plugin">title: Plugin</a></li><li><a href="#why-plugins">Why plugins?</a><ul><li><a href="#the-relationship-between-middleware-plugins-and-application">The relationship between middleware, plugins and application</a></li></ul></li><li><a href="#using-plugins">Using plugins</a><ul><li><a href="#configuring-plugins">Configuring plugins</a></li><li><a href="#enablingdisabling-plugins">Enabling/Disabling plugins</a></li><li><a href="#environment-configuration">Environment configuration</a></li><li><a href="#package-name-and-path">Package name and path</a></li></ul></li><li><a href="#plugin-configuration">Plugin configuration</a></li><li><a href="#plugin-list">Plugin list</a></li><li><a href="#developing-a-plugin">Developing a plugin</a></li></ul></div></div></div></div></div></div></div></div></div><script type="text/javascript">window.__INIT_STATE__={"lang":"en","props":{"toc":"-%20%5Btitle%3A%20Plugin%5D(%23title-plugin)%0A-%20%5BWhy%20plugins%3F%5D(%23why-plugins)%0A%20%20*%20%5BThe%20relationship%20between%20middleware%2C%20plugins%20and%20application%5D(%23the-relationship-between-middleware-plugins-and-application)%0A-%20%5BUsing%20plugins%5D(%23using-plugins)%0A%20%20*%20%5BConfiguring%20plugins%5D(%23configuring-plugins)%0A%20%20*%20%5BEnabling%2FDisabling%20plugins%5D(%23enablingdisabling-plugins)%0A%20%20*%20%5BEnvironment%20configuration%5D(%23environment-configuration)%0A%20%20*%20%5BPackage%20name%20and%20path%5D(%23package-name-and-path)%0A-%20%5BPlugin%20configuration%5D(%23plugin-configuration)%0A-%20%5BPlugin%20list%5D(%23plugin-list)%0A-%20%5BDeveloping%20a%20plugin%5D(%23developing-a-plugin)","meta":{"info":{"title":"Egg.js","subtitle":"Born to build better enterprise frameworks and apps","description":"Born to build better enterprise frameworks and apps"}},"content":"%23%23%20title%3A%20Plugin%0A%0APlugin%20mechanism%20is%20a%20major%20feature%20of%20our%20framework.%20Not%20only%20can%20it%20ensure%20that%20the%20core%20of%20the%20framework%20is%20sufficiently%20streamlined%2C%20stable%20and%20efficient%2C%20but%20also%20can%20promote%20the%20reuse%20of%20business%20logic%20and%20the%20formation%20of%20an%20ecosystem.%20In%20the%20following%20sections%2C%20we%20will%20try%20to%20answer%20questions%20such%20as%0A%0A*%20Koa%20already%20has%20a%20middleware%20mechanism%2C%20why%20plugins%3F%0A*%20What%20are%20the%20differences%2Frelationship%20between%20middleware%20and%20plugins%3F%0A*%20How%20do%20I%20use%20a%20plugin%3F%0A*%20How%20do%20I%20write%20a%20plugin%3F%0A*%20...%0A%0A%23%23%20Why%20plugins%3F%0A%0AHere%20are%20some%20of%20the%20issues%20we%20think%20that%20can%20arise%20when%20using%20Koa%20middleware%3A%0A%0A1.%20%20Middleware%20loading%20is%20sequential%20and%20it%20is%20the%20user's%20responsibility%20to%20setup%20the%20execution%20sequence%20since%20middleware%20mechanism%20can%20not%20manage%20the%20actual%20order.%20This%2C%20in%20fact%2C%20is%20not%20very%20friendly.%0A%20%20%20%20When%20the%20order%20is%20not%20correct%2C%20it%20can%20lead%20to%20unexpected%20results.%0A2.%20%20Middleware%20positioning%20is%20geared%20towards%20intercepting%20user%20requests%20to%20add%20additional%20logic%20before%20or%20after%20such%20as%3A%20authentication%2C%20security%20checks%2C%20logging%20and%20so%20on.%20However%2C%20in%20some%20cases%2C%20such%20functionality%20can%20be%20unrelated%20to%20the%20request%2C%20for%20example%2C%20timing%20tasks%2C%20message%20subscriptions%2C%20back-end%20logic%20and%20so%20on.%0A3.%20%20Some%20features%20include%20very%20complex%20initialization%20logic%20that%20needs%20to%20be%20done%20at%20application%20startup.%20This%20is%20obviously%20not%20suitable%20for%20middleware%20to%20achieve.%0A%0ATo%20sum%20up%2C%20we%20need%20a%20more%20powerful%20mechanism%20to%20manage%2C%20orchestrate%20those%20relatively%20independent%20business%20logic.%0A%0A%23%23%23%20The%20relationship%20between%20middleware%2C%20plugins%20and%20application%0A%0AA%20plugin%20is%20actually%20a%20%22mini-application%22%2C%20almost%20the%20same%20as%20an%20app%3A%0A%0A*%20It%20contains%20%5BServices%5D(.%2Fservice.md)%2C%20%5Bmiddleware%5D%20(.%2F%20middleware.md)%2C%20%5Bconfig%5D(.%2Fconfig.md)%2C%20%5Bframework%20extensions%5D%20(.%2F%20extend.md)%2C%20etc.%0A*%20It%20does%20not%20have%20separate%20%5BRouter%5D%20(.%2F%20router.md)%20and%20%5BController%5D(.%2Fcontroller.md).%0A*%20It%20does%20not%20have%20%60plugin.js%60%2C%20it%20could%20only%20define%20dependencies%20with%20others%2C%20but%20could%20not%20deside%20whether%20other%20plugin%20is%20enable%20or%20not.%0A%0A%0ATheir%20relationship%20is%3A%0A%0A*%20Applications%20can%20be%20directly%20introduced%20into%20Koa's%20middleware.%0A*%20When%20it%20comes%20to%20the%20scene%20mentioned%20in%20the%20previous%20section%2C%20the%20app%20needs%20to%20import%20the%20plugin.%0A*%20The%20plugin%20itself%20can%20contain%20middleware.%0A*%20Multiple%20plugins%20can%20be%20wrapped%20as%20an%20%5Bupper%20frame%5D%20(..%2F%20advanced%20%2F%20framework.md).%0A%0A%23%23%20Using%20plugins%0A%0APlugins%20are%20usually%20added%20via%20the%20npm%20module%3A%0A%0A%60%60%60bash%0A%24%20npm%20i%20egg-mysql%20--save%0A%60%60%60%0A%0A**%20Note%3A%20We%20recommend%20introducing%20dependencies%20in%20the%20%60%5E%60%20way%2C%20and%20locking%20versions%20are%20strongly%20discouraged.%20**%0A%0A%60%60%60json%0A%7B%0A%20%20%22dependencies%22%3A%20%7B%0A%20%20%20%20%22egg-mysql%22%3A%20%22%5E%203.0.0%22%0A%20%20%7D%0A%7D%0A%60%60%60%0A%0AThen%20you%20need%20to%20declare%20it%20in%20the%20%60config%20%2F%20plugin.js%60%20application%20or%20framework%3A%0A%0A%60%60%60js%0A%2F%2F%20config%20%2F%20plugin.js%0A%2F%2F%20Use%20mysql%20plug-in%0Aexports.mysql%20%3D%20%7B%0A%20%20enable%3A%20true%2C%0A%20%20package%3A%20'egg-mysql'%0A%7D%3B%0A%60%60%60%0A%0AYou%20can%20directly%20use%20the%20functionality%20provided%20by%20the%20plugin%3A%0A%0A%60%60%60js%0Aapp.mysql.query(sql%2C%20values)%3B%0A%60%60%60%0A%0A%23%23%23%20Configuring%20plugins%0A%0AEach%20configuration%20item%20in%20%60plugin.js%60%20supports%3A%0A%0A*%20%60%7BBoolean%7D%20enable%60%20-%20Whether%20to%20enable%20this%20plugin%2C%20the%20default%20is%20true%0A*%20%60%7BString%7D%20package%60%20-%60npm%60%20module%20name%2C%20plugin%20is%20imported%20via%20%60npm%60%20module%0A*%20%60%7BString%7D%20path%60%20-%20The%20plugin's%20absolute%20path%2C%20mutually%20exclusive%20with%20package%20configuration%0A*%20%60%7BArray%7D%20env%60%20-%20Only%20enable%20plugin%20in%20the%20specified%20runtime%20(environment)%2C%20overriding%20the%20plugin's%20own%20configuration%20in%20%60package.json%60%0A%0A%23%23%23%20Enabling%2FDisabling%20plugins%0A%0AThe%20application%20does%20not%20need%20the%20package%20or%20path%20configuration%20when%20using%20the%20plugins%20built%20in%20the%20upper%20framework.%20You%20only%20need%20to%20specify%20whether%20they%20are%20enabled%20or%20not%3A%0A%0A%60%60%60js%0A%2F%2F%20For%20the%20built-in%20plugin%2C%20you%20can%20use%20the%20following%20simple%20way%20to%20turn%20on%20or%20off%0Aexports.onerror%20%3D%20false%3B%0A%60%60%60%0A%0A%23%23%23%20Environment%20configuration%0A%0AWe%20also%20support%20%60plugin.%7BEnv%7D.js%60%2C%20which%20will%20load%20plugin%20configurations%20based%20on%20%5BRuntime%5D(..%2Fbasics%2Fenv.md).%0A%0AFor%20example%2C%20if%20you%20want%20to%20load%20the%20plugin%20%60egg-dev%60%20only%20in%20the%20local%20environment%2C%20you%20can%20install%20it%20to%20%60devDependencies%60%20and%20adjust%20the%20plugin%20configuration%20accordingly.%0A%0A%60%60%60js%0A%2F%2F%20npm%20i%20egg-dev%20--save-dev%0A%2F%2F%20package.json%0A%7B%0A%C2%A0%C2%A0%22devDependencies%22%3A%20%7B%0A%C2%A0%C2%A0%C2%A0%C2%A0%22egg-dev%22%3A%20%22*%22%0A%C2%A0%C2%A0%7D%0A%7D%0A%60%60%60%0A%0AThen%20declare%20in%20%60plugin.local.js%60%3A%0A%0A%60%60%60js%0A%2F%2F%20config%20%2F%20plugin.local.js%0Aexports.dev%20%3D%20%7B%0A%20%20enable%3A%20true%2C%0A%20%20package%3A%20'egg-dev'%0A%7D%3B%0A%60%60%60%0A%0AIn%20this%20way%2C%20%60npm%20i%20--production%60%20in%20the%20production%20environment%20does%20not%20need%20to%20download%20the%60egg-dev%60%20package.%0A%0A**%20Note%3A%20**%0A%0A*%20%60plugin.default.js%60%20does%20not%20exists.%20Use%20%60local%60%20for%20dev%20environments.%0A%0A*%20Use%20this%20feature%20only%20in%20the%20application%20layer.%20Do%20not%20use%20it%20in%20the%20framework%20layer.%0A%0A%23%23%23%20Package%20name%20and%20path%0A%0A*%20The%20%60package%60%20is%20introduced%20in%20the%20%60npm%60%20style%20which%20is%20the%20most%20common%20way%20to%20import%0A*%20%60path%60%20is%20an%20absolute%20path%20introduced%20when%20you%20want%20to%20load%20the%20plugin%20from%20different%20location%20such%20as%20when%20a%20plugin%20is%20still%20at%20the%20development%20stage%20or%20not%20available%20on%20%60npm%60%0A*%20To%20see%20the%20application%20of%20these%20two%20scenarios%2C%20please%20see%20%5Bprogressive%20development%5D%20(..%2F%20tutorials%20%2F%20progressive.md).%0A%0A%60%60%60js%0A%2F%2F%20config%20%2F%20plugin.js%0Aconst%20path%20%3D%20require%20('path')%3B%0Aexports.mysql%20%3D%20%7B%0A%C2%A0%C2%A0enable%3A%20true%2C%0A%C2%A0%C2%A0package%3A%20path.join%20(__%20dirname%2C%20'..%2Flib%2Fplugin%2Fegg-mysql')%2C%0A%7D%3B%0A%60%60%60%0A%0A%23%23%20Plugin%20configuration%0A%0AThe%20plugin%20will%20usually%20contain%20its%20own%20default%20configuration%2C%20you%20can%20overwrite%20this%20in%20%60config.default.js%60%3A%0A%0A%60%60%60js%0A%2F%2F%20config%20%2F%20config.default.js%0Aexports.mysql%20%3D%20%7B%0A%20%20client%3A%20%7B%0A%20%20%20%20host%3A%20'mysql.com'%2C%0A%20%20%20%20port%3A%20'3306'%2C%0A%20%20%20%20user%3A%20'test_user'%2C%0A%20%20%20%20password%3A%20'test_password'%2C%0A%20%20%20%20database%3A%20'test'%0A%20%20%7D%0A%7D%3B%0A%60%60%60%0A%0ASpecific%20consolidation%20rules%20can%20be%20found%20in%20%5BConfiguration%5D%20(.%20%2F%20Config.md).%0A%0A%23%23%20Plugin%20list%0A%0A*%20Framework%20has%20default%20built-in%20plugins%20for%20enterprise%20applications%20%5BCommon%20plugins%5D(https%3A%2F%2Feggjs.org%2Fzh-cn%2Fplugins%2F)%3A%0A%20%20%C2%A0%C2%A0-%20%5Bonerror%5D(https%3A%2F%2Fgithub.com%2Feggjs%2Fegg-onerror)%20Uniform%20Exception%20Handling%0A%20%20%C2%A0%C2%A0-%20%5BSession%5D(https%3A%2F%2Fgithub.com%2Feggjs%2Fegg-session)%20Session%20implementation%0A%20%20%C2%A0%C2%A0-%20%5Bi18n%5D(https%3A%2F%2Fgithub.com%2Feggjs%2Fegg-i18n)%20Multilingual%0A%20%20%C2%A0%C2%A0-%20%5Bwatcher%5D(https%3A%2F%2Fgithub.com%2Feggjs%2Fegg-watcher)%20File%20and%20folder%20monitoring%0A%20%20%C2%A0%C2%A0-%20%5Bmultipart%5D(https%3A%2F%2Fgithub.com%2Feggjs%2Fegg-multipart)%20File%20Streaming%20Upload%0A%20%20%C2%A0%C2%A0-%20%5Bsecurity%5D(https%3A%2F%2Fgithub.com%2Feggjs%2Fegg-security)%20Security%0A%20%20%C2%A0%C2%A0-%20%5Bdevelopment%5D(https%3A%2F%2Fgithub.com%2Feggjs%2Fegg-development)%20Development%20Environment%20Configuration%0A%20%20%C2%A0%C2%A0-%20%5Blogrotator%5D(https%3A%2F%2Fgithub.com%2Feggjs%2Fegg-logrotator)%20Log%20segmentation%0A%20%20%C2%A0%C2%A0-%20%5Bschedule%5D(https%3A%2F%2Fgithub.com%2Feggjs%2Fegg-schedule)%20Timing%20tasks%0A%20%20%C2%A0%C2%A0-%20%5Bstatic%5D(https%3A%2F%2Fgithub.com%2Feggjs%2Fegg-static)%20Static%20server%0A%20%20%C2%A0%C2%A0-%20%5Bjsonp%5D(https%3A%2F%2Fgithub.com%2Feggjs%2Fegg-jsonp)%20jsonp%20support%0A%20%20%C2%A0%C2%A0-%20%5Bview%5D(https%3A%2F%2Fgithub.com%2Feggjs%2Fegg-view)%20Template%20Engine%0A*%20More%20community%20plugins%20can%20be%20found%20on%20GitHub%20%5Begg-plugin%5D(https%3A%2F%2Fgithub.com%2Ftopics%2Fegg-plugin).%0A%0A%23%23%20Developing%20a%20plugin%0A%0ASee%20the%20documentation%20%5Bplugin%20development%5D(..%2Fadvanced%2Fplugin.md).%0A"}}</script><script type="text/javascript" src="/static/js/post.b9faab88.js"></script></body></html>