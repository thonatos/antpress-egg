<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="theme-color" content="#000000"><link rel="manifest" href="/manifest.json"><link rel="shortcut icon" href="/favicon.png"><style class="_styletron_hydrate_"></style><title>Router</title><meta name="description" content="Born to build better enterprise frameworks and apps"><link href="/static/css/post.d62265dc.css" rel="stylesheet"></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><div class="ant-layout" data-reactroot=""><div class="header-module__header___3ADJ9 ant-layout-header"><div class="ant-row-flex"><div class="ant-col-xs-12 ant-col-md-20 ant-col-lg-2"><div class="header-module__logo___3yTXp"><a href="/"><img src="/logo.svg" alt="logo"/></a></div></div><div class="ant-col-xs-0 ant-col-md-0 ant-col-lg-20"><ul class="ant-menu header-module__menu___3yEtW ant-menu-light ant-menu-root ant-menu-horizontal" role="menu"><li class="ant-menu-item" role="menuitem"><a href="/en/intro/">Guide</a></li><li class="ant-menu-item" role="menuitem"><a href="/api/">API</a></li><li class="ant-menu-item" role="menuitem"><a href="/en/tutorials/index.html">Tutorials</a></li><li class="ant-menu-item" role="menuitem"><a href="https://github.com/search?q=topic%3Aegg-plugin&amp;type=Repositories">Plugins</a></li><li class="ant-menu-item" role="menuitem"><a href="https://github.com/eggjs/egg/releases">Release</a></li></ul></div><div style="text-align:right" class="ant-col-xs-12 ant-col-md-4 ant-col-lg-2"><button type="button" class="ant-btn"><span>切换语言</span></button></div></div></div><div class="ant-layout-content"><div class="basic_layout-module__content___3flpY ant-layout"><div class="sider-module__side___1Cadj ant-layout-sider ant-layout-sider-light" style="flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"><ul class="ant-menu sider-module__menu___2GqPr ant-menu-light ant-menu-root ant-menu-inline" role="menu"><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="0$Menu" aria-haspopup="true"><span>Guide</span><i class="ant-menu-submenu-arrow"></i></div><ul id="0$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/intro/index.html">What is Egg?</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/intro/egg-and-koa.html">Egg and Koa</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/intro/quickstart.html">Quick Start</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/progressive.html">Progressive</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/migration.html">Migration to 2.x</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="1$Menu" aria-haspopup="true"><span>Basis Function</span><i class="ant-menu-submenu-arrow"></i></div><ul id="1$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/structure.html">Directory Structure</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/objects.html">Built-in Objects</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/env.html">Environment</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/config.html">Configuration</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/middleware.html">Middleware</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/router.html">Router</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/controller.html">Controller</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/service.html">Service</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/plugin.html">Plugin</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/schedule.html">Schedule</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/extend.html">Extend</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/app-start.html">Custom Init</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="2$Menu" aria-haspopup="true"><span>Core</span><i class="ant-menu-submenu-arrow"></i></div><ul id="2$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/development.html">Development</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/unittest.html">Unit Testing</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/deployment.html">Deployment</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/logger.html">Logger</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/httpclient.html">HttpClient</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/cookie-and-session.html">Cookie and Session</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/cluster-and-ipc.html">Cluster and IPC</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/view.html">View</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/error-handling.html">Error Handling</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/security.html">Security</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/i18n.html">i18n</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="3$Menu" aria-haspopup="true"><span>Tutorials</span><i class="ant-menu-submenu-arrow"></i></div><ul id="3$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/mysql.html">MySQL</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/restful.html">RESTful API</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/passport.html">Passport</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/socketio.html">Socket.IO</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/assets.html">Assets</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/typescript.html">TypeScript</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="4$Menu" aria-haspopup="true"><span>Advanced</span><i class="ant-menu-submenu-arrow"></i></div><ul id="4$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/advanced/loader.html">Loader</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/advanced/plugin.html">Plugin Development</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/advanced/framework.html">Framework</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/advanced/cluster-client.html">Cluster Enhancement</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/advanced/view-plugin.html">View Plugin</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/style-guide.html">Style Guide</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="5$Menu" aria-haspopup="true"><span>Community</span><i class="ant-menu-submenu-arrow"></i></div><ul id="5$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/plugins/">Plugin List</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/contributing.html">Contributing</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/resource.html">Resource</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/faq.html">FAQ</a></li></ul></li></ul></div></div><div class="basic_layout-module__post___2Z7KK ant-layout-content"><div class="ant-row" style="margin-left:-8px;margin-right:-8px"><div style="padding-left:8px;padding-right:8px" class="ant-col-xs-24 ant-col-md-18"><div class="markdown-body" style="font-size:14px"><div><p>Router is mainly used to describe the corresponding relationship between the request URL and the Controller that processes the request eventually. All routing rules are unified in the <code>app/router.js</code> file by the framework.</p><p>By unifying routing rules, we can avoid the routing logics scattered in many places which may cause many unknown conflicts, and we can more easily check global routing rules.</p><h2 id="how-to-define-router">How to Define Router</h2><ul><li>Define the routing rule in <code>app/router.js</code> file</li></ul><pre><code class="language-js">// app/router.js
module.exports = app =&gt; {
  const { router, controller } = app;
  router.get(&#x27;/user/:id&#x27;, controller.user.info);
};</code></pre><ul><li>Implement the Controller in <code>app/controller</code> directory</li></ul><pre><code class="language-js">// app/controller/user.js
class UserController extends Controller {
  async info() {
    const { ctx } = this;
    ctx.body = {
      name: `hello ${ctx.params.id}`,
    };
  }
}</code></pre><p>This simplest Router is done by now, when users do the request <code>GET /user/123</code>, the info function in <code>user.js</code> will be invoked.</p><h2 id="router-config-in-detail">Router config in detail</h2><p>Below is the complete definition of router, parameters can be determined depending on different scenes.</p><pre><code class="language-js">router.verb(&#x27;path-match&#x27;, app.controller.action);
router.verb(&#x27;router-name&#x27;, &#x27;path-match&#x27;, app.controller.action);
router.verb(&#x27;path-match&#x27;, middleware1, ..., middlewareN, app.controller.action);
router.verb(&#x27;router-name&#x27;, &#x27;path-match&#x27;, middleware1, ..., middlewareN, app.controller.action);</code></pre><p>The complete definition of router includes 5 major parts:</p><ul><li>verb - actions that users trigger, including get, post and so on, and will be explained in detail later.<ul><li>router.head - HEAD</li><li>router.options - OPTIONS</li><li>router.get - GET</li><li>router.put - PUT</li><li>router.post - POST</li><li>router.patch - PATCH</li><li>router.delete - DELETE</li><li>router.del - this is a alias method due to the reservation of delete.</li><li>router.redirect - redirects the request URL. For example, the most common case is to redirect the request accessing the root directory to the homepage.</li></ul></li><li>router-name defines a alias for the route, and URL can be generated by helper method <code>pathFor</code> and <code>urlFor</code> provided by Helper. (Optional)</li><li>path-match - URL path of the route.</li><li>middleware1 - multiple Middlewares can be configured in Router. (Optional)</li><li>controller - set the route to map to the specific controller, and the controller can be written in two types:<ul><li><code>app.controller.user.fetch</code> - directly point to a controller</li><li><code>&#x27;user.fetch&#x27;</code> - simplified as a string,</li></ul></li></ul><h3 id="notices">Notices</h3><ul><li>multiple Middlewares can be configured to execute serially in Router definition</li><li>Controller must be defined under <code>app/controller</code> directory</li><li>multiple Controllers can be defined within one file, and the specific one can be specified in the form of <code>${fileName}.${functionName}</code> when defining the routing rule.</li><li>Controller supports sub-directories, and the specific one can be specified in the form of <code>${directoryName}.${fileName}.${functionName}</code> when defining the routing rule.</li></ul><p>Here are some examples of writing routing rules:</p><pre><code class="language-js">// app/router.js
module.exports = app =&gt; {
  const { router, controller } = app;
  router.get(&#x27;/home&#x27;, controller.home);
  router.get(&#x27;/user/:id&#x27;, controller.user.page);
  router.post(&#x27;/admin&#x27;, isAdmin, controller.admin);
  router.post(&#x27;/user&#x27;, isLoginUser, hasAdminPermission, controller.user.create);
  router.post(&#x27;/api/v1/comments&#x27;, controller.v1.comments.create); // app/controller/v1/comments.js
};</code></pre><h3 id="restful-style-url-definition">RESTful style URL definition</h3><p>We provide <code>app.resources(&#x27;routerName&#x27;, &#x27;pathMatch&#x27;, &#x27;controller&#x27;)</code> to generate <a href="https://en.wikipedia.org/wiki/Create,_read,_update_and_delete">CRUD</a> structures on a path for convenience if you prefer the RESTful style URL definition.</p><pre><code class="language-js">// app/router.js
module.exports = app =&gt; {
  const { router, controller } = app;
  router.resources(&#x27;posts&#x27;, &#x27;/posts&#x27;, controller.posts);
  router.resources(&#x27;users&#x27;, &#x27;/api/v1/users&#x27;, controller.v1.users); // app/controller/v1/users.js
};</code></pre><p>The codes above produce a bunch of CRUD path structures for Controller <code>app/controller/posts.js</code>, and the only thing you should do next is to implement related functions in <code>posts.js</code>.</p><table><thead><tr><th>Method</th><th>Path</th><th>Route Name</th><th>Controller.Action</th></tr></thead><tbody><tr><td>GET</td><td>/posts</td><td>posts</td><td>app.controllers.posts.index</td></tr><tr><td>GET</td><td>/posts/new</td><td>new_post</td><td>app.controllers.posts.new</td></tr><tr><td>GET</td><td>/posts/:id</td><td>post</td><td>app.controllers.posts.show</td></tr><tr><td>GET</td><td>/posts/:id/edit</td><td>edit_post</td><td>app.controllers.posts.edit</td></tr><tr><td>POST</td><td>/posts</td><td>posts</td><td>app.controllers.posts.create</td></tr><tr><td>PATCH</td><td>/posts/:id</td><td>post</td><td>app.controllers.posts.update</td></tr><tr><td>DELETE</td><td>/posts/:id</td><td>post</td><td>app.controllers.posts.destroy</td></tr></tbody></table><pre><code class="language-js">// app/controller/posts.js
exports.index = async () =&gt; {};

exports.new = async () =&gt; {};

exports.create = async () =&gt; {};

exports.show = async () =&gt; {};

exports.edit = async () =&gt; {};

exports.update = async () =&gt; {};

exports.destroy = async () =&gt; {};</code></pre><p>Methods that are not needed may not be implemented in <code>posts.js</code> and the related URL paths will not be registered to Router neither.</p><h2 id="router-in-action">Router in Action</h2><p>More practical examples will be shown below to demonstrate how to use the router.</p><h4 id="acquiring-parameters">Acquiring Parameters</h4><h4 id="via-query-string">via Query String</h4><pre><code class="language-js">// app/router.js
module.exports = app =&gt; {
  app.router.get(&#x27;/search&#x27;, app.controller.search.index);
};

// app/controller/search.js
exports.index = async ctx =&gt; {
  ctx.body = `search: ${ctx.query.name}`;
};

// curl http://127.0.0.1:7001/search?name=egg</code></pre><h4 id="via-named-parameters">via Named Parameters</h4><pre><code class="language-js">// app/router.js
module.exports = app =&gt; {
  app.router.get(&#x27;/user/:id/:name&#x27;, app.controller.user.info);
};

// app/controller/user.js
exports.info = async ctx =&gt; {
  ctx.body = `user: ${ctx.params.id}, ${ctx.params.name}`;
};

// curl http://127.0.0.1:7001/user/123/xiaoming</code></pre><h4 id="acquiring-complex-parameters">acquiring complex parameters</h4><p>Regular expressions, as well, can be used in routing rules to acquire parameters more flexibly:</p><pre><code class="language-js">// app/router.js
module.exports = app =&gt; {
  app.router.get(/^\/package\/([\w-.]+\/[\w-.]+)$/, app.controller.package.detail);
};

// app/controller/package.js
exports.detail = async ctx =&gt; {
  // If the request URL is matched by the regular expression, parameters can be acquired from ctx.params according to the capture group orders.
  // For the user request below, for example, the value of `ctx.params[0]` is `egg/1.0.0`
  ctx.body = `package:${ctx.params[0]}`;
};

// curl http://127.0.0.1:7001/package/egg/1.0.0</code></pre><h3 id="acquiring-form-contents">Acquiring Form Contents</h3><pre><code class="language-js">// app/router.js
module.exports = app =&gt; {
  app.router.post(&#x27;/form&#x27;, app.controller.form.post);
};

// app/controller/form.js
exports.post = async ctx =&gt; {
  ctx.body = `body: ${JSON.stringify(ctx.request.body)}`;
};

// simulate a post request.
// curl -X POST http://127.0.0.1:7001/form --data &#x27;{&quot;name&quot;:&quot;controller&quot;}&#x27; --header &#x27;Content-Type:application/json&#x27;</code></pre><blockquote><p>P.S.:</p><p>If you perform a POST request directly, an <strong>error</strong> will occur: &#x27;secret is missing&#x27;. This error message comes from <a href="https://github.com/koajs/csrf/blob/2.5.0/index.js#L69">koa-csrf/index.js#L69</a>.</p><p><strong>Reason</strong>: the framework verifies the CSFR value specially for form POST requests, so please submit the CSRF key as well when you submit a form. Refer to <a href="https://eggjs.org/zh-cn/core/security.html#安全威胁csrf的防范">Keep Away from CSRF Threat</a> for more detail.</p><p><strong>Note</strong>: the verification is performed because the framework builds in a security plugin <a href="https://github.com/eggjs/egg-security">egg-security</a> that provides some default security practices and this plugin is enabled by default. In case you want to disable some security protections, just set the enable attribute to false.</p><p>&quot;Unless you clearly confirm the consequence, it&#x27;s not recommended to disable functions provided by the security plugin&quot;</p><p>Here we do the config temporarily in <code>config/config.default.js</code> for an example</p><pre><code>exports.security = {
  csrf: false
};</code></pre></blockquote><h3 id="form-verification">Form Verification</h3><pre><code class="language-js">// app/router.js
module.exports = app =&gt; {
  app.router.post(&#x27;/user&#x27;, app.controller.user);
};

// app/controller/user.js
const createRule = {
  username: {
    type: &#x27;email&#x27;,
  },
  password: {
    type: &#x27;password&#x27;,
    compare: &#x27;re-password&#x27;,
  },
};

exports.create = async ctx =&gt; {
  // throws exceptions if the verification fails
  ctx.validate(createRule);
  ctx.body = ctx.request.body;
};

// curl -X POST http://127.0.0.1:7001/user --data &#x27;username=abc@abc.com&amp;password=111111&amp;re-password=111111&#x27;</code></pre><h3 id="redirection">Redirection</h3><h4 id="internal-redirection">Internal Redirection</h4><pre><code class="language-js">// app/router.js
module.exports = app =&gt; {
  app.router.get(&#x27;index&#x27;, &#x27;/home/index&#x27;, app.controller.home.index);
  app.redirect(&#x27;/&#x27;, &#x27;/home/index&#x27;, 302);
};

// app/controller/home.js
exports.index = async ctx =&gt; {
  ctx.body = &#x27;hello controller&#x27;;
};

// curl -L http://localhost:7001</code></pre><h4 id="external-redirection">External Redirection</h4><pre><code class="language-js">// app/router.js
module.exports = app =&gt; {
  app.router.get(&#x27;/search&#x27;, app.controller.search.index);
};

// app/controller/search.js
exports.index = async ctx =&gt; {
  const type = ctx.query.type;
  const q = ctx.query.q || &#x27;nodejs&#x27;;

  if (type === &#x27;bing&#x27;) {
    ctx.redirect(`http://cn.bing.com/search?q=${q}`);
  } else {
    ctx.redirect(`https://www.google.co.kr/search?q=${q}`);
  }
};

// curl http://localhost:7001/search?type=bing&amp;q=node.js
// curl http://localhost:7001/search?q=node.js</code></pre><h3 id="using-middleware">Using Middleware</h3><p>A middleware can be used to change the request parameter to uppercase.
Here we just briefly explain how to use the middleware, and refer to <a href="./middleware.md">Middleware</a> for detail.</p><pre><code class="language-js">// app/controller/search.js
exports.index = async ctx =&gt; {
  ctx.body = `search: ${ctx.query.name}`;
};

// app/middleware/uppercase.js
module.exports = () =&gt; {
  return async function uppercase(ctx, next) {
    ctx.query.name = ctx.query.name &amp;&amp; ctx.query.name.toUpperCase();
    await next();
  };
};

// app/router.js
module.exports = app =&gt; {
  app.router.get(&#x27;s&#x27;, &#x27;/search&#x27;, app.middlewares.uppercase(), app.controller.search)
};

// curl http://localhost:7001/search?name=egg</code></pre><h3 id="too-many-routing-maps">Too Many Routing Maps?</h3><p>As described above, we do not recommend that you scatter routing logics all around, or it will bring trouble in trouble shooting.</p><p>If there is a need for some reasons, you can split routing rules like below:</p><pre><code class="language-js">// app/router.js
module.exports = app =&gt; {
  require(&#x27;./router/news&#x27;)(app);
  require(&#x27;./router/admin&#x27;)(app);
};

// app/router/news.js
module.exports = app =&gt; {
  app.router.get(&#x27;/news/list&#x27;, app.controller.news.list);
  app.router.get(&#x27;/news/detail&#x27;, app.controller.news.detail);
};

// app/router/admin.js
module.exports = app =&gt; {
  app.router.get(&#x27;/admin/user&#x27;, app.controller.admin.user);
  app.router.get(&#x27;/admin/log&#x27;, app.controller.admin.log);
};</code></pre><p>or using <a href="https://github.com/eggjs/egg-router-plus">egg-router-plus</a>.</p></div></div></div><div style="padding-left:8px;padding-right:8px" class="ant-col-xs-0 ant-col-md-6"><div class="markdown-body" style="font-size:14px"><div><ul><li><a href="#how-to-define-router">How to Define Router</a></li><li><a href="#router-config-in-detail">Router config in detail</a><ul><li><a href="#notices">Notices</a></li><li><a href="#restful-style-url-definition">RESTful style URL definition</a></li></ul></li><li><a href="#router-in-action">Router in Action</a><ul><li><a href="#acquiring-parameters">Acquiring Parameters</a></li><li><a href="#via-query-string">via Query String</a></li><li><a href="#via-named-parameters">via Named Parameters</a></li><li><a href="#acquiring-complex-parameters">acquiring complex parameters</a></li></ul><ul><li><a href="#acquiring-form-contents">Acquiring Form Contents</a></li><li><a href="#form-verification">Form Verification</a></li><li><a href="#redirection">Redirection</a><ul><li><a href="#internal-redirection">Internal Redirection</a></li><li><a href="#external-redirection">External Redirection</a></li></ul></li><li><a href="#using-middleware">Using Middleware</a></li><li><a href="#too-many-routing-maps">Too Many Routing Maps?</a></li></ul></li></ul></div></div></div></div></div></div></div></div></div><script type="text/javascript">window.__INIT_STATE__={"lang":"en","props":{"toc":"-%20%5BHow%20to%20Define%20Router%5D(%23how-to-define-router)%0A-%20%5BRouter%20config%20in%20detail%5D(%23router-config-in-detail)%0A%20%20*%20%5BNotices%5D(%23notices)%0A%20%20*%20%5BRESTful%20style%20URL%20definition%5D(%23restful-style-url-definition)%0A-%20%5BRouter%20in%20Action%5D(%23router-in-action)%0A%20%20%20%20%2B%20%5BAcquiring%20Parameters%5D(%23acquiring-parameters)%0A%20%20%20%20%2B%20%5Bvia%20Query%20String%5D(%23via-query-string)%0A%20%20%20%20%2B%20%5Bvia%20Named%20Parameters%5D(%23via-named-parameters)%0A%20%20%20%20%2B%20%5Bacquiring%20complex%20parameters%5D(%23acquiring-complex-parameters)%0A%20%20*%20%5BAcquiring%20Form%20Contents%5D(%23acquiring-form-contents)%0A%20%20*%20%5BForm%20Verification%5D(%23form-verification)%0A%20%20*%20%5BRedirection%5D(%23redirection)%0A%20%20%20%20%2B%20%5BInternal%20Redirection%5D(%23internal-redirection)%0A%20%20%20%20%2B%20%5BExternal%20Redirection%5D(%23external-redirection)%0A%20%20*%20%5BUsing%20Middleware%5D(%23using-middleware)%0A%20%20*%20%5BToo%20Many%20Routing%20Maps%3F%5D(%23too-many-routing-maps)","meta":{"info":{"title":"Router"}},"content":"%0A%0A%0ARouter%20is%20mainly%20used%20to%20describe%20the%20corresponding%20relationship%20between%20the%20request%20URL%20and%20the%20Controller%20that%20processes%20the%20request%20eventually.%20All%20routing%20rules%20are%20unified%20in%20the%20%60app%2Frouter.js%60%20file%20by%20the%20framework.%0A%0ABy%20unifying%20routing%20rules%2C%20we%20can%20avoid%20the%20routing%20logics%20scattered%20in%20many%20places%20which%20may%20cause%20many%20unknown%20conflicts%2C%20and%20we%20can%20more%20easily%20check%20global%20routing%20rules.%0A%0A%23%23%20How%20to%20Define%20Router%0A%0A-%20Define%20the%20routing%20rule%20in%20%60app%2Frouter.js%60%20file%0A%0A%60%60%60js%0A%2F%2F%20app%2Frouter.js%0Amodule.exports%20%3D%20app%20%3D%3E%20%7B%0A%20%20const%20%7B%20router%2C%20controller%20%7D%20%3D%20app%3B%0A%20%20router.get('%2Fuser%2F%3Aid'%2C%20controller.user.info)%3B%0A%7D%3B%0A%60%60%60%0A%0A-%20Implement%20the%20Controller%20in%20%60app%2Fcontroller%60%20directory%0A%0A%60%60%60js%0A%2F%2F%20app%2Fcontroller%2Fuser.js%0Aclass%20UserController%20extends%20Controller%20%7B%0A%20%20async%20info()%20%7B%0A%20%20%20%20const%20%7B%20ctx%20%7D%20%3D%20this%3B%0A%20%20%20%20ctx.body%20%3D%20%7B%0A%20%20%20%20%20%20name%3A%20%60hello%20%24%7Bctx.params.id%7D%60%2C%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%7D%0A%60%60%60%0AThis%20simplest%20Router%20is%20done%20by%20now%2C%20when%20users%20do%20the%20request%20%60GET%20%2Fuser%2F123%60%2C%20the%20info%20function%20in%20%60user.js%60%20will%20be%20invoked.%0A%0A%23%23%20Router%20config%20in%20detail%0A%0ABelow%20is%20the%20complete%20definition%20of%20router%2C%20parameters%20can%20be%20determined%20depending%20on%20different%20scenes.%0A%0A%60%60%60js%0Arouter.verb('path-match'%2C%20app.controller.action)%3B%0Arouter.verb('router-name'%2C%20'path-match'%2C%20app.controller.action)%3B%0Arouter.verb('path-match'%2C%20middleware1%2C%20...%2C%20middlewareN%2C%20app.controller.action)%3B%0Arouter.verb('router-name'%2C%20'path-match'%2C%20middleware1%2C%20...%2C%20middlewareN%2C%20app.controller.action)%3B%0A%60%60%60%0AThe%20complete%20definition%20of%20router%20includes%205%20major%20parts%3A%0A%0A-%20verb%20-%20actions%20that%20users%20trigger%2C%20including%20get%2C%20post%20and%20so%20on%2C%20and%20will%20be%20explained%20in%20detail%20later.%0A%20%20*%20router.head%20-%20HEAD%0A%20%20*%20router.options%20-%20OPTIONS%0A%20%20*%20router.get%20-%20GET%0A%20%20*%20router.put%20-%20PUT%0A%20%20*%20router.post%20-%20POST%0A%20%20*%20router.patch%20-%20PATCH%0A%20%20*%20router.delete%20-%20DELETE%0A%20%20*%20router.del%20-%20this%20is%20a%20alias%20method%20due%20to%20the%20reservation%20of%20delete.%0A%20%20*%20router.redirect%20-%20redirects%20the%20request%20URL.%20For%20example%2C%20the%20most%20common%20case%20is%20to%20redirect%20the%20request%20accessing%20the%20root%20directory%20to%20the%20homepage.%0A-%20router-name%20defines%20a%20alias%20for%20the%20route%2C%20and%20URL%20can%20be%20generated%20by%20helper%20method%20%60pathFor%60%20and%20%60urlFor%60%20provided%20by%20Helper.%20(Optional)%0A-%20path-match%20-%20URL%20path%20of%20the%20route.%0A-%20middleware1%20-%20multiple%20Middlewares%20can%20be%20configured%20in%20Router.%20(Optional)%0A-%20controller%20-%20set%20the%20route%20to%20map%20to%20the%20specific%20controller%2C%20and%20the%20controller%20can%20be%20written%20in%20two%20types%3A%0A%20%20*%20%60app.controller.user.fetch%60%20-%20directly%20point%20to%20a%20controller%0A%20%20*%20%60'user.fetch'%60%20-%20simplified%20as%20a%20string%2C%0A%0A%23%23%23%20Notices%0A%0A-%20multiple%20Middlewares%20can%20be%20configured%20to%20execute%20serially%20in%20Router%20definition%0A-%20Controller%20must%20be%20defined%20under%20%60app%2Fcontroller%60%20directory%0A-%20multiple%20Controllers%20can%20be%20defined%20within%20one%20file%2C%20and%20the%20specific%20one%20can%20be%20specified%20in%20the%20form%20of%20%60%24%7BfileName%7D.%24%7BfunctionName%7D%60%20when%20defining%20the%20routing%20rule.%0A-%20Controller%20supports%20sub-directories%2C%20and%20the%20specific%20one%20can%20be%20specified%20in%20the%20form%20of%20%60%24%7BdirectoryName%7D.%24%7BfileName%7D.%24%7BfunctionName%7D%60%20when%20defining%20the%20routing%20rule.%0A%0AHere%20are%20some%20examples%20of%20writing%20routing%20rules%3A%0A%0A%60%60%60js%0A%2F%2F%20app%2Frouter.js%0Amodule.exports%20%3D%20app%20%3D%3E%20%7B%0A%20%20const%20%7B%20router%2C%20controller%20%7D%20%3D%20app%3B%0A%20%20router.get('%2Fhome'%2C%20controller.home)%3B%0A%20%20router.get('%2Fuser%2F%3Aid'%2C%20controller.user.page)%3B%0A%20%20router.post('%2Fadmin'%2C%20isAdmin%2C%20controller.admin)%3B%0A%20%20router.post('%2Fuser'%2C%20isLoginUser%2C%20hasAdminPermission%2C%20controller.user.create)%3B%0A%20%20router.post('%2Fapi%2Fv1%2Fcomments'%2C%20controller.v1.comments.create)%3B%20%2F%2F%20app%2Fcontroller%2Fv1%2Fcomments.js%0A%7D%3B%0A%60%60%60%0A%0A%23%23%23%20RESTful%20style%20URL%20definition%0A%0AWe%20provide%20%60app.resources('routerName'%2C%20'pathMatch'%2C%20'controller')%60%20to%20generate%20%5BCRUD%5D(https%3A%2F%2Fen.wikipedia.org%2Fwiki%2FCreate%2C_read%2C_update_and_delete)%20structures%20on%20a%20path%20for%20convenience%20if%20you%20prefer%20the%20RESTful%20style%20URL%20definition.%0A%0A%60%60%60js%0A%2F%2F%20app%2Frouter.js%0Amodule.exports%20%3D%20app%20%3D%3E%20%7B%0A%20%20const%20%7B%20router%2C%20controller%20%7D%20%3D%20app%3B%0A%20%20router.resources('posts'%2C%20'%2Fposts'%2C%20controller.posts)%3B%0A%20%20router.resources('users'%2C%20'%2Fapi%2Fv1%2Fusers'%2C%20controller.v1.users)%3B%20%2F%2F%20app%2Fcontroller%2Fv1%2Fusers.js%0A%7D%3B%0A%60%60%60%0A%0AThe%20codes%20above%20produce%20a%20bunch%20of%20CRUD%20path%20structures%20for%20Controller%20%60app%2Fcontroller%2Fposts.js%60%2C%20and%20the%20only%20thing%20you%20should%20do%20next%20is%20to%20implement%20related%20functions%20in%20%60posts.js%60.%0A%0AMethod%20%7C%20Path%20%20%20%20%20%20%20%20%20%20%20%20%7C%20Route%20Name%20%20%20%20%20%7C%20Controller.Action%0A-------%7C-----------------%7C----------------%7C-----------------------------%0AGET%20%20%20%20%7C%20%2Fposts%20%20%20%20%20%20%20%20%20%20%7C%20posts%20%20%20%20%20%20%20%20%20%20%7C%20app.controllers.posts.index%0AGET%20%20%20%20%7C%20%2Fposts%2Fnew%20%20%20%20%20%20%7C%20new_post%20%20%20%20%20%20%20%7C%20app.controllers.posts.new%0AGET%20%20%20%20%7C%20%2Fposts%2F%3Aid%20%20%20%20%20%20%7C%20post%20%20%20%20%20%20%20%20%20%20%20%7C%20app.controllers.posts.show%0AGET%20%20%20%20%7C%20%2Fposts%2F%3Aid%2Fedit%20%7C%20edit_post%20%20%20%20%20%20%7C%20app.controllers.posts.edit%0APOST%20%20%20%7C%20%2Fposts%20%20%20%20%20%20%20%20%20%20%7C%20posts%20%20%20%20%20%20%20%20%20%20%7C%20app.controllers.posts.create%0APATCH%20%20%7C%20%2Fposts%2F%3Aid%20%20%20%20%20%20%7C%20post%20%20%20%20%20%20%20%20%20%20%20%7C%20app.controllers.posts.update%0ADELETE%20%7C%20%2Fposts%2F%3Aid%20%20%20%20%20%20%7C%20post%20%20%20%20%20%20%20%20%20%20%20%7C%20app.controllers.posts.destroy%0A%0A%60%60%60js%0A%2F%2F%20app%2Fcontroller%2Fposts.js%0Aexports.index%20%3D%20async%20()%20%3D%3E%20%7B%7D%3B%0A%0Aexports.new%20%3D%20async%20()%20%3D%3E%20%7B%7D%3B%0A%0Aexports.create%20%3D%20async%20()%20%3D%3E%20%7B%7D%3B%0A%0Aexports.show%20%3D%20async%20()%20%3D%3E%20%7B%7D%3B%0A%0Aexports.edit%20%3D%20async%20()%20%3D%3E%20%7B%7D%3B%0A%0Aexports.update%20%3D%20async%20()%20%3D%3E%20%7B%7D%3B%0A%0Aexports.destroy%20%3D%20async%20()%20%3D%3E%20%7B%7D%3B%0A%60%60%60%0A%0AMethods%20that%20are%20not%20needed%20may%20not%20be%20implemented%20in%20%60posts.js%60%20and%20the%20related%20URL%20paths%20will%20not%20be%20registered%20to%20Router%20neither.%0A%0A%23%23%20Router%20in%20Action%0A%0AMore%20practical%20examples%20will%20be%20shown%20below%20to%20demonstrate%20how%20to%20use%20the%20router.%0A%0A%23%23%23%23%20Acquiring%20Parameters%0A%0A%23%23%23%23%20via%20Query%20String%0A%0A%60%60%60js%0A%2F%2F%20app%2Frouter.js%0Amodule.exports%20%3D%20app%20%3D%3E%20%7B%0A%20%20app.router.get('%2Fsearch'%2C%20app.controller.search.index)%3B%0A%7D%3B%0A%0A%2F%2F%20app%2Fcontroller%2Fsearch.js%0Aexports.index%20%3D%20async%20ctx%20%3D%3E%20%7B%0A%20%20ctx.body%20%3D%20%60search%3A%20%24%7Bctx.query.name%7D%60%3B%0A%7D%3B%0A%0A%2F%2F%20curl%20http%3A%2F%2F127.0.0.1%3A7001%2Fsearch%3Fname%3Degg%0A%60%60%60%0A%0A%23%23%23%23%20via%20Named%20Parameters%0A%0A%60%60%60js%0A%2F%2F%20app%2Frouter.js%0Amodule.exports%20%3D%20app%20%3D%3E%20%7B%0A%20%20app.router.get('%2Fuser%2F%3Aid%2F%3Aname'%2C%20app.controller.user.info)%3B%0A%7D%3B%0A%0A%2F%2F%20app%2Fcontroller%2Fuser.js%0Aexports.info%20%3D%20async%20ctx%20%3D%3E%20%7B%0A%20%20ctx.body%20%3D%20%60user%3A%20%24%7Bctx.params.id%7D%2C%20%24%7Bctx.params.name%7D%60%3B%0A%7D%3B%0A%0A%2F%2F%20curl%20http%3A%2F%2F127.0.0.1%3A7001%2Fuser%2F123%2Fxiaoming%0A%60%60%60%0A%0A%23%23%23%23%20acquiring%20complex%20parameters%0A%0ARegular%20expressions%2C%20as%20well%2C%20can%20be%20used%20in%20routing%20rules%20to%20acquire%20parameters%20more%20flexibly%3A%0A%0A%60%60%60js%0A%2F%2F%20app%2Frouter.js%0Amodule.exports%20%3D%20app%20%3D%3E%20%7B%0A%20%20app.router.get(%2F%5E%5C%2Fpackage%5C%2F(%5B%5Cw-.%5D%2B%5C%2F%5B%5Cw-.%5D%2B)%24%2F%2C%20app.controller.package.detail)%3B%0A%7D%3B%0A%0A%2F%2F%20app%2Fcontroller%2Fpackage.js%0Aexports.detail%20%3D%20async%20ctx%20%3D%3E%20%7B%0A%20%20%2F%2F%20If%20the%20request%20URL%20is%20matched%20by%20the%20regular%20expression%2C%20parameters%20can%20be%20acquired%20from%20ctx.params%20according%20to%20the%20capture%20group%20orders.%0A%20%20%2F%2F%20For%20the%20user%20request%20below%2C%20for%20example%2C%20the%20value%20of%20%60ctx.params%5B0%5D%60%20is%20%60egg%2F1.0.0%60%0A%20%20ctx.body%20%3D%20%60package%3A%24%7Bctx.params%5B0%5D%7D%60%3B%0A%7D%3B%0A%0A%2F%2F%20curl%20http%3A%2F%2F127.0.0.1%3A7001%2Fpackage%2Fegg%2F1.0.0%0A%60%60%60%0A%0A%23%23%23%20Acquiring%20Form%20Contents%0A%0A%60%60%60js%0A%2F%2F%20app%2Frouter.js%0Amodule.exports%20%3D%20app%20%3D%3E%20%7B%0A%20%20app.router.post('%2Fform'%2C%20app.controller.form.post)%3B%0A%7D%3B%0A%0A%2F%2F%20app%2Fcontroller%2Fform.js%0Aexports.post%20%3D%20async%20ctx%20%3D%3E%20%7B%0A%20%20ctx.body%20%3D%20%60body%3A%20%24%7BJSON.stringify(ctx.request.body)%7D%60%3B%0A%7D%3B%0A%0A%2F%2F%20simulate%20a%20post%20request.%0A%2F%2F%20curl%20-X%20POST%20http%3A%2F%2F127.0.0.1%3A7001%2Fform%20--data%20'%7B%22name%22%3A%22controller%22%7D'%20--header%20'Content-Type%3Aapplication%2Fjson'%0A%60%60%60%0A%0A%3E%20P.S.%3A%0A%0A%3E%20If%20you%20perform%20a%20POST%20request%20directly%2C%20an%20**error**%20will%20occur%3A%20'secret%20is%20missing'.%20This%20error%20message%20comes%20from%20%5Bkoa-csrf%2Findex.js%23L69%5D(https%3A%2F%2Fgithub.com%2Fkoajs%2Fcsrf%2Fblob%2F2.5.0%2Findex.js%23L69).%0A%0A%3E%20**Reason**%3A%20the%20framework%20verifies%20the%20CSFR%20value%20specially%20for%20form%20POST%20requests%2C%20so%20please%20submit%20the%20CSRF%20key%20as%20well%20when%20you%20submit%20a%20form.%20Refer%20to%20%5BKeep%20Away%20from%20CSRF%20Threat%5D(https%3A%2F%2Feggjs.org%2Fzh-cn%2Fcore%2Fsecurity.html%23%E5%AE%89%E5%85%A8%E5%A8%81%E8%83%81csrf%E7%9A%84%E9%98%B2%E8%8C%83)%20for%20more%20detail.%0A%0A%3E%20**Note**%3A%20the%20verification%20is%20performed%20because%20the%20framework%20builds%20in%20a%20security%20plugin%20%5Begg-security%5D(https%3A%2F%2Fgithub.com%2Feggjs%2Fegg-security)%20that%20provides%20some%20default%20security%20practices%20and%20this%20plugin%20is%20enabled%20by%20default.%20In%20case%20you%20want%20to%20disable%20some%20security%20protections%2C%20just%20set%20the%20enable%20attribute%20to%20false.%0A%0A%3E%20%22Unless%20you%20clearly%20confirm%20the%20consequence%2C%20it's%20not%20recommended%20to%20disable%20functions%20provided%20by%20the%20security%20plugin%22%0A%0A%3E%20Here%20we%20do%20the%20config%20temporarily%20in%20%60config%2Fconfig.default.js%60%20for%20an%20example%0A%60%60%60%0Aexports.security%20%3D%20%7B%0A%20%20csrf%3A%20false%0A%7D%3B%0A%60%60%60%0A%0A%23%23%23%20Form%20Verification%0A%0A%60%60%60js%0A%2F%2F%20app%2Frouter.js%0Amodule.exports%20%3D%20app%20%3D%3E%20%7B%0A%20%20app.router.post('%2Fuser'%2C%20app.controller.user)%3B%0A%7D%3B%0A%0A%2F%2F%20app%2Fcontroller%2Fuser.js%0Aconst%20createRule%20%3D%20%7B%0A%20%20username%3A%20%7B%0A%20%20%20%20type%3A%20'email'%2C%0A%20%20%7D%2C%0A%20%20password%3A%20%7B%0A%20%20%20%20type%3A%20'password'%2C%0A%20%20%20%20compare%3A%20're-password'%2C%0A%20%20%7D%2C%0A%7D%3B%0A%0Aexports.create%20%3D%20async%20ctx%20%3D%3E%20%7B%0A%20%20%2F%2F%20throws%20exceptions%20if%20the%20verification%20fails%0A%20%20ctx.validate(createRule)%3B%0A%20%20ctx.body%20%3D%20ctx.request.body%3B%0A%7D%3B%0A%0A%2F%2F%20curl%20-X%20POST%20http%3A%2F%2F127.0.0.1%3A7001%2Fuser%20--data%20'username%3Dabc%40abc.com%26password%3D111111%26re-password%3D111111'%0A%60%60%60%0A%0A%23%23%23%20Redirection%0A%0A%23%23%23%23%20Internal%20Redirection%0A%0A%60%60%60js%0A%2F%2F%20app%2Frouter.js%0Amodule.exports%20%3D%20app%20%3D%3E%20%7B%0A%20%20app.router.get('index'%2C%20'%2Fhome%2Findex'%2C%20app.controller.home.index)%3B%0A%20%20app.redirect('%2F'%2C%20'%2Fhome%2Findex'%2C%20302)%3B%0A%7D%3B%0A%0A%2F%2F%20app%2Fcontroller%2Fhome.js%0Aexports.index%20%3D%20async%20ctx%20%3D%3E%20%7B%0A%20%20ctx.body%20%3D%20'hello%20controller'%3B%0A%7D%3B%0A%0A%2F%2F%20curl%20-L%20http%3A%2F%2Flocalhost%3A7001%0A%60%60%60%0A%0A%23%23%23%23%20External%20Redirection%0A%0A%60%60%60js%0A%2F%2F%20app%2Frouter.js%0Amodule.exports%20%3D%20app%20%3D%3E%20%7B%0A%20%20app.router.get('%2Fsearch'%2C%20app.controller.search.index)%3B%0A%7D%3B%0A%0A%2F%2F%20app%2Fcontroller%2Fsearch.js%0Aexports.index%20%3D%20async%20ctx%20%3D%3E%20%7B%0A%20%20const%20type%20%3D%20ctx.query.type%3B%0A%20%20const%20q%20%3D%20ctx.query.q%20%7C%7C%20'nodejs'%3B%0A%0A%20%20if%20(type%20%3D%3D%3D%20'bing')%20%7B%0A%20%20%20%20ctx.redirect(%60http%3A%2F%2Fcn.bing.com%2Fsearch%3Fq%3D%24%7Bq%7D%60)%3B%0A%20%20%7D%20else%20%7B%0A%20%20%20%20ctx.redirect(%60https%3A%2F%2Fwww.google.co.kr%2Fsearch%3Fq%3D%24%7Bq%7D%60)%3B%0A%20%20%7D%0A%7D%3B%0A%0A%2F%2F%20curl%20http%3A%2F%2Flocalhost%3A7001%2Fsearch%3Ftype%3Dbing%26q%3Dnode.js%0A%2F%2F%20curl%20http%3A%2F%2Flocalhost%3A7001%2Fsearch%3Fq%3Dnode.js%0A%60%60%60%0A%0A%23%23%23%20Using%20Middleware%0A%0AA%20middleware%20can%20be%20used%20to%20change%20the%20request%20parameter%20to%20uppercase.%0AHere%20we%20just%20briefly%20explain%20how%20to%20use%20the%20middleware%2C%20and%20refer%20to%20%5BMiddleware%5D(.%2Fmiddleware.md)%20for%20detail.%0A%0A%60%60%60js%0A%2F%2F%20app%2Fcontroller%2Fsearch.js%0Aexports.index%20%3D%20async%20ctx%20%3D%3E%20%7B%0A%20%20ctx.body%20%3D%20%60search%3A%20%24%7Bctx.query.name%7D%60%3B%0A%7D%3B%0A%0A%2F%2F%20app%2Fmiddleware%2Fuppercase.js%0Amodule.exports%20%3D%20()%20%3D%3E%20%7B%0A%20%20return%20async%20function%20uppercase(ctx%2C%20next)%20%7B%0A%20%20%20%20ctx.query.name%20%3D%20ctx.query.name%20%26%26%20ctx.query.name.toUpperCase()%3B%0A%20%20%20%20await%20next()%3B%0A%20%20%7D%3B%0A%7D%3B%0A%0A%2F%2F%20app%2Frouter.js%0Amodule.exports%20%3D%20app%20%3D%3E%20%7B%0A%20%20app.router.get('s'%2C%20'%2Fsearch'%2C%20app.middlewares.uppercase()%2C%20app.controller.search)%0A%7D%3B%0A%0A%2F%2F%20curl%20http%3A%2F%2Flocalhost%3A7001%2Fsearch%3Fname%3Degg%0A%60%60%60%0A%0A%23%23%23%20Too%20Many%20Routing%20Maps%3F%0A%0AAs%20described%20above%2C%20we%20do%20not%20recommend%20that%20you%20scatter%20routing%20logics%20all%20around%2C%20or%20it%20will%20bring%20trouble%20in%20trouble%20shooting.%0A%0AIf%20there%20is%20a%20need%20for%20some%20reasons%2C%20you%20can%20split%20routing%20rules%20like%20below%3A%0A%0A%60%60%60js%0A%2F%2F%20app%2Frouter.js%0Amodule.exports%20%3D%20app%20%3D%3E%20%7B%0A%20%20require('.%2Frouter%2Fnews')(app)%3B%0A%20%20require('.%2Frouter%2Fadmin')(app)%3B%0A%7D%3B%0A%0A%2F%2F%20app%2Frouter%2Fnews.js%0Amodule.exports%20%3D%20app%20%3D%3E%20%7B%0A%20%20app.router.get('%2Fnews%2Flist'%2C%20app.controller.news.list)%3B%0A%20%20app.router.get('%2Fnews%2Fdetail'%2C%20app.controller.news.detail)%3B%0A%7D%3B%0A%0A%2F%2F%20app%2Frouter%2Fadmin.js%0Amodule.exports%20%3D%20app%20%3D%3E%20%7B%0A%20%20app.router.get('%2Fadmin%2Fuser'%2C%20app.controller.admin.user)%3B%0A%20%20app.router.get('%2Fadmin%2Flog'%2C%20app.controller.admin.log)%3B%0A%7D%3B%0A%60%60%60%0A%0Aor%20using%20%5Begg-router-plus%5D(https%3A%2F%2Fgithub.com%2Feggjs%2Fegg-router-plus).%0A"}}</script><script type="text/javascript" src="/static/js/post.b9faab88.js"></script></body></html>