<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="theme-color" content="#000000"><link rel="manifest" href="/manifest.json"><link rel="shortcut icon" href="/favicon.png"><style class="_styletron_hydrate_"></style><title>HttpClient</title><meta name="description" content="Born to build better enterprise frameworks and apps"><link href="/static/css/post.d62265dc.css" rel="stylesheet"></head><body><noscript>You need to enable JavaScript to run this app.</noscript><div id="root"><div class="ant-layout" data-reactroot=""><div class="header-module__header___3ADJ9 ant-layout-header"><div class="ant-row-flex"><div class="ant-col-xs-12 ant-col-md-20 ant-col-lg-2"><div class="header-module__logo___3yTXp"><a href="/"><img src="/logo.svg" alt="logo"/></a></div></div><div class="ant-col-xs-0 ant-col-md-0 ant-col-lg-20"><ul class="ant-menu header-module__menu___3yEtW ant-menu-light ant-menu-root ant-menu-horizontal" role="menu"><li class="ant-menu-item" role="menuitem"><a href="/en/intro/">Guide</a></li><li class="ant-menu-item" role="menuitem"><a href="/api/">API</a></li><li class="ant-menu-item" role="menuitem"><a href="/en/tutorials/index.html">Tutorials</a></li><li class="ant-menu-item" role="menuitem"><a href="https://github.com/search?q=topic%3Aegg-plugin&amp;type=Repositories">Plugins</a></li><li class="ant-menu-item" role="menuitem"><a href="https://github.com/eggjs/egg/releases">Release</a></li></ul></div><div style="text-align:right" class="ant-col-xs-12 ant-col-md-4 ant-col-lg-2"><button type="button" class="ant-btn"><span>切换语言</span></button></div></div></div><div class="ant-layout-content"><div class="basic_layout-module__content___3flpY ant-layout"><div class="sider-module__side___1Cadj ant-layout-sider ant-layout-sider-light" style="flex:0 0 200px;max-width:200px;min-width:200px;width:200px"><div class="ant-layout-sider-children"><ul class="ant-menu sider-module__menu___2GqPr ant-menu-light ant-menu-root ant-menu-inline" role="menu"><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="0$Menu" aria-haspopup="true"><span>Guide</span><i class="ant-menu-submenu-arrow"></i></div><ul id="0$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/intro/index.html">What is Egg?</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/intro/egg-and-koa.html">Egg and Koa</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/intro/quickstart.html">Quick Start</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/progressive.html">Progressive</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/migration.html">Migration to 2.x</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="1$Menu" aria-haspopup="true"><span>Basis Function</span><i class="ant-menu-submenu-arrow"></i></div><ul id="1$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/structure.html">Directory Structure</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/objects.html">Built-in Objects</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/env.html">Environment</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/config.html">Configuration</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/middleware.html">Middleware</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/router.html">Router</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/controller.html">Controller</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/service.html">Service</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/plugin.html">Plugin</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/schedule.html">Schedule</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/extend.html">Extend</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/basics/app-start.html">Custom Init</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="2$Menu" aria-haspopup="true"><span>Core</span><i class="ant-menu-submenu-arrow"></i></div><ul id="2$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/development.html">Development</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/unittest.html">Unit Testing</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/deployment.html">Deployment</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/logger.html">Logger</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/httpclient.html">HttpClient</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/cookie-and-session.html">Cookie and Session</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/cluster-and-ipc.html">Cluster and IPC</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/view.html">View</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/error-handling.html">Error Handling</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/security.html">Security</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/core/i18n.html">i18n</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="3$Menu" aria-haspopup="true"><span>Tutorials</span><i class="ant-menu-submenu-arrow"></i></div><ul id="3$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/mysql.html">MySQL</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/restful.html">RESTful API</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/passport.html">Passport</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/socketio.html">Socket.IO</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/assets.html">Assets</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/tutorials/typescript.html">TypeScript</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="4$Menu" aria-haspopup="true"><span>Advanced</span><i class="ant-menu-submenu-arrow"></i></div><ul id="4$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/advanced/loader.html">Loader</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/advanced/plugin.html">Plugin Development</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/advanced/framework.html">Framework</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/advanced/cluster-client.html">Cluster Enhancement</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/advanced/view-plugin.html">View Plugin</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/style-guide.html">Style Guide</a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:24px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="5$Menu" aria-haspopup="true"><span>Community</span><i class="ant-menu-submenu-arrow"></i></div><ul id="5$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/plugins/">Plugin List</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/contributing.html">Contributing</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/resource.html">Resource</a></li><li class="ant-menu-item" role="menuitem" style="padding-left:48px"><a href="/en/faq.html">FAQ</a></li></ul></li></ul></div></div><div class="basic_layout-module__post___2Z7KK ant-layout-content"><div class="ant-row" style="margin-left:-8px;margin-right:-8px"><div style="padding-left:8px;padding-right:8px" class="ant-col-xs-24 ant-col-md-18"><div class="markdown-body" style="font-size:14px"><div><p>Countless services rely on the HTTP-based communication nowadays, and it is a very common application scenario that web applications call back-end HTTP services.</p><p>The framework built in <a href="https://github.com/eggjs/egg/blob/master/lib/core/httpclient.js">HttpClient</a> based on <a href="https://github.com/node-modules/urllib">urllib</a>, you can quickly complete any HTTP request.</p><h2 id="using-httpclient-by-app">Using HttpClient by app</h2><p><a href="https://github.com/eggjs/egg/blob/master/lib/core/httpclient.js">HttpClient</a> will initialize to <code>app.httpclient</code> automatically during the application&#x27;s initialization.
Also added an method <code>app.curl(url, options)</code>, which is equivalent to the <code>app.httpclient.request(url, options)</code>.</p><p>So you can easily use <code>app.curl</code> to complete a HTTP request.</p><pre><code class="language-js">// app.js
module.exports = app =&gt; {
  app.beforeStart(async () =&gt; {
    // example: read the version info on https://registry.npm.taobao.org/egg/latest when it starts
    const result = await app.curl(&#x27;https://registry.npm.taobao.org/egg/latest&#x27;, {
      dataType: &#x27;json&#x27;,
    });
    app.logger.info(&#x27;Egg latest version: %s&#x27;, result.data.version);
  });
};</code></pre><h2 id="using-httpclient-by-context">Using HttpClient by Context</h2><p>Framework also provides <code>ctx.curl(url, options)</code> and <code>ctx.httpclient</code> in Context, same as app.
So it&#x27;s very easy to use <code>ctx.curl()</code> to complete a HTTP request in the Context (such as in the controller)</p><pre><code class="language-js">// app/controller/npm.js
class NpmController extends Controller {
  async index() {
    const ctx = this.ctx;

    // example: request a npm module&#x27;s info
    const result = await ctx.curl(&#x27;https://registry.npm.taobao.org/egg/latest&#x27;, {
      // parse JSON response
      dataType: &#x27;json&#x27;,
      // timeout of 3s
      timeout: 3000,
    });

    ctx.body = {
      status: result.status,
      headers: result.headers,
      package: result.data,
    };
  }
}</code></pre><h2 id="basic-http-request">Basic HTTP Request</h2><p>HTTP has been widely used and have several methods to make request, but the methods are similar. We start with the basic four request methods then move to some more complex scenario.</p><p>In the following example, we will complete the request of <a href="https://httpbin.org">https://httpbin.org</a> in the controller.</p><h3 id="get">GET</h3><p>Reading data almost uses GET request. It is the most common type and widely used in the world of HTTP. And it is also easier to construct a request parameter.</p><pre><code class="language-js">// app/controller/npm.js
class NpmController extends Controller {
  async get() {
    const ctx = this.ctx;
    const result = await ctx.curl(&#x27;https://httpbin.org/get?foo=bar&#x27;);
    ctx.status = result.status;
    ctx.set(result.headers);
    ctx.body = result.data;
  }
}</code></pre><ul><li>GET request might not need to set <code>options.method</code>. HttpClient Defalut method is set to <code>GET</code></li><li>Return <code>result</code> will contains 3 attributes: <code>status</code>, <code>headers</code> and <code>data</code><ul><li><code>status</code>: response status，for example <code>200</code>, <code>302</code>, <code>404</code>, <code>500</code> and etc</li><li><code>headers</code>: response header，similar to <code>{ &#x27;content-type&#x27;: &#x27;text/html&#x27;, ... }</code></li><li><code>data</code>: response body，default HttpClient doesn&#x27;t do anything and returns as Buffer directly.
Once the <code>options.dataType</code> is set，HttpClient will process the <code>data</code> based on the parameters</li></ul></li></ul><p>For the complete request parameter <code>options</code> and return value <code>result</code>, refer to below section <a href="#options-parameters-in-detail">options Parameters in Detail</a></p><h3 id="post">POST</h3><p>The scenario of creating data generally uses the POST request with body parameter, one more parameter compared to GET.</p><p>Take sending JSON boy as example:</p><pre><code class="language-js">// app/controller/npm.js
class NpmController extends Controller {
  async post() {
    const ctx = this.ctx;
    const result = await ctx.curl(&#x27;https://httpbin.org/post&#x27;, {
      // method is required
      method: &#x27;POST&#x27;,
      // telling HttpClient to send data as JSON by contentType
      contentType: &#x27;json&#x27;,
      data: {
        hello: &#x27;world&#x27;,
        now: Date.now(),
      },
      // telling HttpClient to process the return body as JSON format explicitly
      dataType: &#x27;json&#x27;,
    });
    ctx.body = result.data;
  }
}</code></pre><p>The following will explain POST to achieve Form function of form submission and file upload in detail.</p><h3 id="put">PUT</h3><p>Similar to POST, but PUT is better for data updating and replacement. Almost the same parameters as POST except setting method as <code>PUT</code>.</p><pre><code class="language-js">// app/controller/npm.js
class NpmController extends Controller {
  async put() {
    const ctx = this.ctx;
    const result = await ctx.curl(&#x27;https://httpbin.org/put&#x27;, {
      // method is required
      method: &#x27;PUT&#x27;,
       // telling HttpClient to send data as JSON by contentType
      contentType: &#x27;json&#x27;,
      data: {
        update: &#x27;foo bar&#x27;,
      },
      // telling HttpClient to process the return body as JSON format explicitly
      dataType: &#x27;json&#x27;,
    });
    ctx.body = result.data;
  }
}</code></pre><h3 id="delete">DELETE</h3><p>DELETE request is to delete the data, request body don&#x27;t need to add request body but HttpClient don&#x27;t have the limitation.</p><pre><code class="language-js">// app/controller/npm.js
class NpmController extends Controller {
  async del() {
    const ctx = this.ctx;
    const result = await ctx.curl(&#x27;https://httpbin.org/delete&#x27;, {
      // method is required
      method: &#x27;DELETE&#x27;,
      // telling HttpClient to process the return body as JSON format explicitly
      dataType: &#x27;json&#x27;,
    });
    ctx.body = result.data;
  }
}</code></pre><h2 id="advanced-http-request">Advanced HTTP request</h2><p>In some real application scenarios, still have some more complex HTTP requests.</p><h3 id="form-submission">Form Submission</h3><p>Interfaces of Browser-Oriented Form Submission (without files), usually require <code>content-type: application/x-www-form-urlencoded</code> for the data requesting.</p><pre><code class="language-js">// app/controller/npm.js
class NpmController extends Controller {
  async submit() {
    const ctx = this.ctx;
    const result = await ctx.curl(&#x27;https://httpbin.org/post&#x27;, {
      // method is required, supports POST，PUT and DELETE
      method: &#x27;POST&#x27;,
      // contentType is not needed, by default HttpClient will send request in application/x-www-form-urlencoded
      data: {
        now: Date.now(),
        foo: &#x27;bar&#x27;,
      },
      // telling HttpClient to process the return body as JSON format explicitly
      dataType: &#x27;json&#x27;,
    });
    ctx.body = result.data.form;
    // final response will similar as below:
    // {
    //   &quot;foo&quot;: &quot;bar&quot;,
    //   &quot;now&quot;: &quot;1483864184348&quot;
    // }
  }
}</code></pre><h3 id="uploading-files-by-multipart">Uploading Files by Multipart</h3><p>Once form submission contains files, submission of requesting data must be <a href="http://tools.ietf.org/html/rfc2388">multipart/form-data</a>
We need to introduce third party module <a href="https://github.com/node-modules/formstream">formstream</a> to generate <code>form</code> objects that can be consumed by HttpClient.</p><pre><code class="language-js">// app/controller/npm.js
const FormStream = require(&#x27;formstream&#x27;);
class NpmController extends Controller {
  async upload() {
    const ctx = this.ctx;
    const form = new FormStream();
    // set normal field and value
    form.field(&#x27;foo&#x27;, &#x27;bar&#x27;);
    // uploading the current file for test propose
    form.file(&#x27;file&#x27;, __filename);

    const result = await ctx.curl(&#x27;https://httpbin.org/post&#x27;, {
     // method is required, supports POST，PUT
      method: &#x27;POST&#x27;,
      // generate request headers following the requirements of multipart/form-data
      headers: form.headers(),
      // submitted as stream mode
      stream: form,
      // telling HttpClient to process the return body as JSON format explicitly
      dataType: &#x27;json&#x27;,
    });
    ctx.body = result.data.files;
    // final response will similar as below:
    // {
    //   &quot;file&quot;: &quot;&#x27;use strict&#x27;;\n\nconst For....&quot;
    // }
  }
}</code></pre><p>Of course, you can add more files to achieve the requirements of upload multiple files at one time by <code>form.file()</code></p><pre><code class="language-js">form.file(&#x27;file1&#x27;, file1);
form.file(&#x27;file2&#x27;, file2);</code></pre><h3 id="uploading-files-in-stream-mode">Uploading files in Stream Mode</h3><p>In fact, Stream is the leading in the world of Node.js.
If the server supports streaming, the most friendly way is to send the Stream directly. Actually, Stream will be sent in <code>Transfer-Encoding: chunked</code> transmission coding format, which is implemented by <a href="https://nodejs.org/api/http.html">HTTP</a> module automatically.</p><pre><code class="language-js">// app/controller/npm.js
const fs = require(&#x27;fs&#x27;);
const FormStream = require(&#x27;formstream&#x27;);
class NpmController extends Controller {
  async uploadByStream() {
    const ctx = this.ctx;
    // uploading the current file for test propose
    const fileStream = fs.createReadStream(__filename);
     // httpbin.org not support stream mode, use the local stream interface instead
    const url = `${ctx.protocol}://${ctx.host}/stream`;
    const result = await ctx.curl(url, {
      // method is required, supports POST，PUT
      method: &#x27;POST&#x27;,
      // submitted by stream mode
      stream: fileStream,
    });
    ctx.status = result.status;
    ctx.set(result.headers);
    ctx.body = result.data;
    // final response will similar as below:
    // {&quot;streamSize&quot;:574}
  }
}</code></pre><h2 id="options-parameters-in-detail">options Parameters in Detail</h2><p>Due to the complexity of HTTP Request, the options parameters of <code>httpclient.request(url, options)</code> quite large. The actual usage of each optional parameter will be shown with descriptions and coding as below.</p><h3 id="default-httpclient-global-configuration">Default HttpClient Global Configuration</h3><pre><code class="language-js">// config/config.default.js
exports.httpclient = {
  // whether to enable local DNS cache, default disable, enable will have two characteristics
  // 1. All DNS lookup will prefer to use the cache by default, even DNS query error does not affects the application
  // 2. For the same hostname, query only once during the interval of dnsCacheLookupInterval (default 10s)
  enableDNSCache: false,
  // minimum interval of DNS query on the same hostname
  dnsCacheLookupInterval: 10000,
  // maximum number of hostname DNS cache simultaneously, default 1000
  dnsCacheMaxLength: 1000,

  request: {
    // default timeout of request
    timeout: 3000,
  },

  httpAgent: {
    // default enable http KeepAlive
    keepAlive: true,
    // idle KeepAlive socket can survive for 4 seconds
    freeSocketKeepAliveTimeout: 4000,
    // when sockets have no activity for more than 30s, it will be processed as timeout
    timeout: 30000,
    // maximum number of sockets allow to be created
    maxSockets: Number.MAX_SAFE_INTEGER,
    // maximum number of idle sockets
    maxFreeSockets: 256,
  },

  httpsAgent: {
    // default enable https KeepAlive
    keepAlive: true,
    // idle KeepAlive socket can survive for 4 seconds
    freeSocketKeepAliveTimeout: 4000,
    // when sockets have no activity for more than 30s, it will be processed as timeout
    timeout: 30000,
    // maximum number of sockets allow to be created
    maxSockets: Number.MAX_SAFE_INTEGER,
    // maximum number of idle sockets
    maxFreeSockets: 256,
  },
};</code></pre><p>Application can overrides the configuration by <code>config/config.default.js</code></p><h3 id="data-object"><code>data: Object</code></h3><p>The request data will select the correct processing method automatically based on the <code>method</code>.</p><ul><li>GET，HEAD: processed by <code>querystring.stringify(data)</code> then append to the query parameters of url.</li><li>POST，PUT, DELETE and etc: further judgments and process according to <code>contentType</code>.<ul><li><code>contentType = json</code>: processed by <code>JSON.stringify(data)</code> and set it as body before sending.</li><li>others: processed by <code>querystring.stringify(data)</code> and set it as body before sending</li></ul></li></ul><pre><code class="language-js">// GET + data
ctx.curl(url, {
  data: { foo: &#x27;bar&#x27; },
});

// POST + data
ctx.curl(url, {
  method: &#x27;POST&#x27;,
  data: { foo: &#x27;bar&#x27; },
});

// POST + JSON + data
ctx.curl(url, {
  method: &#x27;POST&#x27;,
  contentType: &#x27;json&#x27;,
  data: { foo: &#x27;bar&#x27; },
});</code></pre><h3 id="dataasquerystring-boolean"><code>dataAsQueryString: Boolean</code></h3><p>Once <code>dataAsQueryString=true</code> is set, even under POST, it will forces <code>options.data</code> to be processed by <code>querystring.stringify</code> then append to the <code>url</code> query parameters</p><p>The application scenarios that sending data using <code>stream</code> and pass additional request parameters by <code>url</code> query can be well resolved.</p><pre><code class="language-js">ctx.curl(url, {
  method: &#x27;POST&#x27;,
  dataAsQueryString: true,
  data: {
    // generally it would be some validation parameters such as access token, etc.
    accessToken: &#x27;some access token value&#x27;,
  },
  stream: myFileStream,
});</code></pre><h3 id="content-stringbuffer"><code>content: String|Buffer</code></h3><p>Set request Context, if the parameter is set, it will ignore the <code>data</code> parameters</p><pre><code class="language-js">ctx.curl(url, {
  method: &#x27;POST&#x27;,
  // Sending the raw xml data without HttpClient&#x27;s to do processing
  content: &#x27;&lt;xml&gt;&lt;hello&gt;world&lt;/hello&gt;&lt;/xml&gt;&#x27;,
  headers: {
    &#x27;content-type&#x27;: &#x27;text/html&#x27;,
  },
});</code></pre><h3 id="stream-readstream"><code>stream: ReadStream</code></h3><p>Set request context&#x27;s readable stream, default <code>null</code>.
If the parameter is set , HttpClient will ignore <code>data</code> and <code>content</code></p><pre><code class="language-js">ctx.curl(url, {
  method: &#x27;POST&#x27;,
  stream: fs.createReadStream(&#x27;/path/to/read&#x27;),
});</code></pre><h3 id="writestream-writestream"><code>writeStream: WriteStream</code></h3><p>Set receive response data&#x27;s writeable stream, default <code>null</code>.
Once the parameter is set, response <code>result.data</code> is set to <code>null</code> because all data are written to <code>writeStream</code>.</p><pre><code class="language-js">ctx.curl(url, {
  writeStream: fs.createWriteStream(&#x27;/path/to/store&#x27;),
});</code></pre><h3 id="consumewritestream-boolean"><code>consumeWriteStream: Boolean</code></h3><p>Whether to wait for <code>writeStream</code> completely finished as the response well received
This parameter is not recommended to modify the default value, unless we know it&#x27;s side effect are acceptable. Otherwise, the <code>writeStream</code> data is likely to be incomplete.</p><h3 id="method-string"><code>method: String</code></h3><p>Set request method, default <code>GET</code>. Support all <code>GET、POST、PUT、DELETE、PATCH</code> and so on <a href="https://nodejs.org/api/http.html#http_http_methods">all HTTP methods</a>。</p><h3 id="contenttype-string"><code>contentType: String</code></h3><p>Set request data format ，default <code>undefined</code>，HttpClient will sets automatically based on the <code>data</code> and <code>content</code> parameters.
When <code>data</code> is object, the default setting would be <code>form</code>. Support <code>json</code> format.</p><p>If need to send <code>data</code> by JSON</p><pre><code class="language-js">ctx.curl(url, {
  method: &#x27;POST&#x27;,
  data: {
    foo: &#x27;bar&#x27;,
    now: Date.now(),
  },
  contentType: &#x27;json&#x27;,
});</code></pre><h3 id="datatype-string"><code>dataType: String</code></h3><p>Set the response data format, default return the raw buffer formatted data without processing. Support <code>text</code> and <code>json</code></p><p><strong>Note: If <code>json</code> is set，a <code>JSONResponseFormatError</code>  error would be thrown if fails to parse the response data.</strong></p><pre><code class="language-js">const jsonResult = await ctx.curl(url, {
  dataType: &#x27;json&#x27;,
});
console.log(jsonResult.data);

const htmlResult = await ctx.curl(url, {
  dataType: &#x27;text&#x27;,
});
console.log(htmlResult.data);</code></pre><h3 id="fixjsonctlchars-boolean"><code>fixJSONCtlChars: Boolean</code></h3><p>Whether filter the special control characters in the response data (U+0000 ~ U+001F)，default <code>false</code>
Typically, the JSON data returned by some CGI system might contains such special control characters, which can be filter automatically by setting the parameters.</p><pre><code class="language-js">ctx.curl(url, {
  fixJSONCtlChars: true,
  dataType: &#x27;json&#x27;,
});</code></pre><h3 id="headers-object"><code>headers: Object</code></h3><p>Custom request headers</p><pre><code class="language-js">ctx.curl(url, {
  headers: {
    &#x27;x-foo&#x27;: &#x27;bar&#x27;,
  },
});</code></pre><h3 id="timeout-numberarray"><code>timeout: Number|Array</code></h3><p>Timeout of request, default <code>[ 5000, 5000 ]</code>, timeout of connection creation is 5s, and the timeout of receive response is 5s.</p><pre><code class="language-js">ctx.curl(url, {
  // 3s timeout of connection creation, and the 3s timeout of receive response
  timeout: 3000,
});

ctx.curl(url, {
  // 1s timeout of connection creation, and the 30s timeout of receive response for the responsing of larger scenarios
  timeout: [ 1000, 30000 ],
});</code></pre><h3 id="agent-httpagent"><code>agent: HttpAgent</code></h3><p>Allows to override the default HttpAgent through this parameter. If you don&#x27;t want to enable KeepAlive, set this parameter to <code>false</code>.</p><pre><code class="language-js">ctx.curl(url, {
  agent: false,
});</code></pre><h3 id="httpsagent-httpsagent"><code>httpsAgent: HttpsAgent</code></h3><p>Allows to override the default HttpsAgent through this parameter. If you don&#x27;t want to enable KeepAlive, set this parameter to <code>false</code>.</p><pre><code class="language-js">ctx.curl(url, {
  httpsAgent: false,
});</code></pre><h3 id="auth-string"><code>auth: String</code></h3><p>Parameter of Simple login authorization (Basic Authentication), will send the login information to the <code>Authorization</code> request in clear form.</p><pre><code class="language-js">ctx.curl(url, {
  // parameter must follow the format of `user:password`
  auth: &#x27;foo:bar&#x27;,
});</code></pre><h3 id="digestauth-string"><code>digestAuth: String</code></h3><p>Parameter of the Digest Authentication. If the parameter is set, it will attempt to generate the <code>Authorization</code> request header for the 401 response automatically then try requesting for authorization once.</p><pre><code class="language-js">ctx.curl(url, {
  // parameter must follow the format of `user:password`
  digestAuth: &#x27;foo:bar&#x27;,
});</code></pre><h3 id="followredirect-boolean"><code>followRedirect: Boolean</code></h3><p>Whether to follow 3xx redirect response, default <code>false</code></p><pre><code class="language-js">ctx.curl(url, {
  followRedirect: true,
});</code></pre><h3 id="maxredirects-number"><code>maxRedirects: Number</code></h3><p>Set the maximum number of automatic redirects to prevent the endless redirect loop, default 10 times.
The parameter should not be set too large and only works in the <code>followRedirect=true</code></p><pre><code class="language-js">ctx.curl(url, {
  followRedirect: true,
  // maximum allowed redirect 5 times
  maxRedirects: 5,
});</code></pre><h3 id="formatredirecturl-functionfrom-to"><code>formatRedirectUrl: Function(from, to)</code></h3><p><code>formatRedirectUrl</code> allow us to customize the implementation of 302、301 other redirect URL splicing, default <code>url.resolve (from, to)</code>.</p><pre><code class="language-js">ctx.curl(url, {
  formatRedirectUrl: (from, to) =&gt; {
    // for example you can correct the redirection of wrong url here
    if (to === &#x27;//foo/&#x27;) {
      to = &#x27;/foo&#x27;;
    }
    return url.resolve(from, to);
  },
});</code></pre><h3 id="beforerequest-functionoptions"><code>beforeRequest: Function(options)</code></h3><p>HttpClient will attempt to invoke the <code>beforeRequest</code> hook before requesting officially, allowing us to make the last modification of the request parameter here.</p><pre><code class="language-js">ctx.curl(url, {
  beforeRequest: options =&gt; {
    // For example, we can set the global request ID to facilitate log tracking
    options.headers[&#x27;x-request-id&#x27;] = uuid.v1();
  },
});</code></pre><h3 id="streaming-boolean"><code>streaming: Boolean</code></h3><p>Whether to return the response stream directly, default <code>false</code>
After enable streaming, HttpClient will return immediately after getting the response object res,
At this moment <code>result.headers</code> and <code>result.status</code> can be read, but still cannot read the data</p><pre><code class="language-js">const result = await ctx.curl(url, {
  streaming: true,
});

console.log(result.status, result.data);
// result.res is a ReadStream Object
ctx.body = result.res;</code></pre><p><strong>if res is not passed to body directly, then we must consume this stream and do well in error handling.</strong></p><h3 id="gzip-boolean"><code>gzip: Boolean</code></h3><p>Whether to support gzip response format, default <code>false</code>
After enable gzip, HttpClient will set <code>Accept-Encoding: gzip</code> header and extract the data with <code>Content-Encoding: gzip</code> response header automatically.</p><pre><code class="language-js">ctx.curl(url, {
  gzip: true,
});</code></pre><h3 id="timing-boolean"><code>timing: Boolean</code></h3><p>Whether to enable the time measurement for each phase, default <code>false</code>
After enable the timing, you can get the time measurements of HTTP request (in milliseconds) from the <code>result.res.timing</code>.
Through these measurements, we can easily locate the slowest environment in the request, similar to the Chrome network timing.</p><p>Measurement timing&#x27;s analysis of each stage:</p><ul><li>queuing: allocating socket time consuming</li><li>dnslookup: DNS queries time consuming</li><li>connected: socket three handshake success time consuming</li><li>requestSent: requesting full data time consuming</li><li>waiting: first byte to received response time consuming</li><li>contentDownload: full response data time consuming</li></ul><pre><code class="language-js">const result = await ctx.curl(url, {
  timing: true,
});
console.log(result.res.timing);
// {
//   &quot;queuing&quot;:29,
//   &quot;dnslookup&quot;:37,
//   &quot;connected&quot;:370,
//   &quot;requestSent&quot;:1001,
//   &quot;waiting&quot;:1833,
//   &quot;contentDownload&quot;:3416
// }</code></pre><h3 id="carejectunauthorizedpfxkeycertpassphrasecipherssecureprotocol"><code>ca，rejectUnauthorized，pfx，key，cert，passphrase，ciphers，secureProtocol</code></h3><p>These are parameters are passed to the  <a href="https://nodejs.org/api/https.html">HTTPS</a> modules，details refer to <a href="https://nodejs.org/api/https.html#https_https_request_options_callback"><code>https.request(options, callback)</code></a>。</p><h2 id="debugging-aid">Debugging Aid</h2><p>Framework provides <a href="https://github.com/eggjs/egg-development-proxyagent">egg-development-proxyagent</a> plugin to help developers to debug.</p><p>Install and enable pulgin:</p><pre><code class="language-bash">$ npm i egg-development-proxyagent --save</code></pre><pre><code class="language-js">// config/plugin.js
exports.proxyagent = {
  enable: true,
  package: &#x27;egg-development-proxyagent&#x27;,
}</code></pre><p>Open capture tools, we can use <a href="https://www.charlesproxy.com/">charles</a> or <a href="http://www.telerik.com/fiddler">fiddler</a>, here we take to <a href="https://github.com/alibaba/anyproxy">anyproxy</a> demonstrate</p><pre><code class="language-bash">$ npm install anyproxy -g
$ anyproxy --port 8888</code></pre><p>Starting application using environment variables:</p><pre><code class="language-bash">$ http_proxy=http://127.0.0.1:8888 npm run dev</code></pre><p>Then it works correctly, and all requests that go through HttpClient can be viewed in the consle of <a href="http://localhost:8002">http://localhost:8002</a>.</p><p><img alt="anyproxy" src="https://cloud.githubusercontent.com/assets/227713/21976937/06a63694-dc0f-11e6-98b5-e9e279c4867c.png"/></p><p><strong>Note: the pulgin only start in local environments by defalut</strong></p><h2 id="known-issues">Known issues</h2><h3 id="connection-timeout">Connection Timeout</h3><ul><li>Exception: <code>ConnectionTimeoutError</code></li><li>Scene: usually occurred by the DNS query is slow, or the network is slow between the client and server</li><li>Troubleshooting Suggestion: increase the <code>timeout</code> parameter appropriately.</li></ul><h3 id="service-response-timeout">Service Response Timeout</h3><ul><li>Exception: <code>ResponseTimeoutError</code></li><li>Scene: usually occurred by network is slower between the client and server, and happens when the data is relatively large.</li><li>Troubleshooting Suggestion: increase the <code>timeout</code> parameter appropriately.</li></ul><h3 id="service-disconnect">Service Disconnect</h3><ul><li>Exception: <code>ResponseError, code: ECONNRESET</code></li><li>Scene: usually the server actively disconnects the socket connection, causing the HTTP request link exceptions.</li><li>Troubleshooting Suggestion: please check if server has network exception at that time</li></ul><h3 id="service-is-unreachable">Service is unreachable</h3><ul><li>Exception: <code>RequestError, code: ECONNREFUSED, status: -1</code></li><li>Scene: usually because the requested URL which attached IP or the port cannot connect successfully.</li><li>Troubleshooting Suggestion: make sure the IP or port is set correctly</li></ul><h3 id="domain-name-is-not-existing">Domain name is not existing</h3><ul><li>Exception: <code>RequestError, code: ENOTFOUND, status: -1</code></li><li>Scene: usually the domain name requested by URL cannot be resolved by DNS successfully.</li><li>Troubleshooting Suggestion: make sure the domain name exists, and also check to see if the DNS service is properly configured.</li></ul><h3 id="json-response-data-format-error">JSON Response data format error</h3><ul><li>Exception: <code>JSONResponseFormatError</code></li><li>scene: the <code>dataType=json</code> is set and this exception is thrown in response data that does not match JSON format.</li><li>Troubleshooting Suggestion: make sure that the server no matter what situations are returns the data in JSON format correctly.</li></ul><h2 id="global-request-and-response-events">Global <code>request</code> and <code>response</code> events</h2><p>In enterprise application scenarios, generally a unified tracer log is needed.
To facilitate monitoring HttpClient requests and responses on the app level, we agreed on global <code>request</code> and <code>response</code> to expose these two events.</p><pre><code class="language-bash">    init options
        |
        V
    emit `request` event
        |
        V
    send request and receive response
        |
        V
    emit `response` event
        |
        V
       end</code></pre><h3 id="request-event-occurs-before-the-network-operation"><code>request</code> event occurs before the network operation</h3><p>A <code>request</code> event is triggered before the request is sent, allowing blocking of the request.</p><pre><code class="language-js">app.httpclient.on(&#x27;request&#x27;, req =&gt; {
  req.url //request url
  req.ctx //context of the request

  // you can set some trace headers here for full link tracking propose
});</code></pre><h3 id="response-event-occurs-after-the-end-of-network-operation"><code>response</code> event occurs after the end of network operation</h3><p>After the end of request, a <code>response</code> event is triggered, so that the external event can be subscribed to the log printing.</p><pre><code class="language-js">app.httpclient.on(&#x27;response&#x27;, result =&gt; {
  result.res.status
  result.ctx //context of the request
  result.req //the corresponding req object, which the req in the request event

});</code></pre><h2 id="example">Example</h2><p>Full examples can be found on <a href="https://github.com/eggjs/examples/blob/master/httpclient">eggjs/exmaples/httpclient</a> .</p></div></div></div><div style="padding-left:8px;padding-right:8px" class="ant-col-xs-0 ant-col-md-6"><div class="markdown-body" style="font-size:14px"><div><ul><li><a href="#using-httpclient-by-app">Using HttpClient by app</a></li><li><a href="#using-httpclient-by-context">Using HttpClient by Context</a></li><li><a href="#basic-http-request">Basic HTTP Request</a><ul><li><a href="#get">GET</a></li><li><a href="#post">POST</a></li><li><a href="#put">PUT</a></li><li><a href="#delete">DELETE</a></li></ul></li><li><a href="#advanced-http-request">Advanced HTTP request</a><ul><li><a href="#form-submission">Form Submission</a></li><li><a href="#uploading-files-by-multipart">Uploading Files by Multipart</a></li><li><a href="#uploading-files-in-stream-mode">Uploading files in Stream Mode</a></li></ul></li><li><a href="#options-parameters-in-detail">options Parameters in Detail</a><ul><li><a href="#default-httpclient-global-configuration">Default HttpClient Global Configuration</a></li><li><a href="#data-object"><code>data: Object</code></a></li><li><a href="#dataasquerystring-boolean"><code>dataAsQueryString: Boolean</code></a></li><li><a href="#content-stringbuffer"><code>content: String|Buffer</code></a></li><li><a href="#stream-readstream"><code>stream: ReadStream</code></a></li><li><a href="#writestream-writestream"><code>writeStream: WriteStream</code></a></li><li><a href="#consumewritestream-boolean"><code>consumeWriteStream: Boolean</code></a></li><li><a href="#method-string"><code>method: String</code></a></li><li><a href="#contenttype-string"><code>contentType: String</code></a></li><li><a href="#datatype-string"><code>dataType: String</code></a></li><li><a href="#fixjsonctlchars-boolean"><code>fixJSONCtlChars: Boolean</code></a></li><li><a href="#headers-object"><code>headers: Object</code></a></li><li><a href="#timeout-numberarray"><code>timeout: Number|Array</code></a></li><li><a href="#agent-httpagent"><code>agent: HttpAgent</code></a></li><li><a href="#httpsagent-httpsagent"><code>httpsAgent: HttpsAgent</code></a></li><li><a href="#auth-string"><code>auth: String</code></a></li><li><a href="#digestauth-string"><code>digestAuth: String</code></a></li><li><a href="#followredirect-boolean"><code>followRedirect: Boolean</code></a></li><li><a href="#maxredirects-number"><code>maxRedirects: Number</code></a></li><li><a href="#formatredirecturl-functionfrom-to"><code>formatRedirectUrl: Function(from, to)</code></a></li><li><a href="#beforerequest-functionoptions"><code>beforeRequest: Function(options)</code></a></li><li><a href="#streaming-boolean"><code>streaming: Boolean</code></a></li><li><a href="#gzip-boolean"><code>gzip: Boolean</code></a></li><li><a href="#timing-boolean"><code>timing: Boolean</code></a></li><li><a href="#carejectunauthorizedpfxkeycertpassphrasecipherssecureprotocol"><code>ca，rejectUnauthorized，pfx，key，cert，passphrase，ciphers，secureProtocol</code></a></li></ul></li><li><a href="#debugging-aid">Debugging Aid</a></li><li><a href="#known-issues">Known issues</a><ul><li><a href="#connection-timeout">Connection Timeout</a></li><li><a href="#service-response-timeout">Service Response Timeout</a></li><li><a href="#service-disconnect">Service Disconnect</a></li><li><a href="#service-is-unreachable">Service is unreachable</a></li><li><a href="#domain-name-is-not-existing">Domain name is not existing</a></li><li><a href="#json-response-data-format-error">JSON Response data format error</a></li></ul></li><li><a href="#global-request-and-response-events">Global <code>request</code> and <code>response</code> events</a><ul><li><a href="#request-event-occurs-before-the-network-operation"><code>request</code> event occurs before the network operation</a></li><li><a href="#response-event-occurs-after-the-end-of-network-operation"><code>response</code> event occurs after the end of network operation</a></li></ul></li><li><a href="#example">Example</a></li></ul></div></div></div></div></div></div></div></div></div><script type="text/javascript">window.__INIT_STATE__={"lang":"en","props":{"toc":"-%20%5BUsing%20HttpClient%20by%20app%5D(%23using-httpclient-by-app)%0A-%20%5BUsing%20HttpClient%20by%20Context%5D(%23using-httpclient-by-context)%0A-%20%5BBasic%20HTTP%20Request%5D(%23basic-http-request)%0A%20%20*%20%5BGET%5D(%23get)%0A%20%20*%20%5BPOST%5D(%23post)%0A%20%20*%20%5BPUT%5D(%23put)%0A%20%20*%20%5BDELETE%5D(%23delete)%0A-%20%5BAdvanced%20HTTP%20request%5D(%23advanced-http-request)%0A%20%20*%20%5BForm%20Submission%5D(%23form-submission)%0A%20%20*%20%5BUploading%20Files%20by%20Multipart%5D(%23uploading-files-by-multipart)%0A%20%20*%20%5BUploading%20files%20in%20Stream%20Mode%5D(%23uploading-files-in-stream-mode)%0A-%20%5Boptions%20Parameters%20in%20Detail%5D(%23options-parameters-in-detail)%0A%20%20*%20%5BDefault%20HttpClient%20Global%20Configuration%5D(%23default-httpclient-global-configuration)%0A%20%20*%20%5B%60data%3A%20Object%60%5D(%23data-object)%0A%20%20*%20%5B%60dataAsQueryString%3A%20Boolean%60%5D(%23dataasquerystring-boolean)%0A%20%20*%20%5B%60content%3A%20String%7CBuffer%60%5D(%23content-stringbuffer)%0A%20%20*%20%5B%60stream%3A%20ReadStream%60%5D(%23stream-readstream)%0A%20%20*%20%5B%60writeStream%3A%20WriteStream%60%5D(%23writestream-writestream)%0A%20%20*%20%5B%60consumeWriteStream%3A%20Boolean%60%5D(%23consumewritestream-boolean)%0A%20%20*%20%5B%60method%3A%20String%60%5D(%23method-string)%0A%20%20*%20%5B%60contentType%3A%20String%60%5D(%23contenttype-string)%0A%20%20*%20%5B%60dataType%3A%20String%60%5D(%23datatype-string)%0A%20%20*%20%5B%60fixJSONCtlChars%3A%20Boolean%60%5D(%23fixjsonctlchars-boolean)%0A%20%20*%20%5B%60headers%3A%20Object%60%5D(%23headers-object)%0A%20%20*%20%5B%60timeout%3A%20Number%7CArray%60%5D(%23timeout-numberarray)%0A%20%20*%20%5B%60agent%3A%20HttpAgent%60%5D(%23agent-httpagent)%0A%20%20*%20%5B%60httpsAgent%3A%20HttpsAgent%60%5D(%23httpsagent-httpsagent)%0A%20%20*%20%5B%60auth%3A%20String%60%5D(%23auth-string)%0A%20%20*%20%5B%60digestAuth%3A%20String%60%5D(%23digestauth-string)%0A%20%20*%20%5B%60followRedirect%3A%20Boolean%60%5D(%23followredirect-boolean)%0A%20%20*%20%5B%60maxRedirects%3A%20Number%60%5D(%23maxredirects-number)%0A%20%20*%20%5B%60formatRedirectUrl%3A%20Function(from%2C%20to)%60%5D(%23formatredirecturl-functionfrom-to)%0A%20%20*%20%5B%60beforeRequest%3A%20Function(options)%60%5D(%23beforerequest-functionoptions)%0A%20%20*%20%5B%60streaming%3A%20Boolean%60%5D(%23streaming-boolean)%0A%20%20*%20%5B%60gzip%3A%20Boolean%60%5D(%23gzip-boolean)%0A%20%20*%20%5B%60timing%3A%20Boolean%60%5D(%23timing-boolean)%0A%20%20*%20%5B%60ca%EF%BC%8CrejectUnauthorized%EF%BC%8Cpfx%EF%BC%8Ckey%EF%BC%8Ccert%EF%BC%8Cpassphrase%EF%BC%8Cciphers%EF%BC%8CsecureProtocol%60%5D(%23carejectunauthorizedpfxkeycertpassphrasecipherssecureprotocol)%0A-%20%5BDebugging%20Aid%5D(%23debugging-aid)%0A-%20%5BKnown%20issues%5D(%23known-issues)%0A%20%20*%20%5BConnection%20Timeout%5D(%23connection-timeout)%0A%20%20*%20%5BService%20Response%20Timeout%5D(%23service-response-timeout)%0A%20%20*%20%5BService%20Disconnect%5D(%23service-disconnect)%0A%20%20*%20%5BService%20is%20unreachable%5D(%23service-is-unreachable)%0A%20%20*%20%5BDomain%20name%20is%20not%20existing%5D(%23domain-name-is-not-existing)%0A%20%20*%20%5BJSON%20Response%20data%20format%20error%5D(%23json-response-data-format-error)%0A-%20%5BGlobal%20%60request%60%20and%20%60response%60%20events%5D(%23global-request-and-response-events)%0A%20%20*%20%5B%60request%60%20event%20occurs%20before%20the%20network%20operation%5D(%23request-event-occurs-before-the-network-operation)%0A%20%20*%20%5B%60response%60%20event%20occurs%20after%20the%20end%20of%20network%20operation%5D(%23response-event-occurs-after-the-end-of-network-operation)%0A-%20%5BExample%5D(%23example)","meta":{"info":{"title":"HttpClient"}},"content":"%0A%0A%0ACountless%20services%20rely%20on%20the%20HTTP-based%20communication%20nowadays%2C%20and%20it%20is%20a%20very%20common%20application%20scenario%20that%20web%20applications%20call%20back-end%20HTTP%20services.%0A%0AThe%20framework%20built%20in%20%5BHttpClient%5D%20based%20on%20%5Burllib%5D%2C%20you%20can%20quickly%20complete%20any%20HTTP%20request.%0A%0A%23%23%20Using%20HttpClient%20by%20app%0A%0A%5BHttpClient%5D%20will%20initialize%20to%20%60app.httpclient%60%20automatically%20during%20the%20application's%20initialization.%0AAlso%20added%20an%20method%20%60app.curl(url%2C%20options)%60%2C%20which%20is%20equivalent%20to%20the%20%60app.httpclient.request(url%2C%20options)%60.%0A%0ASo%20you%20can%20easily%20use%20%60app.curl%60%20to%20complete%20a%20HTTP%20request.%0A%0A%60%60%60js%0A%2F%2F%20app.js%0Amodule.exports%20%3D%20app%20%3D%3E%20%7B%0A%20%20app.beforeStart(async%20()%20%3D%3E%20%7B%0A%20%20%20%20%2F%2F%20example%3A%20read%20the%20version%20info%20on%20https%3A%2F%2Fregistry.npm.taobao.org%2Fegg%2Flatest%20when%20it%20starts%0A%20%20%20%20const%20result%20%3D%20await%20app.curl('https%3A%2F%2Fregistry.npm.taobao.org%2Fegg%2Flatest'%2C%20%7B%0A%20%20%20%20%20%20dataType%3A%20'json'%2C%0A%20%20%20%20%7D)%3B%0A%20%20%20%20app.logger.info('Egg%20latest%20version%3A%20%25s'%2C%20result.data.version)%3B%0A%20%20%7D)%3B%0A%7D%3B%0A%60%60%60%0A%0A%23%23%20Using%20HttpClient%20by%20Context%0A%0AFramework%20also%20provides%20%60ctx.curl(url%2C%20options)%60%20and%20%60ctx.httpclient%60%20in%20Context%2C%20same%20as%20app.%0ASo%20it's%20very%20easy%20to%20use%20%60ctx.curl()%60%20to%20complete%20a%20HTTP%20request%20in%20the%20Context%20(such%20as%20in%20the%20controller)%0A%0A%60%60%60js%0A%2F%2F%20app%2Fcontroller%2Fnpm.js%0Aclass%20NpmController%20extends%20Controller%20%7B%0A%20%20async%20index()%20%7B%0A%20%20%20%20const%20ctx%20%3D%20this.ctx%3B%0A%0A%20%20%20%20%2F%2F%20example%3A%20request%20a%20npm%20module's%20info%0A%20%20%20%20const%20result%20%3D%20await%20ctx.curl('https%3A%2F%2Fregistry.npm.taobao.org%2Fegg%2Flatest'%2C%20%7B%0A%20%20%20%20%20%20%2F%2F%20parse%20JSON%20response%0A%20%20%20%20%20%20dataType%3A%20'json'%2C%0A%20%20%20%20%20%20%2F%2F%20timeout%20of%203s%0A%20%20%20%20%20%20timeout%3A%203000%2C%0A%20%20%20%20%7D)%3B%0A%0A%20%20%20%20ctx.body%20%3D%20%7B%0A%20%20%20%20%20%20status%3A%20result.status%2C%0A%20%20%20%20%20%20headers%3A%20result.headers%2C%0A%20%20%20%20%20%20package%3A%20result.data%2C%0A%20%20%20%20%7D%3B%0A%20%20%7D%0A%7D%0A%60%60%60%0A%0A%23%23%20Basic%20HTTP%20Request%0A%0AHTTP%20has%20been%20widely%20used%20and%20have%20several%20methods%20to%20make%20request%2C%20but%20the%20methods%20are%20similar.%20We%20start%20with%20the%20basic%20four%20request%20methods%20then%20move%20to%20some%20more%20complex%20scenario.%0A%0AIn%20the%20following%20example%2C%20we%20will%20complete%20the%20request%20of%20https%3A%2F%2Fhttpbin.org%20in%20the%20controller.%0A%0A%23%23%23%20GET%0A%0AReading%20data%20almost%20uses%20GET%20request.%20It%20is%20the%20most%20common%20type%20and%20widely%20used%20in%20the%20world%20of%20HTTP.%20And%20it%20is%20also%20easier%20to%20construct%20a%20request%20parameter.%0A%0A%60%60%60js%0A%2F%2F%20app%2Fcontroller%2Fnpm.js%0Aclass%20NpmController%20extends%20Controller%20%7B%0A%20%20async%20get()%20%7B%0A%20%20%20%20const%20ctx%20%3D%20this.ctx%3B%0A%20%20%20%20const%20result%20%3D%20await%20ctx.curl('https%3A%2F%2Fhttpbin.org%2Fget%3Ffoo%3Dbar')%3B%0A%20%20%20%20ctx.status%20%3D%20result.status%3B%0A%20%20%20%20ctx.set(result.headers)%3B%0A%20%20%20%20ctx.body%20%3D%20result.data%3B%0A%20%20%7D%0A%7D%0A%60%60%60%0A%0A-%20GET%20request%20might%20not%20need%20to%20set%20%60options.method%60.%20HttpClient%20Defalut%20method%20is%20set%20to%20%60GET%60%0A-%20Return%20%60result%60%20will%20contains%203%20attributes%3A%20%60status%60%2C%20%60headers%60%20and%20%60data%60%0A%20%20-%20%60status%60%3A%20response%20status%EF%BC%8Cfor%20example%20%60200%60%2C%20%60302%60%2C%20%60404%60%2C%20%60500%60%20and%20etc%0A%20%20-%20%60headers%60%3A%20response%20header%EF%BC%8Csimilar%20to%20%60%7B%20'content-type'%3A%20'text%2Fhtml'%2C%20...%20%7D%60%0A%20%20-%20%60data%60%3A%20response%20body%EF%BC%8Cdefault%20HttpClient%20doesn't%20do%20anything%20and%20returns%20as%20Buffer%20directly.%0A%20%20%20%20Once%20the%20%60options.dataType%60%20is%20set%EF%BC%8CHttpClient%20will%20process%20the%20%60data%60%20based%20on%20the%20parameters%0A%0AFor%20the%20complete%20request%20parameter%20%60options%60%20and%20return%20value%20%60result%60%2C%20refer%20to%20below%20section%20%5Boptions%20Parameters%20in%20Detail%5D(%23options-parameters-in-detail)%0A%0A%23%23%23%20POST%0A%0AThe%20scenario%20of%20creating%20data%20generally%20uses%20the%20POST%20request%20with%20body%20parameter%2C%20one%20more%20parameter%20compared%20to%20GET.%0A%0ATake%20sending%20JSON%20boy%20as%20example%3A%0A%0A%60%60%60js%0A%2F%2F%20app%2Fcontroller%2Fnpm.js%0Aclass%20NpmController%20extends%20Controller%20%7B%0A%20%20async%20post()%20%7B%0A%20%20%20%20const%20ctx%20%3D%20this.ctx%3B%0A%20%20%20%20const%20result%20%3D%20await%20ctx.curl('https%3A%2F%2Fhttpbin.org%2Fpost'%2C%20%7B%0A%20%20%20%20%20%20%2F%2F%20method%20is%20required%0A%20%20%20%20%20%20method%3A%20'POST'%2C%0A%20%20%20%20%20%20%2F%2F%20telling%20HttpClient%20to%20send%20data%20as%20JSON%20by%20contentType%0A%20%20%20%20%20%20contentType%3A%20'json'%2C%0A%20%20%20%20%20%20data%3A%20%7B%0A%20%20%20%20%20%20%20%20hello%3A%20'world'%2C%0A%20%20%20%20%20%20%20%20now%3A%20Date.now()%2C%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%2F%2F%20telling%20HttpClient%20to%20process%20the%20return%20body%20as%20JSON%20format%20explicitly%0A%20%20%20%20%20%20dataType%3A%20'json'%2C%0A%20%20%20%20%7D)%3B%0A%20%20%20%20ctx.body%20%3D%20result.data%3B%0A%20%20%7D%0A%7D%0A%60%60%60%0A%0AThe%20following%20will%20explain%20POST%20to%20achieve%20Form%20function%20of%20form%20submission%20and%20file%20upload%20in%20detail.%0A%0A%23%23%23%20PUT%0A%0ASimilar%20to%20POST%2C%20but%20PUT%20is%20better%20for%20data%20updating%20and%20replacement.%20Almost%20the%20same%20parameters%20as%20POST%20except%20setting%20method%20as%20%60PUT%60.%0A%0A%60%60%60js%0A%2F%2F%20app%2Fcontroller%2Fnpm.js%0Aclass%20NpmController%20extends%20Controller%20%7B%0A%20%20async%20put()%20%7B%0A%20%20%20%20const%20ctx%20%3D%20this.ctx%3B%0A%20%20%20%20const%20result%20%3D%20await%20ctx.curl('https%3A%2F%2Fhttpbin.org%2Fput'%2C%20%7B%0A%20%20%20%20%20%20%2F%2F%20method%20is%20required%0A%20%20%20%20%20%20method%3A%20'PUT'%2C%0A%20%20%20%20%20%20%20%2F%2F%20telling%20HttpClient%20to%20send%20data%20as%20JSON%20by%20contentType%0A%20%20%20%20%20%20contentType%3A%20'json'%2C%0A%20%20%20%20%20%20data%3A%20%7B%0A%20%20%20%20%20%20%20%20update%3A%20'foo%20bar'%2C%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%2F%2F%20telling%20HttpClient%20to%20process%20the%20return%20body%20as%20JSON%20format%20explicitly%0A%20%20%20%20%20%20dataType%3A%20'json'%2C%0A%20%20%20%20%7D)%3B%0A%20%20%20%20ctx.body%20%3D%20result.data%3B%0A%20%20%7D%0A%7D%0A%60%60%60%0A%0A%23%23%23%20DELETE%0A%0ADELETE%20request%20is%20to%20delete%20the%20data%2C%20request%20body%20don't%20need%20to%20add%20request%20body%20but%20HttpClient%20don't%20have%20the%20limitation.%0A%0A%60%60%60js%0A%2F%2F%20app%2Fcontroller%2Fnpm.js%0Aclass%20NpmController%20extends%20Controller%20%7B%0A%20%20async%20del()%20%7B%0A%20%20%20%20const%20ctx%20%3D%20this.ctx%3B%0A%20%20%20%20const%20result%20%3D%20await%20ctx.curl('https%3A%2F%2Fhttpbin.org%2Fdelete'%2C%20%7B%0A%20%20%20%20%20%20%2F%2F%20method%20is%20required%0A%20%20%20%20%20%20method%3A%20'DELETE'%2C%0A%20%20%20%20%20%20%2F%2F%20telling%20HttpClient%20to%20process%20the%20return%20body%20as%20JSON%20format%20explicitly%0A%20%20%20%20%20%20dataType%3A%20'json'%2C%0A%20%20%20%20%7D)%3B%0A%20%20%20%20ctx.body%20%3D%20result.data%3B%0A%20%20%7D%0A%7D%0A%60%60%60%0A%0A%23%23%20Advanced%20HTTP%20request%0A%0AIn%20some%20real%20application%20scenarios%2C%20still%20have%20some%20more%20complex%20HTTP%20requests.%0A%0A%23%23%23%20Form%20Submission%0A%0AInterfaces%20of%20Browser-Oriented%20Form%20Submission%20(without%20files)%2C%20usually%20require%20%60content-type%3A%20application%2Fx-www-form-urlencoded%60%20for%20the%20data%20requesting.%0A%0A%60%60%60js%0A%2F%2F%20app%2Fcontroller%2Fnpm.js%0Aclass%20NpmController%20extends%20Controller%20%7B%0A%20%20async%20submit()%20%7B%0A%20%20%20%20const%20ctx%20%3D%20this.ctx%3B%0A%20%20%20%20const%20result%20%3D%20await%20ctx.curl('https%3A%2F%2Fhttpbin.org%2Fpost'%2C%20%7B%0A%20%20%20%20%20%20%2F%2F%20method%20is%20required%2C%20supports%20POST%EF%BC%8CPUT%20and%20DELETE%0A%20%20%20%20%20%20method%3A%20'POST'%2C%0A%20%20%20%20%20%20%2F%2F%20contentType%20is%20not%20needed%2C%20by%20default%20HttpClient%20will%20send%20request%20in%20application%2Fx-www-form-urlencoded%0A%20%20%20%20%20%20data%3A%20%7B%0A%20%20%20%20%20%20%20%20now%3A%20Date.now()%2C%0A%20%20%20%20%20%20%20%20foo%3A%20'bar'%2C%0A%20%20%20%20%20%20%7D%2C%0A%20%20%20%20%20%20%2F%2F%20telling%20HttpClient%20to%20process%20the%20return%20body%20as%20JSON%20format%20explicitly%0A%20%20%20%20%20%20dataType%3A%20'json'%2C%0A%20%20%20%20%7D)%3B%0A%20%20%20%20ctx.body%20%3D%20result.data.form%3B%0A%20%20%20%20%2F%2F%20final%20response%20will%20similar%20as%20below%3A%0A%20%20%20%20%2F%2F%20%7B%0A%20%20%20%20%2F%2F%20%20%20%22foo%22%3A%20%22bar%22%2C%0A%20%20%20%20%2F%2F%20%20%20%22now%22%3A%20%221483864184348%22%0A%20%20%20%20%2F%2F%20%7D%0A%20%20%7D%0A%7D%0A%60%60%60%0A%0A%23%23%23%20Uploading%20Files%20by%20Multipart%0A%0AOnce%20form%20submission%20contains%20files%2C%20submission%20of%20requesting%20data%20must%20be%20%5Bmultipart%2Fform-data%5D(http%3A%2F%2Ftools.ietf.org%2Fhtml%2Frfc2388)%0AWe%20need%20to%20introduce%20third%20party%20module%20%5Bformstream%5D%20to%20generate%20%60form%60%20objects%20that%20can%20be%20consumed%20by%20HttpClient.%0A%0A%60%60%60js%0A%2F%2F%20app%2Fcontroller%2Fnpm.js%0Aconst%20FormStream%20%3D%20require('formstream')%3B%0Aclass%20NpmController%20extends%20Controller%20%7B%0A%20%20async%20upload()%20%7B%0A%20%20%20%20const%20ctx%20%3D%20this.ctx%3B%0A%20%20%20%20const%20form%20%3D%20new%20FormStream()%3B%0A%20%20%20%20%2F%2F%20set%20normal%20field%20and%20value%0A%20%20%20%20form.field('foo'%2C%20'bar')%3B%0A%20%20%20%20%2F%2F%20uploading%20the%20current%20file%20for%20test%20propose%0A%20%20%20%20form.file('file'%2C%20__filename)%3B%0A%0A%20%20%20%20const%20result%20%3D%20await%20ctx.curl('https%3A%2F%2Fhttpbin.org%2Fpost'%2C%20%7B%0A%20%20%20%20%20%2F%2F%20method%20is%20required%2C%20supports%20POST%EF%BC%8CPUT%0A%20%20%20%20%20%20method%3A%20'POST'%2C%0A%20%20%20%20%20%20%2F%2F%20generate%20request%20headers%20following%20the%20requirements%20of%20multipart%2Fform-data%0A%20%20%20%20%20%20headers%3A%20form.headers()%2C%0A%20%20%20%20%20%20%2F%2F%20submitted%20as%20stream%20mode%0A%20%20%20%20%20%20stream%3A%20form%2C%0A%20%20%20%20%20%20%2F%2F%20telling%20HttpClient%20to%20process%20the%20return%20body%20as%20JSON%20format%20explicitly%0A%20%20%20%20%20%20dataType%3A%20'json'%2C%0A%20%20%20%20%7D)%3B%0A%20%20%20%20ctx.body%20%3D%20result.data.files%3B%0A%20%20%20%20%2F%2F%20final%20response%20will%20similar%20as%20below%3A%0A%20%20%20%20%2F%2F%20%7B%0A%20%20%20%20%2F%2F%20%20%20%22file%22%3A%20%22'use%20strict'%3B%5Cn%5Cnconst%20For....%22%0A%20%20%20%20%2F%2F%20%7D%0A%20%20%7D%0A%7D%0A%60%60%60%0A%0AOf%20course%2C%20you%20can%20add%20more%20files%20to%20achieve%20the%20requirements%20of%20upload%20multiple%20files%20at%20one%20time%20by%20%60form.file()%60%0A%0A%60%60%60js%0Aform.file('file1'%2C%20file1)%3B%0Aform.file('file2'%2C%20file2)%3B%0A%60%60%60%0A%0A%23%23%23%20Uploading%20files%20in%20Stream%20Mode%0A%0AIn%20fact%2C%20Stream%20is%20the%20leading%20in%20the%20world%20of%20Node.js.%0AIf%20the%20server%20supports%20streaming%2C%20the%20most%20friendly%20way%20is%20to%20send%20the%20Stream%20directly.%20Actually%2C%20Stream%20will%20be%20sent%20in%20%60Transfer-Encoding%3A%20chunked%60%20transmission%20coding%20format%2C%20which%20is%20implemented%20by%20%5BHTTP%5D%20module%20automatically.%0A%0A%60%60%60js%0A%2F%2F%20app%2Fcontroller%2Fnpm.js%0Aconst%20fs%20%3D%20require('fs')%3B%0Aconst%20FormStream%20%3D%20require('formstream')%3B%0Aclass%20NpmController%20extends%20Controller%20%7B%0A%20%20async%20uploadByStream()%20%7B%0A%20%20%20%20const%20ctx%20%3D%20this.ctx%3B%0A%20%20%20%20%2F%2F%20uploading%20the%20current%20file%20for%20test%20propose%0A%20%20%20%20const%20fileStream%20%3D%20fs.createReadStream(__filename)%3B%0A%20%20%20%20%20%2F%2F%20httpbin.org%20not%20support%20stream%20mode%2C%20use%20the%20local%20stream%20interface%20instead%0A%20%20%20%20const%20url%20%3D%20%60%24%7Bctx.protocol%7D%3A%2F%2F%24%7Bctx.host%7D%2Fstream%60%3B%0A%20%20%20%20const%20result%20%3D%20await%20ctx.curl(url%2C%20%7B%0A%20%20%20%20%20%20%2F%2F%20method%20is%20required%2C%20supports%20POST%EF%BC%8CPUT%0A%20%20%20%20%20%20method%3A%20'POST'%2C%0A%20%20%20%20%20%20%2F%2F%20submitted%20by%20stream%20mode%0A%20%20%20%20%20%20stream%3A%20fileStream%2C%0A%20%20%20%20%7D)%3B%0A%20%20%20%20ctx.status%20%3D%20result.status%3B%0A%20%20%20%20ctx.set(result.headers)%3B%0A%20%20%20%20ctx.body%20%3D%20result.data%3B%0A%20%20%20%20%2F%2F%20final%20response%20will%20similar%20as%20below%3A%0A%20%20%20%20%2F%2F%20%7B%22streamSize%22%3A574%7D%0A%20%20%7D%0A%7D%0A%60%60%60%0A%0A%23%23%20options%20Parameters%20in%20Detail%0A%0ADue%20to%20the%20complexity%20of%20HTTP%20Request%2C%20the%20options%20parameters%20of%20%60httpclient.request(url%2C%20options)%60%20quite%20large.%20The%20actual%20usage%20of%20each%20optional%20parameter%20will%20be%20shown%20with%20descriptions%20and%20coding%20as%20below.%0A%0A%23%23%23%20Default%20HttpClient%20Global%20Configuration%0A%0A%60%60%60js%0A%2F%2F%20config%2Fconfig.default.js%0Aexports.httpclient%20%3D%20%7B%0A%20%20%2F%2F%20whether%20to%20enable%20local%20DNS%20cache%2C%20default%20disable%2C%20enable%20will%20have%20two%20characteristics%0A%20%20%2F%2F%201.%20All%20DNS%20lookup%20will%20prefer%20to%20use%20the%20cache%20by%20default%2C%20even%20DNS%20query%20error%20does%20not%20affects%20the%20application%0A%20%20%2F%2F%202.%20For%20the%20same%20hostname%2C%20query%20only%20once%20during%20the%20interval%20of%20dnsCacheLookupInterval%20(default%2010s)%0A%20%20enableDNSCache%3A%20false%2C%0A%20%20%2F%2F%20minimum%20interval%20of%20DNS%20query%20on%20the%20same%20hostname%0A%20%20dnsCacheLookupInterval%3A%2010000%2C%0A%20%20%2F%2F%20maximum%20number%20of%20hostname%20DNS%20cache%20simultaneously%2C%20default%201000%0A%20%20dnsCacheMaxLength%3A%201000%2C%0A%0A%20%20request%3A%20%7B%0A%20%20%20%20%2F%2F%20default%20timeout%20of%20request%0A%20%20%20%20timeout%3A%203000%2C%0A%20%20%7D%2C%0A%0A%20%20httpAgent%3A%20%7B%0A%20%20%20%20%2F%2F%20default%20enable%20http%20KeepAlive%0A%20%20%20%20keepAlive%3A%20true%2C%0A%20%20%20%20%2F%2F%20idle%20KeepAlive%20socket%20can%20survive%20for%204%20seconds%0A%20%20%20%20freeSocketKeepAliveTimeout%3A%204000%2C%0A%20%20%20%20%2F%2F%20when%20sockets%20have%20no%20activity%20for%20more%20than%2030s%2C%20it%20will%20be%20processed%20as%20timeout%0A%20%20%20%20timeout%3A%2030000%2C%0A%20%20%20%20%2F%2F%20maximum%20number%20of%20sockets%20allow%20to%20be%20created%0A%20%20%20%20maxSockets%3A%20Number.MAX_SAFE_INTEGER%2C%0A%20%20%20%20%2F%2F%20maximum%20number%20of%20idle%20sockets%0A%20%20%20%20maxFreeSockets%3A%20256%2C%0A%20%20%7D%2C%0A%0A%20%20httpsAgent%3A%20%7B%0A%20%20%20%20%2F%2F%20default%20enable%20https%20KeepAlive%0A%20%20%20%20keepAlive%3A%20true%2C%0A%20%20%20%20%2F%2F%20idle%20KeepAlive%20socket%20can%20survive%20for%204%20seconds%0A%20%20%20%20freeSocketKeepAliveTimeout%3A%204000%2C%0A%20%20%20%20%2F%2F%20when%20sockets%20have%20no%20activity%20for%20more%20than%2030s%2C%20it%20will%20be%20processed%20as%20timeout%0A%20%20%20%20timeout%3A%2030000%2C%0A%20%20%20%20%2F%2F%20maximum%20number%20of%20sockets%20allow%20to%20be%20created%0A%20%20%20%20maxSockets%3A%20Number.MAX_SAFE_INTEGER%2C%0A%20%20%20%20%2F%2F%20maximum%20number%20of%20idle%20sockets%0A%20%20%20%20maxFreeSockets%3A%20256%2C%0A%20%20%7D%2C%0A%7D%3B%0A%60%60%60%0A%0AApplication%20can%20overrides%20the%20configuration%20by%20%60config%2Fconfig.default.js%60%0A%0A%23%23%23%20%60data%3A%20Object%60%0A%0AThe%20request%20data%20will%20select%20the%20correct%20processing%20method%20automatically%20based%20on%20the%20%60method%60.%0A%0A-%20GET%EF%BC%8CHEAD%3A%20processed%20by%20%60querystring.stringify(data)%60%20then%20append%20to%20the%20query%20parameters%20of%20url.%0A-%20POST%EF%BC%8CPUT%2C%20DELETE%20and%20etc%3A%20further%20judgments%20and%20process%20according%20to%20%60contentType%60.%0A%20%20-%20%60contentType%20%3D%20json%60%3A%20processed%20by%20%60JSON.stringify(data)%60%20and%20set%20it%20as%20body%20before%20sending.%0A%20%20-%20others%3A%20processed%20by%20%60querystring.stringify(data)%60%20and%20set%20it%20as%20body%20before%20sending%0A%0A%60%60%60js%0A%2F%2F%20GET%20%2B%20data%0Actx.curl(url%2C%20%7B%0A%20%20data%3A%20%7B%20foo%3A%20'bar'%20%7D%2C%0A%7D)%3B%0A%0A%2F%2F%20POST%20%2B%20data%0Actx.curl(url%2C%20%7B%0A%20%20method%3A%20'POST'%2C%0A%20%20data%3A%20%7B%20foo%3A%20'bar'%20%7D%2C%0A%7D)%3B%0A%0A%2F%2F%20POST%20%2B%20JSON%20%2B%20data%0Actx.curl(url%2C%20%7B%0A%20%20method%3A%20'POST'%2C%0A%20%20contentType%3A%20'json'%2C%0A%20%20data%3A%20%7B%20foo%3A%20'bar'%20%7D%2C%0A%7D)%3B%0A%60%60%60%0A%0A%23%23%23%20%60dataAsQueryString%3A%20Boolean%60%0A%0AOnce%20%60dataAsQueryString%3Dtrue%60%20is%20set%2C%20even%20under%20POST%2C%20it%20will%20forces%20%60options.data%60%20to%20be%20processed%20by%20%60querystring.stringify%60%20then%20append%20to%20the%20%60url%60%20query%20parameters%0A%0AThe%20application%20scenarios%20that%20sending%20data%20using%20%60stream%60%20and%20pass%20additional%20request%20parameters%20by%20%60url%60%20query%20can%20be%20well%20resolved.%0A%0A%60%60%60js%0Actx.curl(url%2C%20%7B%0A%20%20method%3A%20'POST'%2C%0A%20%20dataAsQueryString%3A%20true%2C%0A%20%20data%3A%20%7B%0A%20%20%20%20%2F%2F%20generally%20it%20would%20be%20some%20validation%20parameters%20such%20as%20access%20token%2C%20etc.%0A%20%20%20%20accessToken%3A%20'some%20access%20token%20value'%2C%0A%20%20%7D%2C%0A%20%20stream%3A%20myFileStream%2C%0A%7D)%3B%0A%60%60%60%0A%0A%23%23%23%20%60content%3A%20String%7CBuffer%60%0A%0ASet%20request%20Context%2C%20if%20the%20parameter%20is%20set%2C%20it%20will%20ignore%20the%20%60data%60%20parameters%0A%0A%60%60%60js%0Actx.curl(url%2C%20%7B%0A%20%20method%3A%20'POST'%2C%0A%20%20%2F%2F%20Sending%20the%20raw%20xml%20data%20without%20HttpClient's%20to%20do%20processing%0A%20%20content%3A%20'%3Cxml%3E%3Chello%3Eworld%3C%2Fhello%3E%3C%2Fxml%3E'%2C%0A%20%20headers%3A%20%7B%0A%20%20%20%20'content-type'%3A%20'text%2Fhtml'%2C%0A%20%20%7D%2C%0A%7D)%3B%0A%60%60%60%0A%0A%23%23%23%20%60stream%3A%20ReadStream%60%0A%0ASet%20request%20context's%20readable%20stream%2C%20default%20%60null%60.%0AIf%20the%20parameter%20is%20set%20%2C%20HttpClient%20will%20ignore%20%60data%60%20and%20%60content%60%0A%0A%60%60%60js%0Actx.curl(url%2C%20%7B%0A%20%20method%3A%20'POST'%2C%0A%20%20stream%3A%20fs.createReadStream('%2Fpath%2Fto%2Fread')%2C%0A%7D)%3B%0A%60%60%60%0A%0A%23%23%23%20%60writeStream%3A%20WriteStream%60%0A%0ASet%20receive%20response%20data's%20writeable%20stream%2C%20default%20%60null%60.%0AOnce%20the%20parameter%20is%20set%2C%20response%20%60result.data%60%20is%20set%20to%20%60null%60%20because%20all%20data%20are%20written%20to%20%60writeStream%60.%0A%0A%60%60%60js%0Actx.curl(url%2C%20%7B%0A%20%20writeStream%3A%20fs.createWriteStream('%2Fpath%2Fto%2Fstore')%2C%0A%7D)%3B%0A%60%60%60%0A%0A%23%23%23%20%60consumeWriteStream%3A%20Boolean%60%0A%0AWhether%20to%20wait%20for%20%60writeStream%60%20completely%20finished%20as%20the%20response%20well%20received%0AThis%20parameter%20is%20not%20recommended%20to%20modify%20the%20default%20value%2C%20unless%20we%20know%20it's%20side%20effect%20are%20acceptable.%20Otherwise%2C%20the%20%60writeStream%60%20data%20is%20likely%20to%20be%20incomplete.%0A%0A%23%23%23%20%60method%3A%20String%60%0A%0ASet%20request%20method%2C%20default%20%60GET%60.%20Support%20all%20%60GET%E3%80%81POST%E3%80%81PUT%E3%80%81DELETE%E3%80%81PATCH%60%20and%20so%20on%20%5Ball%20HTTP%20methods%5D(https%3A%2F%2Fnodejs.org%2Fapi%2Fhttp.html%23http_http_methods)%E3%80%82%0A%0A%23%23%23%20%60contentType%3A%20String%60%0A%0ASet%20request%20data%20format%20%EF%BC%8Cdefault%20%60undefined%60%EF%BC%8CHttpClient%20will%20sets%20automatically%20based%20on%20the%20%60data%60%20and%20%60content%60%20parameters.%0AWhen%20%60data%60%20is%20object%2C%20the%20default%20setting%20would%20be%20%60form%60.%20Support%20%60json%60%20format.%0A%0AIf%20need%20to%20send%20%60data%60%20by%20JSON%0A%0A%60%60%60js%0Actx.curl(url%2C%20%7B%0A%20%20method%3A%20'POST'%2C%0A%20%20data%3A%20%7B%0A%20%20%20%20foo%3A%20'bar'%2C%0A%20%20%20%20now%3A%20Date.now()%2C%0A%20%20%7D%2C%0A%20%20contentType%3A%20'json'%2C%0A%7D)%3B%0A%60%60%60%0A%0A%23%23%23%20%60dataType%3A%20String%60%0A%0ASet%20the%20response%20data%20format%2C%20default%20return%20the%20raw%20buffer%20formatted%20data%20without%20processing.%20Support%20%60text%60%20and%20%60json%60%0A%0A**Note%3A%20If%20%60json%60%20is%20set%EF%BC%8Ca%20%60JSONResponseFormatError%60%20%20error%20would%20be%20thrown%20if%20fails%20to%20parse%20the%20response%20data.**%0A%0A%0A%60%60%60js%0Aconst%20jsonResult%20%3D%20await%20ctx.curl(url%2C%20%7B%0A%20%20dataType%3A%20'json'%2C%0A%7D)%3B%0Aconsole.log(jsonResult.data)%3B%0A%0Aconst%20htmlResult%20%3D%20await%20ctx.curl(url%2C%20%7B%0A%20%20dataType%3A%20'text'%2C%0A%7D)%3B%0Aconsole.log(htmlResult.data)%3B%0A%60%60%60%0A%0A%23%23%23%20%60fixJSONCtlChars%3A%20Boolean%60%0A%0AWhether%20filter%20the%20special%20control%20characters%20in%20the%20response%20data%20(U%2B0000%20~%20U%2B001F)%EF%BC%8Cdefault%20%60false%60%0ATypically%2C%20the%20JSON%20data%20returned%20by%20some%20CGI%20system%20might%20contains%20such%20special%20control%20characters%2C%20which%20can%20be%20filter%20automatically%20by%20setting%20the%20parameters.%0A%0A%60%60%60js%0Actx.curl(url%2C%20%7B%0A%20%20fixJSONCtlChars%3A%20true%2C%0A%20%20dataType%3A%20'json'%2C%0A%7D)%3B%0A%60%60%60%0A%0A%23%23%23%20%60headers%3A%20Object%60%0A%0ACustom%20request%20headers%0A%0A%60%60%60js%0Actx.curl(url%2C%20%7B%0A%20%20headers%3A%20%7B%0A%20%20%20%20'x-foo'%3A%20'bar'%2C%0A%20%20%7D%2C%0A%7D)%3B%0A%60%60%60%0A%0A%23%23%23%20%60timeout%3A%20Number%7CArray%60%0A%0ATimeout%20of%20request%2C%20default%20%60%5B%205000%2C%205000%20%5D%60%2C%20timeout%20of%20connection%20creation%20is%205s%2C%20and%20the%20timeout%20of%20receive%20response%20is%205s.%0A%0A%60%60%60js%0Actx.curl(url%2C%20%7B%0A%20%20%2F%2F%203s%20timeout%20of%20connection%20creation%2C%20and%20the%203s%20timeout%20of%20receive%20response%0A%20%20timeout%3A%203000%2C%0A%7D)%3B%0A%0Actx.curl(url%2C%20%7B%0A%20%20%2F%2F%201s%20timeout%20of%20connection%20creation%2C%20and%20the%2030s%20timeout%20of%20receive%20response%20for%20the%20responsing%20of%20larger%20scenarios%0A%20%20timeout%3A%20%5B%201000%2C%2030000%20%5D%2C%0A%7D)%3B%0A%60%60%60%0A%0A%23%23%23%20%60agent%3A%20HttpAgent%60%0A%0AAllows%20to%20override%20the%20default%20HttpAgent%20through%20this%20parameter.%20If%20you%20don't%20want%20to%20enable%20KeepAlive%2C%20set%20this%20parameter%20to%20%60false%60.%0A%0A%60%60%60js%0Actx.curl(url%2C%20%7B%0A%20%20agent%3A%20false%2C%0A%7D)%3B%0A%60%60%60%0A%0A%23%23%23%20%60httpsAgent%3A%20HttpsAgent%60%0A%0AAllows%20to%20override%20the%20default%20HttpsAgent%20through%20this%20parameter.%20If%20you%20don't%20want%20to%20enable%20KeepAlive%2C%20set%20this%20parameter%20to%20%60false%60.%0A%0A%60%60%60js%0Actx.curl(url%2C%20%7B%0A%20%20httpsAgent%3A%20false%2C%0A%7D)%3B%0A%60%60%60%0A%0A%23%23%23%20%60auth%3A%20String%60%0A%0AParameter%20of%20Simple%20login%20authorization%20(Basic%20Authentication)%2C%20will%20send%20the%20login%20information%20to%20the%20%60Authorization%60%20request%20in%20clear%20form.%0A%0A%60%60%60js%0Actx.curl(url%2C%20%7B%0A%20%20%2F%2F%20parameter%20must%20follow%20the%20format%20of%20%60user%3Apassword%60%0A%20%20auth%3A%20'foo%3Abar'%2C%0A%7D)%3B%0A%60%60%60%0A%0A%23%23%23%20%60digestAuth%3A%20String%60%0A%0AParameter%20of%20the%20Digest%20Authentication.%20If%20the%20parameter%20is%20set%2C%20it%20will%20attempt%20to%20generate%20the%20%60Authorization%60%20request%20header%20for%20the%20401%20response%20automatically%20then%20try%20requesting%20for%20authorization%20once.%0A%0A%60%60%60js%0Actx.curl(url%2C%20%7B%0A%20%20%2F%2F%20parameter%20must%20follow%20the%20format%20of%20%60user%3Apassword%60%0A%20%20digestAuth%3A%20'foo%3Abar'%2C%0A%7D)%3B%0A%60%60%60%0A%0A%23%23%23%20%60followRedirect%3A%20Boolean%60%0A%0AWhether%20to%20follow%203xx%20redirect%20response%2C%20default%20%60false%60%0A%0A%60%60%60js%0Actx.curl(url%2C%20%7B%0A%20%20followRedirect%3A%20true%2C%0A%7D)%3B%0A%60%60%60%0A%0A%23%23%23%20%60maxRedirects%3A%20Number%60%0A%0ASet%20the%20maximum%20number%20of%20automatic%20redirects%20to%20prevent%20the%20endless%20redirect%20loop%2C%20default%2010%20times.%0AThe%20parameter%20should%20not%20be%20set%20too%20large%20and%20only%20works%20in%20the%20%60followRedirect%3Dtrue%60%0A%0A%60%60%60js%0Actx.curl(url%2C%20%7B%0A%20%20followRedirect%3A%20true%2C%0A%20%20%2F%2F%20maximum%20allowed%20redirect%205%20times%0A%20%20maxRedirects%3A%205%2C%0A%7D)%3B%0A%60%60%60%0A%0A%23%23%23%20%60formatRedirectUrl%3A%20Function(from%2C%20to)%60%0A%0A%60formatRedirectUrl%60%20allow%20us%20to%20customize%20the%20implementation%20of%20302%E3%80%81301%20other%20redirect%20URL%20splicing%2C%20default%20%60url.resolve%20(from%2C%20to)%20%60.%0A%0A%60%60%60js%0Actx.curl(url%2C%20%7B%0A%20%20formatRedirectUrl%3A%20(from%2C%20to)%20%3D%3E%20%7B%0A%20%20%20%20%2F%2F%20for%20example%20you%20can%20correct%20the%20redirection%20of%20wrong%20url%20here%0A%20%20%20%20if%20(to%20%3D%3D%3D%20'%2F%2Ffoo%2F')%20%7B%0A%20%20%20%20%20%20to%20%3D%20'%2Ffoo'%3B%0A%20%20%20%20%7D%0A%20%20%20%20return%20url.resolve(from%2C%20to)%3B%0A%20%20%7D%2C%0A%7D)%3B%0A%60%60%60%0A%0A%23%23%23%20%60beforeRequest%3A%20Function(options)%60%0A%0AHttpClient%20will%20attempt%20to%20invoke%20the%20%60beforeRequest%60%20hook%20before%20requesting%20officially%2C%20allowing%20us%20to%20make%20the%20last%20modification%20of%20the%20request%20parameter%20here.%0A%0A%60%60%60js%0Actx.curl(url%2C%20%7B%0A%20%20beforeRequest%3A%20options%20%3D%3E%20%7B%0A%20%20%20%20%2F%2F%20For%20example%2C%20we%20can%20set%20the%20global%20request%20ID%20to%20facilitate%20log%20tracking%0A%20%20%20%20options.headers%5B'x-request-id'%5D%20%3D%20uuid.v1()%3B%0A%20%20%7D%2C%0A%7D)%3B%0A%60%60%60%0A%0A%23%23%23%20%60streaming%3A%20Boolean%60%0A%0AWhether%20to%20return%20the%20response%20stream%20directly%2C%20default%20%60false%60%0AAfter%20enable%20streaming%2C%20HttpClient%20will%20return%20immediately%20after%20getting%20the%20response%20object%20res%2C%0AAt%20this%20moment%20%60result.headers%60%20and%20%60result.status%60%20can%20be%20read%2C%20but%20still%20cannot%20read%20the%20data%0A%0A%60%60%60js%0Aconst%20result%20%3D%20await%20ctx.curl(url%2C%20%7B%0A%20%20streaming%3A%20true%2C%0A%7D)%3B%0A%0Aconsole.log(result.status%2C%20result.data)%3B%0A%2F%2F%20result.res%20is%20a%20ReadStream%20Object%0Actx.body%20%3D%20result.res%3B%0A%60%60%60%0A%0A**if%20res%20is%20not%20passed%20to%20body%20directly%2C%20then%20we%20must%20consume%20this%20stream%20and%20do%20well%20in%20error%20handling.**%0A%0A%0A%23%23%23%20%60gzip%3A%20Boolean%60%0A%0AWhether%20to%20support%20gzip%20response%20format%2C%20default%20%60false%60%0AAfter%20enable%20gzip%2C%20HttpClient%20will%20set%20%60Accept-Encoding%3A%20gzip%60%20header%20and%20extract%20the%20data%20with%20%60Content-Encoding%3A%20gzip%60%20response%20header%20automatically.%0A%0A%60%60%60js%0Actx.curl(url%2C%20%7B%0A%20%20gzip%3A%20true%2C%0A%7D)%3B%0A%60%60%60%0A%0A%23%23%23%20%60timing%3A%20Boolean%60%0A%0AWhether%20to%20enable%20the%20time%20measurement%20for%20each%20phase%2C%20default%20%60false%60%0AAfter%20enable%20the%20timing%2C%20you%20can%20get%20the%20time%20measurements%20of%20HTTP%20request%20(in%20milliseconds)%20from%20the%20%60result.res.timing%60.%0AThrough%20these%20measurements%2C%20we%20can%20easily%20locate%20the%20slowest%20environment%20in%20the%20request%2C%20similar%20to%20the%20Chrome%20network%20timing.%0A%0AMeasurement%20timing's%20analysis%20of%20each%20stage%3A%0A-%20queuing%3A%20allocating%20socket%20time%20consuming%0A-%20dnslookup%3A%20DNS%20queries%20time%20consuming%0A-%20connected%3A%20socket%20three%20handshake%20success%20time%20consuming%0A-%20requestSent%3A%20requesting%20full%20data%20time%20consuming%0A-%20waiting%3A%20first%20byte%20to%20received%20response%20time%20consuming%0A-%20contentDownload%3A%20full%20response%20data%20time%20consuming%0A%0A%60%60%60js%0Aconst%20result%20%3D%20await%20ctx.curl(url%2C%20%7B%0A%20%20timing%3A%20true%2C%0A%7D)%3B%0Aconsole.log(result.res.timing)%3B%0A%2F%2F%20%7B%0A%2F%2F%20%20%20%22queuing%22%3A29%2C%0A%2F%2F%20%20%20%22dnslookup%22%3A37%2C%0A%2F%2F%20%20%20%22connected%22%3A370%2C%0A%2F%2F%20%20%20%22requestSent%22%3A1001%2C%0A%2F%2F%20%20%20%22waiting%22%3A1833%2C%0A%2F%2F%20%20%20%22contentDownload%22%3A3416%0A%2F%2F%20%7D%0A%60%60%60%0A%0A%23%23%23%20%60ca%EF%BC%8CrejectUnauthorized%EF%BC%8Cpfx%EF%BC%8Ckey%EF%BC%8Ccert%EF%BC%8Cpassphrase%EF%BC%8Cciphers%EF%BC%8CsecureProtocol%60%0A%0AThese%20are%20parameters%20are%20passed%20to%20the%20%20%5BHTTPS%5D%20modules%EF%BC%8Cdetails%20refer%20to%20%5B%60https.request(options%2C%20callback)%60%5D(https%3A%2F%2Fnodejs.org%2Fapi%2Fhttps.html%23https_https_request_options_callback)%E3%80%82%0A%0A%23%23%20Debugging%20Aid%0A%0AFramework%20provides%20%5Begg-development-proxyagent%5D%20plugin%20to%20help%20developers%20to%20debug.%0A%0AInstall%20and%20enable%20pulgin%3A%0A%0A%60%60%60bash%0A%24%20npm%20i%20egg-development-proxyagent%20--save%0A%60%60%60%0A%0A%60%60%60js%0A%2F%2F%20config%2Fplugin.js%0Aexports.proxyagent%20%3D%20%7B%0A%20%20enable%3A%20true%2C%0A%20%20package%3A%20'egg-development-proxyagent'%2C%0A%7D%0A%60%60%60%0A%0AOpen%20capture%20tools%2C%20we%20can%20use%20%5Bcharles%5D%20or%20%5Bfiddler%5D%2C%20here%20we%20take%20to%20%5Banyproxy%5D%20demonstrate%0A%0A%60%60%60bash%0A%24%20npm%20install%20anyproxy%20-g%0A%24%20anyproxy%20--port%208888%0A%60%60%60%0A%0AStarting%20application%20using%20environment%20variables%3A%0A%0A%60%60%60bash%0A%24%20http_proxy%3Dhttp%3A%2F%2F127.0.0.1%3A8888%20npm%20run%20dev%0A%60%60%60%0A%0AThen%20it%20works%20correctly%2C%20and%20all%20requests%20that%20go%20through%20HttpClient%20can%20be%20viewed%20in%20the%20consle%20of%20http%3A%2F%2Flocalhost%3A8002.%0A%0A!%5Banyproxy%5D(https%3A%2F%2Fcloud.githubusercontent.com%2Fassets%2F227713%2F21976937%2F06a63694-dc0f-11e6-98b5-e9e279c4867c.png)%0A%0A**Note%3A%20the%20pulgin%20only%20start%20in%20local%20environments%20by%20defalut**%0A%0A%23%23%20Known%20issues%0A%0A%23%23%23%20Connection%20Timeout%0A%0A-%20Exception%3A%20%60ConnectionTimeoutError%60%0A-%20Scene%3A%20usually%20occurred%20by%20the%20DNS%20query%20is%20slow%2C%20or%20the%20network%20is%20slow%20between%20the%20client%20and%20server%0A-%20Troubleshooting%20Suggestion%3A%20increase%20the%20%60timeout%60%20parameter%20appropriately.%0A%0A%23%23%23%20Service%20Response%20Timeout%0A%0A-%20Exception%3A%20%60ResponseTimeoutError%60%0A-%20Scene%3A%20usually%20occurred%20by%20network%20is%20slower%20between%20the%20client%20and%20server%2C%20and%20happens%20when%20the%20data%20is%20relatively%20large.%0A-%20Troubleshooting%20Suggestion%3A%20increase%20the%20%60timeout%60%20parameter%20appropriately.%0A%0A%23%23%23%20Service%20Disconnect%0A%0A-%20Exception%3A%20%60ResponseError%2C%20code%3A%20ECONNRESET%60%0A-%20Scene%3A%20usually%20the%20server%20actively%20disconnects%20the%20socket%20connection%2C%20causing%20the%20HTTP%20request%20link%20exceptions.%0A-%20Troubleshooting%20Suggestion%3A%20please%20check%20if%20server%20has%20network%20exception%20at%20that%20time%0A%0A%23%23%23%20Service%20is%20unreachable%0A%0A-%20Exception%3A%20%60RequestError%2C%20code%3A%20ECONNREFUSED%2C%20status%3A%20-1%60%0A-%20Scene%3A%20usually%20because%20the%20requested%20URL%20which%20attached%20IP%20or%20the%20port%20cannot%20connect%20successfully.%0A-%20Troubleshooting%20Suggestion%3A%20make%20sure%20the%20IP%20or%20port%20is%20set%20correctly%0A%0A%23%23%23%20Domain%20name%20is%20not%20existing%0A%0A-%20Exception%3A%20%60RequestError%2C%20code%3A%20ENOTFOUND%2C%20status%3A%20-1%60%0A-%20Scene%3A%20usually%20the%20domain%20name%20requested%20by%20URL%20cannot%20be%20resolved%20by%20DNS%20successfully.%0A-%20Troubleshooting%20Suggestion%3A%20make%20sure%20the%20domain%20name%20exists%2C%20and%20also%20check%20to%20see%20if%20the%20DNS%20service%20is%20properly%20configured.%0A%0A%23%23%23%20JSON%20Response%20data%20format%20error%0A%0A-%20Exception%3A%20%60JSONResponseFormatError%60%0A-%20scene%3A%20the%20%60dataType%3Djson%60%20is%20set%20and%20this%20exception%20is%20thrown%20in%20response%20data%20that%20does%20not%20match%20JSON%20format.%0A-%20Troubleshooting%20Suggestion%3A%20make%20sure%20that%20the%20server%20no%20matter%20what%20situations%20are%20returns%20the%20data%20in%20JSON%20format%20correctly.%0A%0A%23%23%20Global%20%60request%60%20and%20%60response%60%20events%0A%0AIn%20enterprise%20application%20scenarios%2C%20generally%20a%20unified%20tracer%20log%20is%20needed.%0ATo%20facilitate%20monitoring%20HttpClient%20requests%20and%20responses%20on%20the%20app%20level%2C%20we%20agreed%20on%20global%20%60request%60%20and%20%60response%60%20to%20expose%20these%20two%20events.%0A%0A%60%60%60bash%0A%20%20%20%20init%20options%0A%20%20%20%20%20%20%20%20%7C%0A%20%20%20%20%20%20%20%20V%0A%20%20%20%20emit%20%60request%60%20event%0A%20%20%20%20%20%20%20%20%7C%0A%20%20%20%20%20%20%20%20V%0A%20%20%20%20send%20request%20and%20receive%20response%0A%20%20%20%20%20%20%20%20%7C%0A%20%20%20%20%20%20%20%20V%0A%20%20%20%20emit%20%60response%60%20event%0A%20%20%20%20%20%20%20%20%7C%0A%20%20%20%20%20%20%20%20V%0A%20%20%20%20%20%20%20end%0A%60%60%60%0A%0A%23%23%23%20%60request%60%20event%20occurs%20before%20the%20network%20operation%0A%0AA%20%60request%60%20event%20is%20triggered%20before%20the%20request%20is%20sent%2C%20allowing%20blocking%20of%20the%20request.%0A%0A%60%60%60js%0Aapp.httpclient.on('request'%2C%20req%20%3D%3E%20%7B%0A%20%20req.url%20%2F%2Frequest%20url%0A%20%20req.ctx%20%2F%2Fcontext%20of%20the%20request%0A%0A%20%20%2F%2F%20you%20can%20set%20some%20trace%20headers%20here%20for%20full%20link%20tracking%20propose%0A%7D)%3B%0A%60%60%60%0A%0A%23%23%23%20%60response%60%20event%20occurs%20after%20the%20end%20of%20network%20operation%0A%0AAfter%20the%20end%20of%20request%2C%20a%20%60response%60%20event%20is%20triggered%2C%20so%20that%20the%20external%20event%20can%20be%20subscribed%20to%20the%20log%20printing.%0A%0A%60%60%60js%0Aapp.httpclient.on('response'%2C%20result%20%3D%3E%20%7B%0A%20%20result.res.status%0A%20%20result.ctx%20%2F%2Fcontext%20of%20the%20request%0A%20%20result.req%20%2F%2Fthe%20corresponding%20req%20object%2C%20which%20the%20req%20in%20the%20request%20event%0A%0A%7D)%3B%0A%60%60%60%0A%0A%23%23%20Example%0A%0AFull%20examples%20can%20be%20found%20on%20%5Beggjs%2Fexmaples%2Fhttpclient%5D(https%3A%2F%2Fgithub.com%2Feggjs%2Fexamples%2Fblob%2Fmaster%2Fhttpclient)%20.%0A%0A%5Burllib%5D%3A%20https%3A%2F%2Fgithub.com%2Fnode-modules%2Furllib%0A%5BHttpClient%5D%3A%20https%3A%2F%2Fgithub.com%2Feggjs%2Fegg%2Fblob%2Fmaster%2Flib%2Fcore%2Fhttpclient.js%0A%5Bformstream%5D%3A%20https%3A%2F%2Fgithub.com%2Fnode-modules%2Fformstream%0A%5BHTTP%5D%3A%20https%3A%2F%2Fnodejs.org%2Fapi%2Fhttp.html%0A%5BHTTPS%5D%3A%20https%3A%2F%2Fnodejs.org%2Fapi%2Fhttps.html%0A%5Begg-development-proxyagent%5D%3A%20https%3A%2F%2Fgithub.com%2Feggjs%2Fegg-development-proxyagent%0A%5Bcharles%5D%3A%20https%3A%2F%2Fwww.charlesproxy.com%2F%0A%5Bfiddler%5D%3A%20http%3A%2F%2Fwww.telerik.com%2Ffiddler%0A%5Banyproxy%5D%3A%20https%3A%2F%2Fgithub.com%2Falibaba%2Fanyproxy%0A"}}</script><script type="text/javascript" src="/static/js/post.b9faab88.js"></script></body></html>